## Patent Reference

- Title: Method and system for detecting homozygous regions of genome based on low-depth sequencing data
- URL: https://patents.google.com/patent/CN116913378A/en

### Abstract

Abstract The invention discloses a method and a system for detecting a genome homozygous region based on low-depth sequencing data, which relate to the technical field of molecular genetics detection, and are used for calculating a first edge likelihood value of each target SNP locus belonging to a normal region and a second edge likelihood value of each target SNP locus belonging to the genome homozygous region for each chromosome region obtained by carrying out region division on a human reference genome, and respectively calculating a first joint distribution likelihood value and a second joint distribution likelihood value based on the first edge likelihood values and the second edge likelihood values of all target SNP loci in the chromosome region so as to judge whether the chromosome region is the genome homozygous region, thereby accurately detecting the genome homozygous region in a whole genome based on low-depth whole genome sequencing data with the sequencing depth of 0.1X-1X, reducing the dependence on the sequencing depth and reducing the detection cost.

### Description

Description Translated from Chinese 基于低深度测序数据检测基因组纯合区域的方法及系统Method and system for detecting homozygous regions of genome based on low-depth sequencing data 技术领域Technical field 本发明涉及分子遗传学检测技术领域，特别是涉及一种基于低测序深度全基因组测序数据检测基因组纯合区域的方法及系统。The present invention relates to the field of molecular genetic detection technology, and in particular to a method and system for detecting homozygous regions of the genome based on low sequencing depth whole genome sequencing data. 背景技术Background technique 基因组纯合区域(Region ofhomozygousity，ROH)指的是基因组区域中出现等位基因杂合性缺失的现象，对于大多数二倍体细胞，例如人类体细胞等，有两份基因组，一份来自父方，一份来自母方，在基因组某个SNP位点，当来自双亲的碱基不同时，则称该SNP位点是杂合，如果因为某种机制(如缺失、减数分裂错误、近亲等)导致在该区域中的所有SNP位点只有来自父方或母方的一类基因组，则该区域为基因组纯合区域ROH，其中最典型的为单亲二倍体(uniparental disomy，UPD)，是指同源染色体或染色体上的部分片段均来源于双亲中的一方，而没有另一方染色体的存在。Region of homozygousness (ROH) refers to the phenomenon of loss of allelic heterozygosity in the genome region. For most diploid cells, such as human somatic cells, there are two genomes, one from From the father's side, one copy comes from the mother's side. At a certain SNP site in the genome, when the bases from both parents are different, the SNP site is said to be heterozygous. If it is due to some mechanism (such as deletion, meiosis error, close relatives, etc.) ) results in all SNP sites in this region coming from only one type of genome from the paternal or maternal side, then the region is a genome homozygous region ROH, the most typical of which is uniparental disomy (UPD), which refers to homozygous The source chromosome or part of the chromosome comes from one of the parents without the presence of the other parent's chromosome. 检测基因组纯合区域在近年来得到了越来越多的国内外专业团队的重视。在2020年，ACMG(American College ofMedical Genetics and Genomics，美国医学遗传学和基因组学学院)发布了有关ROH或UPD的声明，并对其检测的重要性表示了支持，同年国内也发表了不少有关ROH检测的文献报道。目前对ROH进行检测的检测技术主要分为两类，一类是针对目标特异性的纯合检测，主要技术包括短串联重复序列分型和甲基化特异性PCR等，然而该类技术只适用于对根据临床表现所怀疑的某个具体的基因组纯合区域进行检测；另一类是在全基因组范围内的全面检测基因组纯合区域的检测技术，主要技术包括染色体微阵列分析技术和测序技术，测序技术往往是指常规深度的测序，并不是低深度全基因组测序，当难以预测或者想要查找隐性基因具体突变位点时，一般采用此类技术。以下详细介绍现有技术：Detecting homozygous regions in the genome has attracted more and more attention from domestic and foreign professional teams in recent years. In 2020, ACMG (American College of Medical Genetics and Genomics) issued a statement on ROH or UPD and expressed support for the importance of its detection. In the same year, many domestic reports were also published on ROH or UPD. Literature reports on ROH detection. Currently, detection technologies for detecting ROH are mainly divided into two categories. One is target-specific homozygous detection. The main technologies include short tandem repeat sequence typing and methylation-specific PCR. However, this type of technology is only suitable for It is used to detect a specific homozygous region of the genome that is suspected based on clinical manifestations; the other type is a detection technology that comprehensively detects homozygous regions of the genome within the entire genome. The main technologies include chromosome microarray analysis technology and sequencing technology. , Sequencing technology often refers to conventional depth sequencing, not low-depth whole-genome sequencing. This type of technology is generally used when it is difficult to predict or when you want to find the specific mutation site of a recessive gene. The following describes the existing technology in detail: (1)短串联重复序列分型(STR)：是均匀分布于真核生物基因组中的简单重复序列，由于重复单位的重复次数在个体间呈高度变异性，并且标记物在整个基因组中丰富，杂合度高，因此能反映群体中等位基因频率的差异。但STR发生突变的概率较高，对判定会造成干扰，并且由于采集位点的限制，对样本质量要求高，能获取的信息量较低，且不适宜用于全基因组范围内的UPD筛查，只能检测预设的目标纯合区域。(1) Short tandem repeat typing (STR): It is a simple repeat sequence evenly distributed in the eukaryotic genome. Since the number of repetitions of the repeat unit is highly variable between individuals and markers are abundant throughout the genome, Heterozygosity is high and therefore reflects differences in allele frequencies in the population. However, the probability of STR mutations is high, which will cause interference to the determination. Due to the limitation of the collection site, the sample quality is high, the amount of information that can be obtained is low, and it is not suitable for genome-wide UPD screening. , can only detect the preset target homozygous region. (2)甲基化特异性PCR(MSP)：是一种特异位点甲基化检测技术。甲基化会直接干扰转录因子和启动子识别位点的结合，由于碱基C不能被转化为碱基T，因此上述引物将不会扩出目的基因，通过此方法就能达到识别基因组DNA是否甲基化的目的，对印记基因疾病有一定意义，这种方法灵敏度高，无需特殊仪器，因此成本较低。但需要预先知道待测片段的DNA序列，引物的设计非常重要，其中最大的缺点是只能检测预设的目标UPD，此外，对亚硫酸氢盐的处理十分关键，若处理不完全则可能导致假阳性的出现。(2) Methylation-specific PCR (MSP): It is a site-specific methylation detection technology. Methylation will directly interfere with the binding of transcription factors and promoter recognition sites. Since base C cannot be converted into base T, the above primers will not amplify the target gene. This method can identify whether genomic DNA is present. The purpose of methylation has certain significance for imprinted gene diseases. This method is highly sensitive and does not require special equipment, so the cost is low. However, it is necessary to know the DNA sequence of the fragment to be tested in advance, and the design of primers is very important. The biggest disadvantage is that it can only detect the preset target UPD. In addition, the treatment of bisulfite is very critical. If the treatment is not complete, it may cause The occurrence of false positives. (3)染色体微阵列分析技术(CMA)：因探针设计不同，分为基于微阵列的比较基因组杂交技术(aCGH)和单核苷酸多态性微阵列技术(SNP array)。SNP array在非多态性探针的基础上增加了SNP探针，克服了aCGH的局限性，除了染色体拷贝数异常外，还能够检测出大多数的ROH和三倍体。CMA技术对SNP位点进行扫描，可识别出每个SNP位点的基因型，该技术利用SNP位点提供的基因型信息可以发现多倍体异常以及基因组中的ROH。但CMA技术的主要缺陷在于检测范围易受探针偏好性的影响，同时芯片对于样本DNA起始量和质量的要求远高于测序，芯片的检测成本也比低深度全基因组测序高数倍。(3) Chromosome microarray analysis technology (CMA): Due to different probe designs, it is divided into microarray-based comparative genomic hybridization technology (aCGH) and single nucleotide polymorphism microarray technology (SNP array). SNP array adds SNP probes to non-polymorphic probes, overcoming the limitations of aCGH. In addition to chromosome copy number abnormalities, it can also detect most ROH and triploidy. CMA technology scans SNP sites and can identify the genotype of each SNP site. This technology uses the genotype information provided by SNP sites to discover polyploidy abnormalities and ROH in the genome. However, the main drawback of CMA technology is that the detection range is easily affected by probe preference. At the same time, the chip's requirements for the starting amount and quality of sample DNA are much higher than those for sequencing, and the detection cost of the chip is also several times higher than that of low-depth whole-genome sequencing. (4)全外显子组测序(WES)：这类方法是通过定制探针对外显子区域DNA进行富集，对其进行高通量测序，进行数据分析和比对，确定每个SNP位点的基因型状态来估算是否存在UPD。但其主要缺陷为外显子仅占人类基因组的1-2％，对于外显子以外的区域则不能有效地进行基因检测，且需要较高测序深度，检测成本较高，价格昂贵。(4) Whole exome sequencing (WES): This method uses customized probes to enrich DNA in the exon region, conducts high-throughput sequencing, performs data analysis and comparison, and determines each SNP position. The genotype status of the point is used to estimate whether there is UPD. However, its main drawback is that exons only account for 1-2% of the human genome. Gene detection cannot be effectively performed on regions other than exons, and higher sequencing depth is required. The detection cost is high and expensive. (5)低深度全基因组测序(CNV-seq)：是基于第二代测序技术的全基因组测序方法来检测基因组拷贝数变异的染色体分析技术。CNV-seq在极低测序深度(0.1～1×)的基础下即可准确进行全基因组水平的染色体拷贝数异常检测，可检测长度低至100kb、嵌合比例低至10％的染色体拷贝数异常(CNV)。在2019年之前，专业指南还认为基于低深度测序的诊断方法只能检测CNV，还无法检测ROH。随后，三项研究表明，通过观测SNP位点的B等位基因频率，是有可能从低深度全基因组测序数据中检测出ROH的，但是没有描述检测的性能指标和参数。直到2021年7月，一项研究通过推断B等位基因频率，实现从4×低深度测序的样本中检测5Mb以上的ROH，证实了低深度测序技术用于侵入式检测单亲同二体型UPD的可行性。然而，这类通过B等位基因频率检测ROH的方法，仍然存在以下多方面的局限性：该方法要求样本的测序深度在4×左右，再从样本中选取覆盖度在5以上的SNP位点用来推测B等位基因频率，而目前国内应用中测序深度往往不足1×，因此绝大多数SNP位点无法用于推测B等位基因频率，导致该方法失效。若是提高测序深度到4×左右，则会增加额外的检测成本，进一步限制推广。(5) Low-depth whole-genome sequencing (CNV-seq): It is a chromosome analysis technology based on the whole-genome sequencing method of second-generation sequencing technology to detect genome copy number variations. CNV-seq can accurately detect chromosome copy number abnormalities at the whole genome level based on extremely low sequencing depth (0.1~1×), and can detect chromosome copy number abnormalities with a length as low as 100kb and a mosaic ratio as low as 10%. (CNV). Before 2019, professional guidelines believed that diagnostic methods based on low-depth sequencing could only detect CNV and could not detect ROH. Subsequently, three studies showed that it is possible to detect ROH from low-depth whole-genome sequencing data by observing the B allele frequency of SNP sites, but the performance indicators and parameters of the detection were not described. Until July 2021, a study achieved the detection of ROH of more than 5Mb from 4× low-depth sequencing samples by inferring the B allele frequency, confirming the use of low-depth sequencing technology for invasive detection of uniparental homodimer UPD. feasibility. However, this method of detecting ROH through B allele frequency still has the following limitations: This method requires the sequencing depth of the sample to be around 4×, and then select SNP sites with a coverage of more than 5 from the sample. It is used to infer the B allele frequency, but the sequencing depth in current domestic applications is often less than 1×, so most SNP sites cannot be used to infer the B allele frequency, resulting in the failure of this method. If the sequencing depth is increased to about 4×, additional detection costs will be increased, further limiting promotion. 下表1为上述五种基因组纯合区域检测技术的优势和缺点。Table 1 below shows the advantages and disadvantages of the above five genome homozygous region detection technologies. 表1Table 1 基于CNV-seq技术检测基因组纯合区域存在很大挑战，因为每个SNP位点的基因型都是未知的，如何使用低测序深度的全基因组测序数据满足检测ROH的需要，对控制检测成本来说是一项极具意义的工作。因此有必要建立一个从低于1×深度的CNV-seq数据中检测ROH的新方法，来解决现有CNV-seq技术的困境。There are great challenges in detecting homozygous regions of the genome based on CNV-seq technology, because the genotype of each SNP site is unknown. How to use whole-genome sequencing data with low sequencing depth to meet the needs of detecting ROH is very important for controlling detection costs. It is said to be a very meaningful job. Therefore, it is necessary to establish a new method for detecting ROH from CNV-seq data below 1× depth to solve the dilemma of existing CNV-seq technology. 发明内容Contents of the invention 本发明的目的是提供一种基于低深度测序数据检测基因组纯合区域的方法及系统，可基于0.1×-1×测序深度的低深度全基因组测序数据准确检测全基因组内的基因组纯合区域，减少对测序深度的依赖性，减少检测成本。The purpose of the present invention is to provide a method and system for detecting homozygous regions of the genome based on low-depth sequencing data, which can accurately detect homozygous regions of the genome based on low-depth whole-genome sequencing data of 0.1×-1× sequencing depth. Reduce dependence on sequencing depth and reduce detection costs. 为实现上述目的，本发明提供了如下方案：In order to achieve the above objects, the present invention provides the following solutions: 一种基于低深度测序数据检测基因组纯合区域的方法，所述方法包括：A method for detecting homozygous regions of the genome based on low-depth sequencing data, the method includes: 利用测序深度为0.1×-1×的低深度全基因组测序技术对待测样本进行测序，得到低深度全基因组测序数据；所述待测样本为个体DNA；所述低深度全基因组测序数据包括多个碱基序列；The sample to be tested is sequenced using low-depth whole-genome sequencing technology with a sequencing depth of 0.1×-1× to obtain low-depth whole-genome sequencing data; the sample to be tested is individual DNA; the low-depth whole-genome sequencing data includes multiple base sequence; 分别将每一所述碱基序列与人类参考基因组进行比对，得到每一所述碱基序列在所述人类参考基因组中的位置和比对质量，并选取所述比对质量高于或者等于预设质量的碱基序列作为检测用碱基序列；Compare each base sequence with the human reference genome respectively to obtain the position and alignment quality of each base sequence in the human reference genome, and select the alignment quality to be higher than or equal to The base sequence of preset quality is used as the base sequence for detection; 以预设窗宽和预设步长对所述人类参考基因组进行区域划分，得到多个染色体区域；Divide the human reference genome into regions using a preset window width and a preset step size to obtain multiple chromosome regions; 对于每一所述染色体区域，根据所有所述检测用碱基序列的位置，选取所述染色体区域中至少被一个所述检测用碱基序列覆盖的SNP位点作为目标SNP位点，并确定每一所述目标SNP位点上A等位基因被所述检测用碱基序列覆盖的第一次数和B等位基因被所述检测用碱基序列覆盖的第二次数；根据所述第一次数和所述第二次数计算每一所述目标SNP位点属于正常区域的第一边缘似然值和属于基因组纯合区域的第二边缘似然值；基于所述染色体区域内的所有所述目标SNP位点的第一边缘似然值计算第一联合分布似然值，基于所述染色体区域内的所有所述目标SNP位点的第二边缘似然值计算第二联合分布似然值；根据所述第一联合分布似然值和所述第二联合分布似然值确定所述染色体区域是否为基因组纯合区域。For each chromosome region, according to the positions of all the base sequences for detection, select the SNP site covered by at least one base sequence for detection in the chromosome region as the target SNP site, and determine each The first number of times the A allele is covered by the detection base sequence and the second time the B allele is covered by the detection base sequence at the target SNP site; according to the first times and the second times to calculate the first marginal likelihood value that each target SNP site belongs to the normal region and the second marginal likelihood value that belongs to the homozygous region of the genome; based on all the chromosomal regions within the Calculate a first joint distribution likelihood value based on the first marginal likelihood value of the target SNP site, and calculate a second joint distribution likelihood value based on the second marginal likelihood value of all the target SNP sites within the chromosome region. ; Determine whether the chromosome region is a homozygous region of the genome based on the first joint distribution likelihood value and the second joint distribution likelihood value. 在一些实施例中，所述预设质量为所述碱基序列和所述人类参考基因组仅有一个碱基错配。In some embodiments, the preset quality is that there is only one base mismatch between the base sequence and the human reference genome. 在一些实施例中，每一所述染色体区域的宽度均为所述预设窗宽，所述预设窗宽大于所述预设步长，相邻所述染色体区域存在重叠。In some embodiments, the width of each chromosome region is the preset window width, the preset window width is greater than the preset step size, and adjacent chromosome regions overlap. 在一些实施例中，所述根据所述第一次数和所述第二次数计算每一所述目标SNP位点属于正常区域的第一边缘似然值和属于基因组纯合区域的第二边缘似然值具体包括：In some embodiments, the first edge likelihood value of each target SNP site belonging to the normal region and the second edge belonging to the homozygous region of the genome are calculated based on the first number and the second number. Likelihood values specifically include: 对于每一所述目标SNP位点，以所述第一次数、所述第二次数以及正常区域对应的每一第一基因型的基因型分布概率和等位基因A的频率为输入，利用边缘似然值计算公式计算所述目标SNP位点属于正常区域的第一边缘似然值；以所述第一次数、所述第二次数以及基因组纯合区域对应的每一第二基因型的基因型分布概率和等位基因A的频率为输入，利用边缘似然值计算公式计算所述目标SNP位点属于基因组纯合区域的第二边缘似然值。For each target SNP site, using the first number, the second number, the genotype distribution probability of each first genotype corresponding to the normal region and the frequency of allele A as input, use The edge likelihood value calculation formula calculates the first edge likelihood value that the target SNP site belongs to the normal region; based on the first number, the second number, and each second genotype corresponding to the homozygous region of the genome The genotype distribution probability and the frequency of allele A are used as inputs, and the edge likelihood value calculation formula is used to calculate the second edge likelihood value that the target SNP site belongs to the homozygous region of the genome. 在一些实施例中，所述正常区域对应的第一基因型包括AA、AB和BB；第一基因型AA的基因型分布概率为p2+p(1-p)F，等位基因A的频率为1-e；第一基因型AB的基因型分布概率为2p(1-p)(1-F)，等位基因A的频率为1/2；第一基因型BB的基因型分布概率为(1-p)2+p(1-p)F，等位基因A的频率为e；其中，p为A等位基因在个体所属种族人群中的群体频率；F为个体的近交系数；e为测序错误率；In some embodiments, the first genotype corresponding to the normal region includes AA, AB and BB; the genotype distribution probability of the first genotype AA is p 2 +p(1-p)F, and the genotype distribution probability of allele A is The frequency is 1-e; the genotype distribution probability of the first genotype AB is 2p(1-p)(1-F), the frequency of allele A is 1/2; the genotype distribution probability of the first genotype BB is (1-p) 2 +p(1-p)F, the frequency of allele A is e; where p is the population frequency of allele A in the racial population to which the individual belongs; F is the inbreeding coefficient of the individual ;e is the sequencing error rate; 所述基因组纯合区域对应的第二基因型包括AA和BB；第二基因型AA的基因型分布概率为p，等位基因A的频率为1-e；第二基因型BB的基因型分布概率为1-p，等位基因A的频率为e。The second genotype corresponding to the homozygous region of the genome includes AA and BB; the genotype distribution probability of the second genotype AA is p, and the frequency of allele A is 1-e; the genotype distribution of the second genotype BB The probability is 1-p and the frequency of allele A is e. 在一些实施例中，所述边缘似然值计算公式为：In some embodiments, the edge likelihood value calculation formula is: M(F，e)＝∑gP(g)B(FA(g)，Ci)；M(F, e)=∑ g P(g)B(F A (g), C i ); 其中，M(F，e)为边缘似然值；F为个体的近交系数；e为测序错误率；P(g)为基因型g的基因型分布概率；B(FA(g)，Ci)为二项分布似然值；FA(g)为基因型g的等位基因A的频率；Ci为包括第一次数和第二次数的集合；Among them, M(F, e) is the marginal likelihood value; F is the inbreeding coefficient of the individual; e is the sequencing error rate; P(g) is the genotype distribution probability of genotype g; B(F A (g), C i ) is the binomial distribution likelihood value; F A (g) is the frequency of allele A of genotype g; C i is the set including the first number and the second number; 其中，x为随机变量，代表等位基因A的频率；ciA为第一次数；ciB为第二次数。Among them, x is a random variable, representing the frequency of allele A; c iA is the first number; c iB is the second number. 在一些实施例中，所述基于所述染色体区域内的所有所述目标SNP位点的第一边缘似然值计算第一联合分布似然值，基于所述染色体区域内的所有所述目标SNP位点的第二边缘似然值计算第二联合分布似然值具体包括：In some embodiments, the first joint distribution likelihood value is calculated based on the first marginal likelihood values of all the target SNP sites in the chromosomal region, based on all the target SNPs in the chromosomal region. Calculating the second joint distribution likelihood value of the second marginal likelihood value of the site specifically includes: 计算所述染色体区域内的所有所述目标SNP位点的第一边缘似然值的乘积，得到第一联合分布似然值；计算所述染色体区域内的所有所述目标SNP位点的第二边缘似然值的乘积，得到第二联合分布似然值。Calculate the product of the first marginal likelihood values of all the target SNP sites in the chromosome region to obtain a first joint distribution likelihood value; calculate the second marginal likelihood value of all the target SNP sites in the chromosome region. The product of the marginal likelihood values yields the second joint distribution likelihood value. 在一些实施例中，所述根据所述第一联合分布似然值和所述第二联合分布似然值确定所述染色体区域是否为基因组纯合区域具体包括：In some embodiments, determining whether the chromosomal region is a homozygous region of the genome based on the first joint distribution likelihood value and the second joint distribution likelihood value specifically includes: 根据所述第一联合分布似然值和所述第二联合分布似然值计算判断参数，若所述判断参数大于预设阈值，则所述染色体区域为基因组纯合区域；Calculate a judgment parameter according to the first joint distribution likelihood value and the second joint distribution likelihood value. If the judgment parameter is greater than the preset threshold, the chromosome region is a homozygous region of the genome; 所述判断参数的计算公式为：The calculation formula of the judgment parameter is: 其中，T为判断参数；LROH为第二联合分布似然值；LNormal为第一联合分布似然值；Among them, T is the judgment parameter; L ROH is the second joint distribution likelihood value; L Normal is the first joint distribution likelihood value; 或者，所述判断参数的计算公式为：Or, the calculation formula of the judgment parameter is: 其中，T为判断参数；θROH为染色体区域为基因组纯合区域的先验概率；θNormal为染色体区域为正常区域的先验概率；LROH为第二联合分布似然值；LNormal为第一联合分布似然值。Among them, T is the judgment parameter; θ ROH is the prior probability that the chromosome region is a homozygous region of the genome; θ Normal is the prior probability that the chromosome region is a normal region; L ROH is the second joint distribution likelihood value; L Normal is the third A joint distribution likelihood value. 在一些实施例中，在确定所述染色体区域是否为基因组纯合区域之后，所述方法还包括：将均为基因组纯合区域的相邻的染色体区域合并。In some embodiments, after determining whether the chromosomal region is a homozygous region of the genome, the method further includes: merging adjacent chromosomal regions that are both homozygous regions of the genome. 一种基于低深度测序数据检测基因组纯合区域的系统，所述系统包括：A system for detecting homozygous regions of the genome based on low-depth sequencing data, the system includes: 测序模块，用于利用测序深度为0.1×-1×的低深度全基因组测序技术对待测样本进行测序，得到低深度全基因组测序数据；所述待测样本为个体DNA；所述低深度全基因组测序数据包括多个碱基序列；A sequencing module is used to sequence the sample to be tested using low-depth whole-genome sequencing technology with a sequencing depth of 0.1×-1× to obtain low-depth whole-genome sequencing data; the sample to be tested is individual DNA; the low-depth whole genome Sequencing data includes multiple base sequences; 比对模块，用于分别将每一所述碱基序列与人类参考基因组进行比对，得到每一所述碱基序列在所述人类参考基因组中的位置和比对质量，并选取所述比对质量高于或者等于预设质量的碱基序列作为检测用碱基序列；An alignment module, used to compare each base sequence with the human reference genome, obtain the position and alignment quality of each base sequence in the human reference genome, and select the comparison Base sequences whose quality is higher than or equal to the preset quality are used as base sequences for detection; 划分模块，用于以预设窗宽和预设步长对所述人类参考基因组进行区域划分，得到多个染色体区域；A division module, used to divide the human reference genome into regions with a preset window width and a preset step size to obtain multiple chromosome regions; 检测模块，用于对于每一所述染色体区域，根据所有所述检测用碱基序列的位置，选取所述染色体区域中至少被一个所述检测用碱基序列覆盖的SNP位点作为目标SNP位点，并确定每一所述目标SNP位点上A等位基因被所述检测用碱基序列覆盖的第一次数和B等位基因被所述检测用碱基序列覆盖的第二次数；根据所述第一次数和所述第二次数计算每一所述目标SNP位点属于正常区域的第一边缘似然值和属于基因组纯合区域的第二边缘似然值；基于所述染色体区域内的所有所述目标SNP位点的第一边缘似然值计算第一联合分布似然值，基于所述染色体区域内的所有所述目标SNP位点的第二边缘似然值计算第二联合分布似然值；根据所述第一联合分布似然值和所述第二联合分布似然值确定所述染色体区域是否为基因组纯合区域。A detection module, configured to select, for each of the chromosome regions, an SNP site covered by at least one of the detection base sequences in the chromosome region as a target SNP site based on the positions of all the detection base sequences. points, and determine the first number of times that the A allele is covered by the detection base sequence and the second time that the B allele is covered by the detection base sequence at each of the target SNP sites; Calculate the first marginal likelihood value that each target SNP site belongs to the normal region and the second marginal likelihood value that belongs to the homozygous region of the genome according to the first number and the second number; based on the chromosome A first joint distribution likelihood value is calculated based on the first marginal likelihood values of all the target SNP sites in the region, and a second joint distribution likelihood value is calculated based on the second marginal likelihood values of all the target SNP sites in the chromosome region. Joint distribution likelihood value; determine whether the chromosome region is a genome homozygous region according to the first joint distribution likelihood value and the second joint distribution likelihood value. 根据本发明提供的具体实施例，本发明公开了以下技术效果：According to the specific embodiments provided by the present invention, the present invention discloses the following technical effects: 本发明用于提供一种基于低深度测序数据检测基因组纯合区域的方法及系统，先利用测序深度为0.1×-1×的低深度全基因组测序技术对待测样本进行测序，得到低深度全基因组测序数据，然后分别将低深度全基因组测序数据中的每一碱基序列与人类参考基因组进行比对，得到每一碱基序列在人类参考基因组中的位置和比对质量，并选取比对质量高于或者等于预设质量的碱基序列作为检测用碱基序列。最后以预设窗宽和预设步长对人类参考基因组进行区域划分，得到多个染色体区域，对于每一染色体区域，根据所有检测用碱基序列的位置，选取染色体区域中至少被一个检测用碱基序列覆盖的SNP位点作为目标SNP位点，并确定每一目标SNP位点上A等位基因被检测用碱基序列覆盖的第一次数和B等位基因被检测用碱基序列覆盖的第二次数，根据第一次数和第二次数计算每一目标SNP位点属于正常区域的第一边缘似然值和属于基因组纯合区域的第二边缘似然值，基于染色体区域内的所有目标SNP位点的第一边缘似然值计算第一联合分布似然值，基于染色体区域内的所有目标SNP位点的第二边缘似然值计算第二联合分布似然值，根据第一联合分布似然值和第二联合分布似然值确定染色体区域是否为基因组纯合区域，从而可基于0.1×-1×测序深度的低深度全基因组测序数据准确检测全基因组内的基因组纯合区域，减少对测序深度的依赖性，减少检测成本。The present invention is used to provide a method and system for detecting homozygous regions of the genome based on low-depth sequencing data. First, the low-depth whole-genome sequencing technology with a sequencing depth of 0.1×-1× is used to sequence the sample to be tested to obtain the low-depth whole genome. Sequencing data, and then compare each base sequence in the low-depth whole-genome sequencing data with the human reference genome to obtain the position and alignment quality of each base sequence in the human reference genome, and select the alignment quality The base sequence that is higher than or equal to the preset quality is used as the base sequence for detection. Finally, the human reference genome is divided into regions using the preset window width and preset step size to obtain multiple chromosome regions. For each chromosome region, based on the positions of all base sequences for detection, select the chromosome region that is used by at least one detection The SNP sites covered by the base sequence are used as target SNP sites, and the first number of base sequences for detecting the A allele and the base sequence for detecting the B allele at each target SNP site are determined. For the second number of coverage, calculate the first marginal likelihood value of each target SNP site belonging to the normal region and the second marginal likelihood value of the homozygous region of the genome based on the first number and the second number, based on the chromosomal region The first joint distribution likelihood value is calculated based on the first marginal likelihood value of all target SNP sites, and the second joint distribution likelihood value is calculated based on the second marginal likelihood value of all target SNP sites in the chromosome region. The first joint distribution likelihood value and the second joint distribution likelihood value determine whether the chromosome region is a genome homozygous region, so that genome homozygosity in the whole genome can be accurately detected based on low-depth whole-genome sequencing data of 0.1×-1× sequencing depth. area, reducing dependence on sequencing depth and reducing detection costs. 附图说明Description of the drawings 为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。In order to explain the embodiments of the present invention or the technical solutions in the prior art more clearly, the drawings needed to be used in the embodiments will be briefly introduced below. Obviously, the drawings in the following description are only some of the drawings of the present invention. Embodiments, for those of ordinary skill in the art, other drawings can also be obtained based on these drawings without exerting creative efforts. 图1为本发明实施例1所提供的方法流程图；Figure 1 is a flow chart of the method provided by Embodiment 1 of the present invention; 图2为本发明实施例1所提供的技术路线示意图；Figure 2 is a schematic diagram of the technical route provided by Embodiment 1 of the present invention; 图3为本发明实施例1所提供的原理框图；Figure 3 is a functional block diagram provided by Embodiment 1 of the present invention; 图4为本发明实施例1所提供的样本编号SRR063236的芯片结果和编程结果的对比示意图；Figure 4 is a schematic diagram comparing the chip results and programming results of sample number SRR063236 provided in Embodiment 1 of the present invention; 图5为本发明实施例1所提供的样本编号ERR062966的芯片结果和编程结果的对比示意图；Figure 5 is a schematic diagram comparing the chip results and programming results of sample number ERR062966 provided in Embodiment 1 of the present invention; 图6为本发明实施例2所提供的系统框图。Figure 6 is a system block diagram provided by Embodiment 2 of the present invention. 具体实施方式Detailed ways 下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。The technical solutions in the embodiments of the present invention will be clearly and completely described below with reference to the accompanying drawings in the embodiments of the present invention. Obviously, the described embodiments are only some of the embodiments of the present invention, rather than all the embodiments. Based on the embodiments of the present invention, all other embodiments obtained by those of ordinary skill in the art without creative efforts fall within the scope of protection of the present invention. 本发明的目的是提供一种基于低深度测序数据检测基因组纯合区域的方法及系统，可基于0.1×-1×测序深度的低深度全基因组测序数据准确检测全基因组内的基因组纯合区域，减少对测序深度的依赖性，减少检测成本。The purpose of the present invention is to provide a method and system for detecting homozygous regions of the genome based on low-depth sequencing data, which can accurately detect homozygous regions of the genome based on low-depth whole-genome sequencing data of 0.1×-1× sequencing depth. Reduce dependence on sequencing depth and reduce detection costs. 为使本发明的上述目的、特征和优点能够更加明显易懂，下面结合附图和具体实施方式对本发明作进一步详细的说明。In order to make the above objects, features and advantages of the present invention more obvious and understandable, the present invention will be described in further detail below with reference to the accompanying drawings and specific embodiments. 实施例1：Example 1: 在介绍本实施例的技术方案之前，先对本实施例中所用的部分技术术语进行介绍，以便于本领域技术人员能够更好的理解本实施例的技术方案。Before introducing the technical solution of this embodiment, some technical terms used in this embodiment will be introduced first, so that those skilled in the art can better understand the technical solution of this embodiment. (1)基因组纯合区域：在个体层面，若其基因组上的某段区域内所有SNP位点均为纯合基因型，则该区域被称为基因组纯合区域。(1) Genome homozygous region: At the individual level, if all SNP sites in a certain region of the genome are homozygous genotypes, the region is called a genome homozygous region. (2)单亲二倍体：同源染色体或染色体部分片段的两个拷贝均来源于双亲中的同一方的个体，其致病机制包括印迹基因表达障碍和隐性纯合突变。单亲二倍体可分为单亲同二体(isodisomy，iUPD)和单亲异二体(heterodisomy，hUPD)，单亲同二体来源于同一亲本的同一染色体，而单亲异二体分别来自同一亲本的两个同源染色体。本实施例聚焦单亲同二体。(2) Uniparental diploidy: Both copies of homologous chromosomes or chromosome fragments are derived from individuals from the same parent. The pathogenic mechanisms include imprinted gene expression disorders and recessive homozygous mutations. Uniparental disomy can be divided into uniparental homodisomy (iUPD) and uniparental heterodisomy (heterodisomy, hUPD). Isoparental disomy comes from the same chromosome of the same parent, while uniparental heterodisomy comes from two chromosomes of the same parent. homologous chromosomes. This example focuses on uniparental disomy. (3)印记基因：仅一方亲本来源表达，而来自另一亲本的不表达的同源基因。(3) Imprinted genes: homologous genes expressed only from one parent but not expressed from the other parent. (4)低深度全基因组测序(low-pass whole genome sequencing)技术：对样本的全体基因组序列DNA进行0.1×-1×的低深度全基因组测序，并基于生物信息学进行后续信息提取、分析的技术。该技术近年来被广泛应用于胎儿染色体畸变的产前诊断中，因为其在检测染色体拷贝数变异(copy numbervariation，CNV)方面的性能优越，也被称为CNV-seq技术。(4) Low-pass whole genome sequencing technology: perform 0.1×-1× low-depth whole genome sequencing on the entire genome sequence DNA of the sample, and perform subsequent information extraction and analysis based on bioinformatics technology. This technology has been widely used in prenatal diagnosis of fetal chromosomal aberrations in recent years because of its superior performance in detecting chromosomal copy number variations (CNV), also known as CNV-seq technology. (5)read杂合位点：本实施例中新定义的概念，当一个SNP位点能够被1条以上的read(碱基序列)覆盖，若这些reads在该SNP位点测得的碱基不完全相同，则该SNP位点被称为read杂合位点。(5) Read hybrid site: A newly defined concept in this example. When a SNP site can be covered by more than one read (base sequence), if these reads measure the bases at the SNP site If they are not identical, the SNP site is called a read hybrid site. (6)read纯合位点：本实施例中新定义的概念，当一个SNP位点能够被1条以上的read覆盖，若这些reads在该SNP位点测得的碱基均相同，则该SNP位点被称为read纯合位点。(6) Read homozygous site: A newly defined concept in this example. When a SNP site can be covered by more than one read, if the bases measured by these reads at the SNP site are all the same, then the SNP sites are called read homozygous sites. 本实施例中，若一个SNP位点能被1条以上的read覆盖，便可以将该SNP位点定义为read纯合位点或read杂合位点。值得注意的是，被定义为read纯合位点的SNP位点不一定是纯合型，很可能另一个等位基因并没有机会被测到；被定义为read杂合位点的SNP位点也不一定是杂合型，可能是由随机测序错误导致的。虽然对于单个SNP位点只能提供模糊的信息，SNP位点的基因分型仍然是未知的，但是若将某个区域内的足够多个SNP位点上的模糊信息联合在一起分析，建立一个联合分布的概率模型，就能推断这个区域整体上的ROH信息。基于这一思路，本实施例针对现有检测模型的盲点，建立基于readheterozygosity(序列杂合)的检测模型，目标是在极低的测序深度下回溯有效信息，高效率高精度完成基因组纯合区域的检测。In this embodiment, if a SNP site can be covered by more than one read, the SNP site can be defined as a read homozygous site or a read heterozygous site. It is worth noting that SNP sites defined as read homozygous sites are not necessarily homozygous, and it is possible that the other allele has no chance of being detected; SNP sites defined as read heterozygous sites It is not necessarily heterozygous and may be caused by random sequencing errors. Although only fuzzy information can be provided for a single SNP site, and the genotyping of the SNP site is still unknown, if the fuzzy information on enough SNP sites in a certain region is analyzed together, a The probability model of joint distribution can infer the overall ROH information of this area. Based on this idea, this embodiment aims at the blind spots of the existing detection models and establishes a detection model based on readheterozygosity (sequence heterozygosity). The goal is to trace back effective information at extremely low sequencing depth and complete the homozygous region of the genome with high efficiency and accuracy. detection. 本实施例用于提供一种基于低深度测序数据检测基因组纯合区域的方法，如图1、图2和图3所示，所述方法包括：This embodiment is used to provide a method for detecting homozygous regions of the genome based on low-depth sequencing data, as shown in Figure 1, Figure 2 and Figure 3. The method includes: S1：利用测序深度为0.1×-1×的低深度全基因组测序技术对待测样本进行测序，得到低深度全基因组测序数据；所述待测样本为个体DNA；所述低深度全基因组测序数据包括多个碱基序列；S1: Sequence the sample to be tested using low-depth whole-genome sequencing technology with a sequencing depth of 0.1×-1× to obtain low-depth whole-genome sequencing data; the sample to be tested is individual DNA; the low-depth whole-genome sequencing data includes multiple base sequences; 待测样本的获取方式可以为：通过抽血、口腔拭子等方式从个体中采集样品，并对样品进行DNA提取，即可获得单个个体的DNA，DNA提取的方法可以采用现有的任意一种方法，比如玻璃珠法、超声波法、研磨法、碱裂解法等。个体是指任意的人。The sample to be tested can be obtained by: collecting samples from individuals through blood drawing, oral swabs, etc., and extracting DNA from the samples to obtain the DNA of a single individual. The DNA extraction method can be any existing method. methods, such as glass bead method, ultrasonic method, grinding method, alkali lysis method, etc. An individual refers to any person. 在分别将每一碱基序列与人类参考基因组进行比对之前，本实施例的方法还可以包括：对低深度全基因组测序数据进行预处理，预处理方式可以包括：删除低深度全基因组测序数据中PCR扩增引入的重复碱基序列；删除低深度全基因组测序数据中包含一个及以上碱基N的碱基序列，碱基N是指没有测定的碱基；删除低深度全基因组测序数据中连续多个碱基的平均测序质量低于预设值的碱基序列，连续多个碱基的个数至少为5个，预设值可为20，即删除连续5个及以上碱基的平均测序质量低于20的碱基序列；截去低深度全基因组测序数据中存在接头污染的碱基序列中的接头污染部分，由于接头是已知序列，故可直接在碱基序列中识别出接头，识别出接头后直接在碱基序列中截去这一接头即可。通过上述预处理方式，即可对低深度全基因组测序数据进行质量控制，得到预处理后测序数据，并以预处理后测序数据作为新的低深度全基因组测序数据，执行后续S2。Before comparing each base sequence with the human reference genome respectively, the method of this embodiment may also include: preprocessing the low-depth whole-genome sequencing data. The pre-processing method may include: deleting the low-depth whole-genome sequencing data. Repeated base sequences introduced by PCR amplification; delete base sequences containing one or more base N in low-depth whole-genome sequencing data, where base N refers to unmeasured bases; delete base sequences in low-depth whole-genome sequencing data The average sequencing quality of multiple consecutive bases is lower than the preset value. The number of consecutive multiple bases is at least 5. The preset value can be 20, that is, the average sequencing quality of 5 consecutive bases and above is deleted. Base sequences with sequencing quality lower than 20; truncate the linker-contaminated portion of base sequences with linker contamination in low-depth whole-genome sequencing data. Since the linker is a known sequence, the linker can be directly identified in the base sequence. , after identifying the linker, simply truncate the linker in the base sequence. Through the above preprocessing method, the quality control of low-depth whole-genome sequencing data can be performed, and the pre-processed sequencing data can be obtained, and the pre-processed sequencing data can be used as new low-depth whole-genome sequencing data to execute subsequent S2. S2：分别将每一所述碱基序列与人类参考基因组进行比对，得到每一所述碱基序列在所述人类参考基因组中的位置和比对质量，并选取所述比对质量高于或者等于预设质量的碱基序列作为检测用碱基序列；S2: Compare each base sequence with the human reference genome respectively, obtain the position and alignment quality of each base sequence in the human reference genome, and select the alignment quality higher than Or a base sequence equal to the preset quality is used as the base sequence for detection; 本实施例可以使用BWA软件将质控后保留下的每一碱基序列比对到人类参考基因组，以确定每一碱基序列在人类参考基因组的位置，比对策略是最多允许一个碱基错配，只有满足这一比对策略，碱基序列才可以被保留，作为检测用碱基序列，用于后续分析。即本实施例的预设质量为碱基序列和人类参考基因组仅有一个碱基错配，只有当碱基序列的比对质量高于或者等于这一预设质量，也即碱基序列与人类参考基因组只有一个碱基错配或者没有碱基错配时，才能被作为检测用碱基序列。通过上述比对步骤，可挑选出多个检测用碱基序列。In this example, BWA software can be used to align each base sequence retained after quality control to the human reference genome to determine the position of each base sequence in the human reference genome. The alignment strategy allows at most one base error. Matching, only if this alignment strategy is met, the base sequence can be retained and used as the base sequence for detection for subsequent analysis. That is, the preset quality of this embodiment is that there is only one base mismatch between the base sequence and the human reference genome. Only when the alignment quality of the base sequence is higher than or equal to this preset quality, that is, the base sequence matches the human reference genome. Only when the reference genome has only one base mismatch or no base mismatch can it be used as the base sequence for detection. Through the above comparison steps, multiple base sequences for detection can be selected. S3：以预设窗宽和预设步长对所述人类参考基因组进行区域划分，得到多个染色体区域；S3: Divide the human reference genome into regions using a preset window width and a preset step size to obtain multiple chromosome regions; 本实施例中，每一染色体区域的宽度均为预设窗宽，预设窗宽大于预设步长，故相邻染色体区域存在重叠。具体的，选择合适的窗宽和步长对人类参考基因组进行染色体区域划分，如果窗宽过大，超出ROH的实际范围，有效信号被稀释，真实ROH就难以检出，如果窗宽过小，窗内可用SNP位点数太少，灵敏度就会低，因此需将灵敏度和真阳性率综合考量，以确定窗宽和步长，本实施例具体选取预设窗宽为5Mb，预设步长为1Mb。在确定预设窗宽和预设步长后，按照预设窗宽和预设步长即可将人类参考基因组划分为多个染色体区域，每个染色体区域的宽度为5Mb，相邻染色体区域之间重叠部分为4Mb。In this embodiment, the width of each chromosome region is a preset window width, and the preset window width is greater than the preset step size, so adjacent chromosome regions overlap. Specifically, select the appropriate window width and step size to divide the chromosome regions of the human reference genome. If the window width is too large and exceeds the actual range of ROH, the effective signal will be diluted and the real ROH will be difficult to detect. If the window width is too small, If the number of available SNP sites in the window is too small, the sensitivity will be low. Therefore, the sensitivity and true positive rate need to be comprehensively considered to determine the window width and step size. In this embodiment, the default window width is specifically selected to be 5Mb, and the default step size is 1MB. After determining the preset window width and preset step size, the human reference genome can be divided into multiple chromosome regions according to the preset window width and preset step size. The width of each chromosome region is 5Mb, and the width of each chromosome region is 5Mb. The overlap between them is 4Mb. S4：对于每一所述染色体区域，根据所有所述检测用碱基序列的位置，选取所述染色体区域中至少被一个所述检测用碱基序列覆盖的SNP位点作为目标SNP位点，并确定每一所述目标SNP位点上A等位基因被所述检测用碱基序列覆盖的第一次数和B等位基因被所述检测用碱基序列覆盖的第二次数；根据所述第一次数和所述第二次数计算每一所述目标SNP位点属于正常区域的第一边缘似然值和属于基因组纯合区域的第二边缘似然值；基于所述染色体区域内的所有所述目标SNP位点的第一边缘似然值计算第一联合分布似然值，基于所述染色体区域内的所有所述目标SNP位点的第二边缘似然值计算第二联合分布似然值；根据所述第一联合分布似然值和所述第二联合分布似然值确定所述染色体区域是否为基因组纯合区域。S4: For each chromosome region, according to the positions of all the base sequences for detection, select the SNP site covered by at least one base sequence for detection in the chromosome region as the target SNP site, and Determine the first number of times that the A allele is covered by the detection base sequence and the second time that the B allele is covered by the detection base sequence at each of the target SNP sites; according to the The first number and the second number are used to calculate the first marginal likelihood value that each target SNP site belongs to the normal region and the second marginal likelihood value that belongs to the homozygous region of the genome; based on the A first joint distribution likelihood value is calculated based on the first marginal likelihood value of all the target SNP sites, and a second joint distribution likelihood value is calculated based on the second marginal likelihood value of all the target SNP sites within the chromosome region. a likelihood value; determine whether the chromosome region is a genome homozygous region based on the first joint distribution likelihood value and the second joint distribution likelihood value. 本实施例中，ROH检测模型的建立过程包括构建概率分布模型和目标联合概率分布模型，具体如下：In this embodiment, the establishment process of the ROH detection model includes constructing a probability distribution model and a target joint probability distribution model, as follows: 虽然CNV-seq是不到1×的低深度测序，但得到的低深度全基因组测序数据中仍然有足够多的SNP位点能被1条以上的检测用碱基序列覆盖，如表2所示。对于任何覆盖度(即覆盖该SNP位点的检测用碱基序列的条数)大于1的目标SNP位点，本实施例可以定义该目标SNP位点为read纯合位点或read杂合位点。Although CNV-seq is a low-depth sequencing of less than 1×, there are still enough SNP sites in the obtained low-depth whole-genome sequencing data that can be covered by more than one base sequence for detection, as shown in Table 2 . For any target SNP site whose coverage (that is, the number of detection base sequences covering the SNP site) is greater than 1, this embodiment can define the target SNP site as a read homozygous site or a read heterozygous site. point. 表2Table 2 表2体现出在1×低深度测序情况下，CNV-seq样本中能够被1条、2条、3条检测用碱基序列所覆盖的SNP位点的数目。由表2可知，即便样本的平均覆盖度仅为1×，仍有足够多的SNP位点能被1条以上的检测用碱基序列覆盖。Table 2 shows the number of SNP sites in CNV-seq samples that can be covered by 1, 2, and 3 detection base sequences under 1× low-depth sequencing. It can be seen from Table 2 that even if the average coverage of the sample is only 1×, there are still enough SNP sites that can be covered by more than one base sequence for detection. 本实施例所构建的概率分布模型是在理想模型的基础上，纳入测序错误率e和该个体的近交系数F所得到的实际模型。对于两等位基因的SNP位点，近交系数F直接影响基因型AA，BB以及AB的概率。The probability distribution model constructed in this embodiment is an actual model obtained by incorporating the sequencing error rate e and the inbreeding coefficient F of the individual on the basis of the ideal model. For two allele SNP sites, the inbreeding coefficient F directly affects the probability of genotypes AA, BB and AB. 本实施例的概率分布模型具体包括：The probability distribution model of this embodiment specifically includes: (1)对于正常区域，任意SNP位点上的个体基因型分布概率P(g)和等位基因A的频率FA(g)如下表3：(1) For the normal region, the individual genotype distribution probability P (g) and the frequency of allele A F A (g) at any SNP site are as follows in Table 3: 表3table 3 (2)对于基因组纯合区域，任意SNP位点上的个体基因型分布概率P(g)和等位基因A的频率FA(g)如下表4：(2) For the homozygous region of the genome, the individual genotype distribution probability P (g) and the frequency of allele A F A (g) at any SNP site are as follows in Table 4: 表4Table 4 基因型gGenotype g 基因型分布概率P(g)Genotype distribution probability P(g) 等位基因A的频率FA(g)Frequency of allele A F A (g) AAAA pp 1-e1-e BBBB 1-p1-p ee 基于上述概率分布模型，本实施例的目标联合概率分布模型如下：Based on the above probability distribution model, the target joint probability distribution model of this embodiment is as follows: 对于被任意1条以上检测用碱基序列覆盖的目标SNP位点i，其中两个等位基因A和B被检测用碱基序列覆盖的次数集合记为Ci＝(ciA，ciB)，令随机变量x为等位基因A的频率，可得二项分布似然值为：For the target SNP site i covered by more than one base sequence for detection, the set of times that the two alleles A and B are covered by the base sequence for detection is recorded as C i = (ci A , c iB ), let the random variable x be the frequency of allele A, and the binomial distribution likelihood value can be obtained as: 式(1)中，B(x，Ci)为二项分布似然值；x为随机变量，代表等位基因A的频率，在表3和表4中已给出，当基因型g确定时，x的值就是已知的；ciA为目标SNP位点i中等位基因A被检测用碱基序列覆盖的第一次数；ciB为目标SNP位点i中等位基因B被检测用碱基序列覆盖的第二次数，由于SNP位点的坐标是已知的，故可基于S2的比对步骤确定覆盖目标SNP位点i的所有检测用碱基序列，将与目标SNP位点i相应位置处的碱基为等位基因A的检测用碱基序列的个数记为第一次数，将与目标SNP位点i相应位置处的碱基为等位基因B的检测用碱基序列的个数记为第二次数，故第一次数和第二次数都是已知值。基于此，在基因型确定时，二项分布似然值便是可以计算得到的已知值。In formula (1), B(x,C i ) is the binomial distribution likelihood value; x is a random variable, representing the frequency of allele A, which has been given in Tables 3 and 4. When the genotype g is determined When ,thevalueof For the second time of base sequence coverage for detection, since the coordinates of the SNP site are known, all detection base sequences covering the target SNP site i can be determined based on the comparison step of S2, and will be compared with the target SNP site The base at the corresponding position of point i is used for the detection of allele A. The number of base sequences is recorded as the first number. The base at the position corresponding to the target SNP site i is used for the detection of allele B. The number of base sequences is recorded as the second degree, so the first number and the second degree are both known values. Based on this, when the genotype is determined, the binomial distribution likelihood value is a known value that can be calculated. 对于每个目标SNP位点i，先利用式(1)计算出每种基因型g所对应的二项分布似然值，再以基因型g的基因型分布概率P(g)为权重，对基因型g进行加权求和计算出目标SNP位点i的边缘似然值，边缘似然值计算公式如下：For each target SNP site i, first use formula (1) to calculate the binomial distribution likelihood value corresponding to each genotype g, and then use the genotype distribution probability P(g) of genotype g as the weight. The genotype g is weighted and summed to calculate the edge likelihood value of the target SNP site i. The edge likelihood value calculation formula is as follows: M(F，e)＝∑gP(g)B(FA(g)，Ci)； (2)M(F, e)=∑ g P(g)B(F A (g), C i ); (2) 式(2)中，M(F，e)为目标SNP位点i的边缘似然值；F为个体的近交系数；e为测序错误率；P(g)为基因型g的基因型分布概率；B(FA(g)，Ci)为二项分布似然值；FA(g)为基因型g的等位基因A的频率；Ci为包括第一次数和第二次数的集合。In formula (2), M(F, e) is the marginal likelihood value of the target SNP site i; F is the inbreeding coefficient of the individual; e is the sequencing error rate; P(g) is the genotype distribution of genotype g. Probability; B(F A (g), C i ) is the binomial distribution likelihood value; F A (g) is the frequency of allele A of genotype g; C i includes the first and second times collection. 将染色体区域R内所有目标SNP位点的边缘似然值相乘，即可得到染色体区域内SNP位点联合分布的联合分布似然值，计算公式如下：By multiplying the marginal likelihood values of all target SNP sites in the chromosome region R, the joint distribution likelihood value of the joint distribution of SNP sites in the chromosome region can be obtained. The calculation formula is as follows: L(F，e)＝Πi∈RM(F，e)； (3)L(F, e)=Π i∈R M(F, e); (3) 式(3)中，L(F，e)为染色体区域R的联合分布似然值。In formula (3), L(F, e) is the joint distribution likelihood value of chromosome region R. 基于上述目标联合概率分布模型，即可确定染色体区域内的SNP位点的联合分布似然值。Based on the above target joint probability distribution model, the joint distribution likelihood value of SNP sites within the chromosome region can be determined. 概率分布模型中，A等位基因在个体所属种族人群中的群体频率p是个已知值，个体所属种群包括东亚人、欧洲人等，测序错误率e是已知值，约为1/1000，本实施例还提供另外一种测序错误率e的计算方式：选取人类参考基因组中所有只被检测用碱基序列覆盖一次的非SNP(non-SNP)位点(其是指除SNP位点之外的其他位点)，由于非SNP位点上测得的碱基应当与人类参考基因组一致，故判断覆盖该非SNP位点的与人类参考基因组不一致的碱基为测序错误，统计在覆盖度为1的所有非SNP位点上，与人类参考基因组不一致的位点数占总位点数的比例，以该比例作为测序错误率e。个体的近交系数F的计算方式为：令染色体区域R是人类参考基因组的全区域，并认为全区域均是正常区域，确定全区域中每一至少被一条检测用碱基序列覆盖的目标SNP位点对应的第一次数和第二次数，对于每一目标SNP位点，同时将第一次数、第二次数和表3中每一基因型的等位基因A的频率FA(g)代入式(1)，得到该目标SNP位点在每一基因型的二项分布似然值，将表3中每一基因型的基因型分布概率P(g)和该目标SNP位点在每一基因型的二项分布似然值代入式(2)，计算得到每一目标SNP位点的边缘似然值，再将全区域所有目标SNP位点的边缘似然值代入式(3)，得到Lwhole genome，Lwholegenome中唯一的变量就是F，用最大似然法即可求解得到令Lwhole genome的值最大的F，此时，F也是已知值。In the probability distribution model, the population frequency p of the A allele in the individual's ethnic group is a known value. The individual's ethnic group includes East Asians, Europeans, etc., and the sequencing error rate e is a known value, about 1/1000. This embodiment also provides another method for calculating the sequencing error rate e: select all non-SNP (non-SNP) sites in the human reference genome that are only covered once by the base sequence for detection (which refers to sites other than SNP sites). (other than other sites), since the bases measured at the non-SNP site should be consistent with the human reference genome, it is judged that the bases covering the non-SNP site that are inconsistent with the human reference genome are sequencing errors, and the statistics are in the coverage For all non-SNP sites that are 1, the ratio of the number of sites that are inconsistent with the human reference genome to the total number of sites is used as the sequencing error rate e. The calculation method of the individual inbreeding coefficient F is as follows: Let the chromosome region R be the entire region of the human reference genome, and consider the entire region to be a normal region. Determine each target SNP in the entire region that is covered by at least one base sequence for detection. The first number and the second number corresponding to the site, for each target SNP site, simultaneously compare the first number, the second number and the frequency of allele A of each genotype in Table 3 F A (g ) into equation (1) to obtain the binomial distribution likelihood value of the target SNP site in each genotype. Combine the genotype distribution probability P(g) of each genotype in Table 3 and the target SNP site in Substitute the binomial likelihood value of each genotype into equation (2) to calculate the marginal likelihood value of each target SNP site, and then substitute the marginal likelihood value of all target SNP sites in the entire region into equation (3) , get L whole genome . The only variable in L wholegenome is F. The maximum likelihood method can be used to solve the problem of F that maximizes the value of L whole genome . At this time, F is also a known value. 则基于上述检测模型，对于每一染色体区域，假设该区域为正常区域，将表3中的P(g)和FA(g)代入式(2)和式(3)，由于所有变量均已知，能够直接算出正常情况下的染色体区域内SNP位点联合分布的第一联合分布似然值，记作Lnormal；假设该区域为基因组纯合区域，将表4中的P(g)和FA(g)代入式(2)和式(3)，由于所有变量均已知，能够直接算出基因组纯合情况下的染色体区域内SNP位点联合分布的第二联合分布似然值，记作LROH。则本实施例中，对于每一染色体区域，判断该染色体区域是否为基因组纯合区域的步骤包括：Based on the above detection model, for each chromosome region, assuming that the region is a normal region, P (g) and F A (g) in Table 3 are substituted into equations (2) and (3). Since all variables have It is known that the first joint distribution likelihood value of the joint distribution of SNP sites in the chromosome region under normal conditions can be directly calculated, recorded as L normal ; assuming that the region is a homozygous region of the genome, combine P(g) in Table 4 and F A (g) is substituted into equations (2) and (3). Since all variables are known, the second joint distribution likelihood value of the joint distribution of SNP sites in the chromosome region under the condition of genome homozygosity can be directly calculated. Record Make L ROH . In this embodiment, for each chromosome region, the step of determining whether the chromosome region is a homozygous region of the genome includes: (1)根据所有检测用碱基序列的位置，选取染色体区域中至少被一个检测用碱基序列覆盖的SNP位点作为目标SNP位点，并确定每一目标SNP位点上A等位基因被检测用碱基序列覆盖的第一次数和B等位基因被检测用碱基序列覆盖的第二次数。(1) Based on the positions of all base sequences for detection, select SNP sites in the chromosome region that are covered by at least one base sequence for detection as target SNP sites, and determine whether the A allele at each target SNP site is The first number of times the B allele is covered by the detection base sequence and the second number of times the B allele is covered by the detection base sequence. (2)根据第一次数和第二次数计算每一目标SNP位点属于正常区域的第一边缘似然值和属于基因组纯合区域的第二边缘似然值。(2) Calculate the first marginal likelihood value that each target SNP site belongs to the normal region and the second marginal likelihood value that belongs to the homozygous region of the genome based on the first number and the second number. 对于每一目标SNP位点，以第一次数、第二次数以及正常区域对应的每一第一基因型的基因型分布概率和等位基因A的频率为输入，利用边缘似然值计算公式计算目标SNP位点属于正常区域的第一边缘似然值。以第一次数、第二次数以及基因组纯合区域对应的每一第二基因型的基因型分布概率和等位基因A的频率为输入，利用边缘似然值计算公式计算目标SNP位点属于基因组纯合区域的第二边缘似然值。For each target SNP site, take the first number, the second number, the genotype distribution probability of each first genotype corresponding to the normal region and the frequency of allele A as input, and use the marginal likelihood value calculation formula Calculate the first marginal likelihood value that the target SNP site belongs to the normal region. Taking the first number, the second number, the genotype distribution probability of each second genotype corresponding to the homozygous region of the genome and the frequency of allele A as input, use the marginal likelihood value calculation formula to calculate whether the target SNP site belongs to Second marginal likelihood values for homozygous regions of the genome. 其中，正常区域对应的第一基因型包括AA、AB和BB，第一基因型AA的基因型分布概率为p2+p(1-p)F，等位基因A的频率为1-e；第一基因型AB的基因型分布概率为2p(1-p)(1-F)，等位基因A的频率为1/2；第一基因型BB的基因型分布概率为(1-p)2+p(1-p)F，等位基因A的频率为e，其中，p为A等位基因在个体所属种族人群中的群体频率；F为个体的近交系数；e为测序错误率，具体参见表3。基因组纯合区域对应的第二基因型包括AA和BB，第二基因型AA的基因型分布概率为p，等位基因A的频率为1-e；第二基因型BB的基因型分布概率为1-p，等位基因A的频率为e，具体参见表4。Among them, the first genotype corresponding to the normal region includes AA, AB and BB. The genotype distribution probability of the first genotype AA is p 2 +p(1-p)F, and the frequency of allele A is 1-e; The genotype distribution probability of the first genotype AB is 2p(1-p)(1-F), and the frequency of allele A is 1/2; the genotype distribution probability of the first genotype BB is (1-p) 2 +p(1-p)F, the frequency of allele A is e, where p is the population frequency of allele A in the racial population to which the individual belongs; F is the inbreeding coefficient of the individual; e is the sequencing error rate , see Table 3 for details. The second genotype corresponding to the homozygous region of the genome includes AA and BB. The genotype distribution probability of the second genotype AA is p, and the frequency of allele A is 1-e; the genotype distribution probability of the second genotype BB is 1-p, the frequency of allele A is e, see Table 4 for details. (3)基于染色体区域内的所有目标SNP位点的第一边缘似然值计算第一联合分布似然值，基于染色体区域内的所有目标SNP位点的第二边缘似然值计算第二联合分布似然值。(3) Calculate the first joint distribution likelihood value based on the first marginal likelihood value of all target SNP sites in the chromosome region, and calculate the second joint distribution likelihood value based on the second marginal likelihood value of all target SNP sites in the chromosome region Distribution likelihood value. 具体的，计算染色体区域内的所有目标SNP位点的第一边缘似然值的乘积，得到第一联合分布似然值；计算染色体区域内的所有目标SNP位点的第二边缘似然值的乘积，得到第二联合分布似然值。Specifically, the product of the first marginal likelihood values of all target SNP sites in the chromosome region is calculated to obtain the first joint distribution likelihood value; the second marginal likelihood value of all target SNP sites in the chromosome region is calculated. product to obtain the second joint distribution likelihood value. (4)根据第一联合分布似然值和第二联合分布似然值确定染色体区域是否为基因组纯合区域。(4) Determine whether the chromosome region is a homozygous region of the genome based on the first joint distribution likelihood value and the second joint distribution likelihood value. 根据第一联合分布似然值和第二联合分布似然值计算判断参数，若判断参数大于预设阈值，则染色体区域为基因组纯合区域，否则，则染色体区域为正常区域。The judgment parameter is calculated based on the first joint distribution likelihood value and the second joint distribution likelihood value. If the judgment parameter is greater than the preset threshold, the chromosome region is a homozygous region of the genome; otherwise, the chromosome region is a normal region. 其中，判断参数的计算公式为：Among them, the calculation formula of the judgment parameter is: 式(4)中，T为判断参数；LROH为第二联合分布似然值；LNormal为第一联合分布似然值。In formula (4), T is the judgment parameter; L ROH is the second joint distribution likelihood value; L Normal is the first joint distribution likelihood value. 或者，判断参数的计算公式为：Or, the calculation formula of the judgment parameter is: 式(5)中，T为判断参数；θROH为染色体区域为基因组纯合区域ROH的先验概率；θNormal为染色体区域为正常区域的先验概率；LROH为第二联合分布似然值；LNormal为第一联合分布似然值。θROH和θNormal可根据经验来赋值，θROH的取值范围可在1/5000到1/3000，本实施例可令θROH＝1/3500。θNormal＝1-θROH，在根据取值范围确定θROH后，θNormal也是已知的。In formula (5), T is the judgment parameter; θ ROH is the prior probability that the chromosome region is the homozygous region ROH of the genome; θ Normal is the prior probability that the chromosome region is the normal region; L ROH is the second joint distribution likelihood value ;L Normal is the first joint distribution likelihood value. θ ROH and θ Normal can be assigned values based on experience. The value range of θ ROH can be from 1/5000 to 1/3000. In this embodiment, θ ROH =1/3500. θ Normal =1-θ ROH . After determining θ ROH according to the value range, θ Normal is also known. 本实施例提供两种判断参数的计算方法，一是直接计算对数似然比，即利用式(4)计算判断参数，二是考虑先验概率，纳入贝叶斯框架，计算后验概率的对数比，即利用式(5)计算判断参数，相较于第一种计算方法仅仅基于当前数据来计算判断参数，第二种计算方法同时考虑到先验信息和当前数据两方面，能够更好地避免假阳性。This embodiment provides two methods for calculating judgment parameters. One is to directly calculate the log likelihood ratio, that is, use formula (4) to calculate the judgment parameters. The second is to consider the prior probability and incorporate it into the Bayesian framework to calculate the posterior probability. Log ratio, that is, using equation (5) to calculate the judgment parameters. Compared with the first calculation method which only calculates the judgment parameters based on the current data, the second calculation method takes into account both the prior information and the current data and can be more accurate. Good to avoid false positives. 当一个染色体区域检测完毕，则按照顺序，检测下一个染色体区域，最终得到全基因组范围内全部染色体区域各自的判定结果。若该待测样本中没有任何染色体区域被判定为ROH，则不报出；若有染色体区域被判定为ROH，则查看该染色体区域的坐标判断是否存在重叠的染色体区域，将存在重叠关系的染色体区域进行合并，输出合并后的ROH区域。即在确定染色体区域是否为基因组纯合区域之后，本实施例的方法还包括：将均为基因组纯合区域的相邻的染色体区域合并。When one chromosome region is detected, the next chromosome region is detected in sequence, and finally the respective determination results of all chromosome regions in the entire genome are obtained. If there is no chromosome region in the sample to be tested that is judged to be ROH, it will not be reported; if there is a chromosome region that is judged to be ROH, the coordinates of the chromosome region will be checked to determine whether there are overlapping chromosome regions, and the chromosomes with overlapping relationships will be The areas are merged and the merged ROH area is output. That is, after determining whether a chromosome region is a homozygous region of the genome, the method of this embodiment further includes: merging adjacent chromosome regions that are both homozygous regions of the genome. 本实施例基于低深度全基因组测序数据，通过建立检测的数学模型，实现对5Mb以上染色体区域ROH的检测，在保证检测准确性的同时，减少对测序深度的依赖性，并在保证检测成本的前提下，拓宽CNV-seq技术在诊断中的检测范围。This embodiment is based on low-depth whole-genome sequencing data and establishes a mathematical model for detection to achieve detection of ROH in chromosomal regions above 5Mb, while ensuring detection accuracy, reducing dependence on sequencing depth, and ensuring detection costs. Under the premise, the detection range of CNV-seq technology in diagnosis will be broadened. 目前已报道了多种与基因组纯合区域相关的基因印记障碍问题，在新生儿中的发生率约为1/3500，会导致发育异常，智力障碍等严重的出生缺陷，因此如果产前漏检基因组纯合区域，将产生严重后果。本实施例的方法还可应用于产前诊断，对胎儿的ROH进行判断，通过产前侵入式检测(通过绒毛取样、羊水穿刺等方法，获取绒毛、羊水、脐血等样本，主要检测成分以胎儿DNA为主，以有创、微创为代价对胎儿产前情况进行筛查的一种技术)获取胎儿DNA，利用上述方法即可判断胎儿是否存在ROH区域。A variety of genetic imprinting disorders related to homozygous regions of the genome have been reported. The incidence rate in newborns is about 1/3500, which can lead to severe birth defects such as developmental abnormalities and intellectual disability. Therefore, if prenatal detection is missed, Homozygous regions of the genome will have serious consequences. The method of this embodiment can also be applied to prenatal diagnosis to determine the ROH of the fetus. Through prenatal invasive testing (through chorionic villus sampling, amniocentesis and other methods, samples such as chorionic villi, amniotic fluid, and umbilical cord blood are obtained. The main detection components are: Fetal DNA is mainly used to obtain fetal DNA, which is a technology for prenatal screening of the fetus at the expense of invasive and minimally invasive methods. The above method can be used to determine whether the fetus has a ROH region. 本实施例选取样本编号为SRR063236，ERR062966的两组结果进行展示，芯片结果是指利用芯片得到的UPD区段，编程结果是指利用本实施例的方法得到的UPD区段，由图4和图5可看出，芯片结果与利用本实施例方法得到的编程结果具有高度一致性，这也说明了本实施例的方法的有效性和准确性。This embodiment selects two sets of results of sample numbers SRR063236 and ERR062966 for display. The chip result refers to the UPD section obtained by using the chip. The programming result refers to the UPD section obtained by using the method of this embodiment. As shown in Figure 4 and Figure 5, it can be seen that the chip results are highly consistent with the programming results obtained using the method of this embodiment, which also illustrates the effectiveness and accuracy of the method of this embodiment. 本实施例在低深度全基因组测序技术前提下，利用数学模型建立仅在测序深度1×的情况下，建立正常区域和基因组纯合区域的基因型分布概率和等位基因A的频率的分布模型，在考虑近交系数、测序错误率、人群等位基因频率信息下分析杂合度的差距，可以将现有的4×以上的测序深度降为1×，大大的降低了检测成本，提升了在低深度下检验的准确性。现有技术存在突变率高，假阳性比例高，价格昂贵，测序范围有限等问题，因此本实施例提出结合全基因组测序(CNV-seq)技术，对全基因组进行测序，扩大了测序的范围；并且开创了将测序深度降低至1×的方法，克服了如今测序深度无法降低的问题。利用精准的数学模型，考虑胎儿近交系数、测序错误率、人群等位基因频率信息，利用概率统计方法，另辟蹊径，有效的求解分析出基因组纯合区域，达到有效降低成本，增加测试准确度以及应用广度的目的，解决了现有技术中ROH检测成本高、应用场景有限的问题，可扩展UPD检测等领域，扩大了低深度全基因组测序技术的应用范围。In this embodiment, under the premise of low-depth whole-genome sequencing technology, a mathematical model is used to establish a distribution model of the genotype distribution probability and the frequency of allele A in the normal region and the homozygous region of the genome, using only a sequencing depth of 1×. , by analyzing the heterozygosity gap taking into account the inbreeding coefficient, sequencing error rate, and population allele frequency information, the existing sequencing depth of more than 4× can be reduced to 1×, which greatly reduces the detection cost and improves the detection efficiency. Inspection accuracy at low depths. The existing technology has problems such as high mutation rate, high false positive ratio, high price, and limited sequencing range. Therefore, this embodiment proposes to combine whole genome sequencing (CNV-seq) technology to sequence the whole genome, expanding the scope of sequencing; It also pioneered a method to reduce the sequencing depth to 1×, overcoming the current problem that the sequencing depth cannot be reduced. Utilize accurate mathematical models, consider fetal inbreeding coefficient, sequencing error rate, population allele frequency information, and use probabilistic statistical methods to find new ways to effectively solve and analyze the homozygous regions of the genome to effectively reduce costs, increase test accuracy, and The purpose of application breadth is to solve the problems of high ROH detection cost and limited application scenarios in the existing technology, expand UPD detection and other fields, and expand the application scope of low-depth whole-genome sequencing technology. 实施例2：Example 2: 本实施例用于提供一种基于低深度测序数据检测基因组纯合区域的系统，如图6所示，所述系统包括：This embodiment is used to provide a system for detecting homozygous regions of the genome based on low-depth sequencing data. As shown in Figure 6, the system includes: 测序模块M1，用于利用测序深度为0.1×-1×的低深度全基因组测序技术对待测样本进行测序，得到低深度全基因组测序数据；所述待测样本为个体DNA；所述低深度全基因组测序数据包括多个碱基序列；The sequencing module M1 is used to sequence the sample to be tested using low-depth whole-genome sequencing technology with a sequencing depth of 0.1×-1× to obtain low-depth whole-genome sequencing data; the sample to be tested is individual DNA; the low-depth whole-genome sequencing technology Genome sequencing data includes multiple base sequences; 比对模块M2，用于分别将每一所述碱基序列与人类参考基因组进行比对，得到每一所述碱基序列在所述人类参考基因组中的位置和比对质量，并选取所述比对质量高于或者等于预设质量的碱基序列作为检测用碱基序列；Alignment module M2 is used to compare each base sequence with the human reference genome, obtain the position and alignment quality of each base sequence in the human reference genome, and select the The base sequence whose alignment quality is higher than or equal to the preset quality is used as the base sequence for detection; 划分模块M3，用于以预设窗宽和预设步长对所述人类参考基因组进行区域划分，得到多个染色体区域；The division module M3 is used to divide the human reference genome into regions with a preset window width and a preset step size to obtain multiple chromosome regions; 检测模块M4，用于对于每一所述染色体区域，根据所有所述检测用碱基序列的位置，选取所述染色体区域中至少被一个所述检测用碱基序列覆盖的SNP位点作为目标SNP位点，并确定每一所述目标SNP位点上A等位基因被所述检测用碱基序列覆盖的第一次数和B等位基因被所述检测用碱基序列覆盖的第二次数；根据所述第一次数和所述第二次数计算每一所述目标SNP位点属于正常区域的第一边缘似然值和属于基因组纯合区域的第二边缘似然值；基于所述染色体区域内的所有所述目标SNP位点的第一边缘似然值计算第一联合分布似然值，基于所述染色体区域内的所有所述目标SNP位点的第二边缘似然值计算第二联合分布似然值；根据所述第一联合分布似然值和所述第二联合分布似然值确定所述染色体区域是否为基因组纯合区域。The detection module M4 is configured to select, for each of the chromosome regions, the SNP site covered by at least one of the detection base sequences in the chromosome region as the target SNP according to the positions of all the detection base sequences. site, and determine the first number of times that the A allele is covered by the detection base sequence and the second time that the B allele is covered by the detection base sequence at each target SNP site. ; Calculate the first marginal likelihood value of each target SNP site belonging to the normal region and the second marginal likelihood value belonging to the homozygous region of the genome based on the first number and the second number; based on the Calculate a first joint distribution likelihood value based on the first marginal likelihood values of all the target SNP sites in the chromosome region, and calculate a third marginal likelihood value based on the second marginal likelihood values of all the target SNP sites in the chromosome region. Two joint distribution likelihood values; determine whether the chromosome region is a homozygous region of the genome based on the first joint distribution likelihood value and the second joint distribution likelihood value. 本说明书中每个实施例重点说明的都是与其他实施例的不同之处，各个实施例之间相同相似部分互相参见即可。对于实施例公开的系统而言，由于其与实施例公开的方法相对应，所以描述的比较简单，相关之处参见方法部分说明即可。Each embodiment in this specification focuses on its differences from other embodiments, and the same and similar parts between the various embodiments can be referred to each other. As for the system disclosed in the embodiment, since it corresponds to the method disclosed in the embodiment, the description is relatively simple. For relevant details, please refer to the description in the method section. 本文中应用了具体个例对本发明的原理及实施方式进行了阐述，以上实施例的说明只是用于帮助理解本发明的方法及其核心思想；同时，对于本领域的一般技术人员，依据本发明的思想，在具体实施方式及应用范围上均会有改变之处。综上所述，本说明书内容不应理解为对本发明的限制。This article uses specific examples to illustrate the principles and implementation methods of the present invention. The description of the above embodiments is only used to help understand the method and the core idea of the present invention; at the same time, for those of ordinary skill in the art, according to the present invention There will be changes in the specific implementation methods and application scope of the ideas. In summary, the contents of this description should not be construed as limitations of the present invention.

### Claims

Claims (10) 1. A method for detecting a homozygous region of a genome based on low depth sequencing data, the method comprising: sequencing a sample to be tested by using a low-depth whole genome sequencing technology with the sequencing depth of 0.1-1 x to obtain low-depth whole genome sequencing data; the sample to be detected is individual DNA; the low depth whole genome sequencing data comprises a plurality of base sequences; Respectively comparing each base sequence with a human reference genome to obtain the position and comparison quality of each base sequence in the human reference genome, and selecting the base sequence with the comparison quality higher than or equal to the preset quality as a base sequence for detection; dividing the human reference genome into regions according to a preset window width and a preset step length to obtain a plurality of chromosome regions; selecting, for each of the chromosomal regions, a SNP site in the chromosomal region covered with at least one of the base sequences for detection as a target SNP site, based on the positions of all the base sequences for detection, and determining a first number of times the A allele is covered with the base sequence for detection and a second number of times the B allele is covered with the base sequence for detection at each of the target SNP sites; calculating a first edge likelihood value of each target SNP locus belonging to a normal region and a second edge likelihood value of each target SNP locus belonging to a genome homozygous region according to the first times and the second times; calculating a first joint distribution likelihood value based on first edge likelihood values of all the target SNP sites within the chromosome region, and calculating a second joint distribution likelihood value based on second edge likelihood values of all the target SNP sites within the chromosome region; determining whether the chromosomal region is a genomic homozygous region according to the first joint distribution likelihood value and the second joint distribution likelihood value. 2. The method of claim 1, wherein the predetermined quality is that the base sequence and the human reference genome have only one base mismatch. 3. The method of claim 1, wherein each of the chromosomal regions has a width that is the predetermined window width, the predetermined window width being greater than the predetermined step size, and there is an overlap between adjacent chromosomal regions. 4. The method according to claim 1, wherein calculating a first edge likelihood value of each of the target SNP sites belonging to a normal region and a second edge likelihood value of each of the target SNP sites belonging to a genomic homozygous region based on the first and second times comprises: for each target SNP locus, taking the genotype distribution probability of each first genotype corresponding to the first times, the second times and the normal region and the frequency of the allele A as inputs, and calculating a first edge likelihood value of the target SNP locus belonging to the normal region by using an edge likelihood value calculation formula; and calculating a second edge likelihood value of the target SNP locus belonging to the genome homozygous region by using an edge likelihood value calculation formula by taking the first times, the second times and the genotype distribution probability of each second genotype corresponding to the genome homozygous region and the frequency of the allele A as inputs. 5. The method of claim 4, wherein the first genotype corresponding to the normal region comprises AA, AB, and BB; the genotype distribution probability of the first genotype AA is p 2 +p (1-p) F, allele A frequency is 1-e; the genotype distribution probability of the first genotype AB is 2p (1-p) (1-F), and the frequency of the allele A is 1/2; the genotype distribution probability of the first genotype BB is (1-p) 2 +p (1-p) F, allele A frequency is e; wherein p is the population frequency of the A allele in the ethnic group to which the individual belongs; f is the inbreeding coefficient of the individual; e is the sequencing error rate; the second genotype corresponding to the homozygous region of the genome comprises AA and BB; the genotype distribution probability of the second genotype AA is p, and the frequency of the allele A is 1-e; the genotype distribution probability of the second genotype BB is 1-p, and the frequency of allele A is e. 6. The method of claim 4, wherein the edge likelihood value calculation formula is: M(F，e)＝∑ g P(g)B(F A (g)，C i )； wherein M (F, e) is an edge likelihood value; f is the inbreeding coefficient of the individual; e is the sequencing error rate; p (g) is the genotype distribution probability of genotype g; b (F) A (g)，C i ) Likelihood values are binomial distributions; f (F) A (g) The frequency of allele a, genotype g; c (C) i Is a set comprising a first number of times and a second number of times; wherein x is a random variable representing the frequency of allele a; c iA Is the first number of times; c iB A second number of times. 7. The method according to claim 1, wherein said calculating a first joint distribution likelihood value based on first edge likelihood values of all said target SNP sites within said chromosome region and a second joint distribution likelihood value based on second edge likelihood values of all said target SNP sites within said chromosome region specifically comprises: calculating the product of first edge likelihood values of all the target SNP loci in the chromosome region to obtain a first joint distribution likelihood value; and calculating the product of second edge likelihood values of all the target SNP loci in the chromosome region to obtain second joint distribution likelihood values. 8. The method of claim 1, wherein said determining whether the chromosomal region is a genomic homozygous region from the first and second joint distribution likelihood values comprises: calculating a judgment parameter according to the first joint distribution likelihood value and the second joint distribution likelihood value, and if the judgment parameter is larger than a preset threshold value, the chromosome region is a genome homozygous region; The calculation formula of the judging parameter is as follows: wherein T is a judgment parameter; l (L) ROH Likelihood values for a second joint distribution; l (L) Normal Likelihood values for a first joint distribution; or, the calculation formula of the judging parameter is as follows: wherein T is a judgment parameter; θ ROH The prior probability that the chromosomal region is a homozygous region of the genome; θ Normal The prior probability that the chromosome region is a normal region; l (L) ROH Likelihood values for a second joint distribution; l (L) Normal Likelihood values are first joint distributions. 9. The method of claim 3, wherein after determining whether the chromosomal region is a genomic homozygous region, the method further comprises: adjacent chromosomal regions, which are all homozygous regions of the genome, are combined. 10. A system for detecting a homozygous region of a genome based on low depth sequencing data, the system comprising: the sequencing module is used for sequencing the sample to be tested by using a low-depth whole genome sequencing technology with the sequencing depth of 0.1-1 x to obtain low-depth whole genome sequencing data; the sample to be detected is individual DNA; the low depth whole genome sequencing data comprises a plurality of base sequences; the comparison module is used for respectively comparing each base sequence with a human reference genome to obtain the position and comparison quality of each base sequence in the human reference genome, and selecting the base sequence with the comparison quality higher than or equal to the preset quality as a base sequence for detection; The division module is used for dividing the human reference genome into areas according to a preset window width and a preset step length to obtain a plurality of chromosome areas; a detection module for selecting, for each of the chromosomal regions, an SNP site in the chromosomal region covered with at least one of the base sequences for detection as a target SNP site, based on the positions of all the base sequences for detection, and determining a first number of times the A allele is covered with the base sequence for detection and a second number of times the B allele is covered with the base sequence for detection at each of the target SNP sites; calculating a first edge likelihood value of each target SNP locus belonging to a normal region and a second edge likelihood value of each target SNP locus belonging to a genome homozygous region according to the first times and the second times; calculating a first joint distribution likelihood value based on first edge likelihood values of all the target SNP sites within the chromosome region, and calculating a second joint distribution likelihood value based on second edge likelihood values of all the target SNP sites within the chromosome region; determining whether the chromosomal region is a genomic homozygous region according to the first joint distribution likelihood value and the second joint distribution likelihood value.
