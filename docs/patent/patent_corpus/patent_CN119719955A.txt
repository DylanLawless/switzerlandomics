## Patent Reference

- Title: A method, device, computer equipment and storage medium for evidence optimization based on Bayesian model
- URL: https://patents.google.com/patent/CN119719955A/en

### Abstract

Abstract The invention discloses a Bayesian model-based evidence optimization method, a Bayesian model-based evidence optimization device, computer equipment and a storage medium, and relates to the technical field of medical care informatics. The method comprises the steps of obtaining a text file containing a variation classification result, calculating posterior probabilities corresponding to 17 evidence combinations given by an ACMG/AMP guide, obtaining theoretical pathogenicity probabilities corresponding to evidence intensity levels when a selected evidence combination rule meets the posterior probability classification, classifying clinically unknown variation VUS into six levels, determining thresholds corresponding to different evidence intensity levels by comparing positive likelihood ratios or local positive likelihood ratios with the theoretical pathogenicity probabilities corresponding to evidence intensity levels, and re-marking ACMG/AMP evidence labels with variation to give a variation pathogenicity classification result. The invention can reduce the difficulty of evidence optimization and improve the accuracy and consistency of genetic variation interpretation in clinical gene detection.

### Description

Description Evidence optimization method and device based on Bayesian model, computer equipment and storage mediumTechnical Field The invention relates to the technical field of medical care informatics, in particular to a Bayesian model-based evidence optimization method, a Bayesian model-based evidence optimization device, computer equipment and a storage medium. Background Early genetic molecular diagnosis is important for early intervention in patient symptoms and improvement of patient quality of life. For example, mendelian's genetic disease is a genetic disease caused by a mutation in a single gene, which often presents serious health hazards to the patient, and may even lead to congenital defects, disability, or death. In clinical practice, by targeted sequencing, whole exome sequencing or whole genome sequencing, combined with bioinformatic analysis and variant pathogenicity interpretation, can identify genetic molecular etiology for patients. And how to accurately judge the pathogenicity of a large number of unknown variants is one of the main challenges facing clinical genetic diagnosis. To aid in interpreting the clinical significance of the variation, the american society for molecular genetics and genomics (ACMG) and molecular pathology (AMP) issued genetic variation classification standards and guidelines in 2015. The genetic variation classification criteria and guidelines divide variation into five categories, pathogenicity (P), possible pathogenicity (likely pathogenic, LP), benign (benign, B), possible benign (likely benign, LB) and ambiguous (uncertain significance, US) according to eight aspects of crowd frequency, phenotypic co-segregation, functional predictive score, etc., 28 evidence entries (5 evidence intensity classes are involved: independent, very strong, medium and supportive), and 18 evidence combination rules. The ACMG/AMP guide is widely accepted by international peers after being released, and the capability of global clinical gene detection and data interpretation is greatly improved. However, the evidence combination rules of ACMG/AMP guidelines only qualitatively analyze the pathogenicity of the variation based on simple evidence intensity level accumulation rules, lacking a mathematical model that can prove its effectiveness. In 2018, clinGen proposed that the qualitative framework of ACMG/AMP guidelines can be converted into a quantitative framework based on a naive bayes model, and the quantitative framework calculates a posterior probability (posterior probability, post_p) of mutation pathogenicity according to a priori probability of mutation pathogenicity and a corresponding probability of evidence intensity level, thereby realizing mutation classification. Specifically, when post_P >0.99,0.90< post_P.ltoreq. 0.99,0.001.ltoreq.post_P <0.10, post_P <0.001 and 0.10.ltoreq.post_P.ltoreq.0.90, the pathogenicity classifications corresponding to the variants are P, LP, LB, B and US, respectively. Based on the quantitative framework, CLINGEN SVI shows that 16 of 18 evidence combination rules proposed by ACMG/AMP genetic variation classification standards and guidelines are matched with classification results calculated by a Bayesian model, and the reasonability of the ACMG/AMP guideline evidence combination rules is proved. In 2020, clinGen further converts the bayesian framework into a scoring framework, and the different evidence intensity levels correspond to different scores, so that the mutation can be classified by summing the scores. These quantitative models provide a mathematical basis for further quantifying evidence intensity levels and extending the combining rules. Researchers quantify and expand the intensity levels of multiple evidence items, such as PS1/PM5, PS3/BS3, and PP3/BP4, according to a Bayesian framework, improving the recognition rate of pathogenic variation, proving that the normalization and stratification of evidence is critical for establishing objective, unbiased, and consistent classification of variation. However, the lack of software and tools dedicated to quantifying evidence intensity and establishing appropriate thresholds to perfect ACMG/AMP guidelines currently results in poor accuracy and poor consistency of interpretation of genetic variations in clinical gene testing. Disclosure of Invention Aiming at the defects in the prior art, the invention provides a Bayesian model-based evidence optimization method, a Bayesian model-based evidence optimization device, a Bayesian model-based evidence optimization computer device and a Bayesian model-based evidence storage medium, which aim to reduce evidence optimization difficulty and improve the accuracy and consistency of genetic variation interpretation in clinical gene detection by enlarging the evidence intensity level of an ACMG/AMP guide. In a first aspect, the present invention provides a bayesian model-based evidence optimization method, including the following steps: S10, acquiring a text file containing a mutation classification result, wherein the mutation classification result comprises mutation, ACMG/AMP evidence and mutation pathogenicity classification information; s20, calculating posterior probability post_P corresponding to 17 evidence combinations given by an ACMG/AMP guide under given Prior probability Prior_P according to preset cycle times when the pathogenicity probabilities among the evidence intensity levels have an exponential relationship, and obtaining a minimum pathogenicity probability value corresponding to each evidence intensity level when a selected evidence combination rule meets the posterior probability post_P classification, wherein the minimum pathogenicity probability value is used as a theoretical pathogenicity probability corresponding to each evidence intensity level; S30, classifying the clinically-insignificant variation VUS into a first level hot, a second level wall, a third level tepid, a fourth level cool, a fifth level cold and a sixth level ice cold, taking the clinically-significant variation VUS classified into the first level hot, the second level wall and the third level tepid as clinically-significant variation PL-VUS prone to cause diseases, taking the clinically-significant variation VUS classified into the fourth level cool, the fifth level cold and the sixth level ice cold as clinically-significant variation BL-VUS prone to be benign, and filtering the clinically-significant variation PL-VUS prone to cause diseases when evidence is optimized; S40, calculating a positive likelihood ratio LR + for the classified variables, calculating a local positive likelihood ratio lr+ for the continuous variables, and determining thresholds corresponding to different evidence intensity levels by comparing the positive likelihood ratio LR + or the local positive likelihood ratio LR + with theoretical pathogenicity probabilities corresponding to the evidence intensity levels; S50, re-marking ACMG/AMP evidence labels according to the optimized evidence intensity corresponding grade and the corresponding threshold, and respectively giving out the pathogenicity classification results of the mutation according to the evidence combination rules, the Bayesian framework and the score system given by the ACMG/AMP guideline. Further, in the step S20, the posterior probability post_P classification is specifically that the posterior probability post_P of the pathogenic combination satisfies that the posterior probability post_P >0.99, the posterior probability post_P of the possible pathogenic combination satisfies that the posterior probability post_P of the possible pathogenic combination is less than or equal to 0.90< 0.99, the posterior probability post_P of the possible benign combination satisfies that the posterior probability post_P of the possible benign combination is less than or equal to 0.001 and less than or equal to 0.10, and the posterior probability post_P of the benign combination satisfies that the posterior probability post_P of the benign combination is less than 0.001; the calculation formula of the theoretical pathogenicity probability corresponding to each evidence intensity level is as follows: ; The method comprises the steps of OP: odds Path, pathogenicity probability obtained after ACMG/AMP evidence combination, O PVSt: very Strong (Very Strong) pathogenicity probability corresponding to the pathogenicity evidence intensity level, N PVSt: evidence number with Very Strong pathogenicity evidence intensity level (Very Strong), N PSt: evidence number with Strong pathogenicity evidence intensity level (Strong), N PM: evidence number with medium pathogenicity evidence intensity level (Moderate), N PSu: evidence number with Strong evidence intensity level (Supporting), N BSt: evidence number with Strong benign evidence intensity level (Supporting), and N BSu: evidence number with benign evidence intensity level (Supporting); The calculation formula of the posterior probability post_p is: ; Wherein, post_P is the mutation pathogenicity posterior probability, and Prior_P is the mutation pathogenicity Prior probability. Further, in step S40, for the classification variables, various statistical indexes including true positive, false positive, true negative, accuracy, true positive rate, true negative rate, positive predictive value, negative predictive value, F1 score, and positive likelihood ratio LR + are calculated by calculating the number of P/LP and BL-VUS/B/LB variations that satisfy or do not satisfy the test conditions, a 95% confidence interval estimation value of the positive likelihood ratio LR + is obtained by a bootstrapping algorithm, and then the evidence intensity level and threshold are determined by comparing the 95% confidence interval lower limit value of the positive likelihood ratio LR + with the theoretical pathogenicity probability corresponding to each evidence intensity level obtained in step S20. Further, the calculation formula of the positive likelihood ratio LR + is: ; TP is True positive, and the number of P/LP variation meeting the test conditions; FP, false positive, number of BL-VUS/B/LB variations meeting the test conditions, TN, true negative, number of BL-VUS/B/LB variations not meeting the test conditions, FN, number of P/LP variations not meeting the test conditions; The calculation formula of the local positive likelihood ratio lr + is as follows: ; Wherein, p is probability, s is test value, v is variation; representing the density of benign mutation scores at a certain test value; the density of the pathogenic mutation score distribution at a certain test value is shown. Further, in step S40, for the continuous variable, all the observations are ranked, centering on each observation, and for a given sliding window, the pathogenicity local posterior probability Local posterior probability of each test value in the interval is calculated, and the 95% confidence interval of the local posterior probability of each test value is iteratively estimated by a preset number of times, so as to evaluate the corresponding threshold of the evidence intensity level. Further, the calculation formula of the pathogenicity local posterior probability Local posterior probability is: ; Wherein Local posterior probability is the local posterior probability, # P/LP VARIANTS IN INTERVAL is the number of P/LP variations in a given sliding window, # non-pathogenic VARIANTS IN INTERVAL is the number of BL-VUS/B/LB variations in a given sliding window, and Weight is the probability of occurrence of BL-VUS/B/LB variations in the dataset. Further, the test value of the classified variable is a classified variable, and the test value of the continuous variable is a continuous variable. In a second aspect, the present invention provides an evidence optimizing apparatus based on a bayesian model, including: The acquisition module is used for acquiring a text file containing a mutation classification result, wherein the mutation classification result comprises mutation, ACMG/AMP evidence and mutation pathogenicity classification information; The computing and selecting module is used for computing posterior probability post_P corresponding to 17 evidence combinations given by the ACMG/AMP guide under given Prior probability Prior_P according to preset cycle times when the pathogenicity probabilities among the evidence intensity levels have an exponential relationship, and obtaining minimum pathogenicity probability values corresponding to the evidence intensity levels when the selected evidence combination rules meet the posterior probability post_P classification, wherein the minimum pathogenicity probability values are used as theoretical pathogenicity probabilities corresponding to the evidence intensity levels; The fine classification module is used for classifying the clinically-insignificant variation VUS into a first level hot, a second level wall, a third level tepid, a fourth level cool, a fifth level cold and a sixth level ice cold, taking the clinically-significant variation VUS classified into the first level hot, the second level wall and the third level tepid as clinically-significant variation PL-VUS prone to cause diseases, taking the clinically-significant variation VUS classified into the fourth level cool, the fifth level cold and the sixth level ice cold as clinically-significant variation BL-VUS prone to cause diseases, and filtering the clinically-significant variation PL-VUS prone to cause diseases when evidence is optimized; The threshold determining module is used for calculating a positive likelihood ratio LR + for the classified variables, calculating a local positive likelihood ratio LR + for the continuous variables, and determining thresholds corresponding to different evidence intensity levels by comparing the positive likelihood ratio LR + or the local positive likelihood ratio LR + with theoretical pathogenicity probabilities corresponding to the evidence intensity levels; And the result output module is used for re-marking the ACMG/AMP evidence label according to the optimized evidence intensity corresponding grade and the corresponding threshold value, and respectively giving out the pathogenicity classification result of the mutation according to the evidence combination rule, the Bayesian framework and the score system given by the ACMG/AMP guide. In a third aspect, the present invention provides a computer device comprising a memory and a processor, the memory storing a computer program which, when executed by the processor, causes the processor to perform the steps of the method described above. In a fourth aspect, the present invention provides a storage medium having a computer program stored thereon, which when executed by a processor causes the processor to perform the steps of the above method. The beneficial effects of the invention are as follows: According to the invention, a text file containing a variation classification result is firstly obtained, posterior probabilities corresponding to 17 evidence combinations given by an ACMG/AMP guide under a given prior probability are calculated, and when a selected evidence combination rule meets the posterior probability post_P classification, theoretical pathogenicity probability corresponding to each evidence intensity level is obtained. For the classification variables, a positive likelihood ratio LR + is calculated, and for the continuous variables, a local positive likelihood ratio LR + is calculated. The thresholds corresponding to the different evidence intensity levels are determined by comparing the positive likelihood ratio LR + or the local positive likelihood ratio LR + with the theoretical pathogenicity probabilities corresponding to the evidence intensity levels, so that the flexibility and convenience of quantifying the ACMG/AMP evidence intensity levels and establishing the corresponding thresholds are improved, and the transition from subjective assessment to quantitative and objective assessment can be promoted. And reclassifying the pathogenicity of the mutation according to the evidence combination rule, the Bayesian framework and the score system which are given by the ACMG/AMP guide, and reclassifying the pathogenicity of the mutation based on the evidence optimization result, wherein the classification is not only limited to the ACMG/AMP combination rule, but also can be carried out according to the Bayesian framework calculation posterior probability. Drawings FIG. 1 is a schematic flow chart of an evidence optimization method based on a Bayesian model provided by an embodiment of the invention; FIG. 2 is a graph of correspondence between variant pathogenicity classifications, posterior probabilities, and evidence combinations provided by embodiments of the present invention; fig. 3 is a functional block diagram of an evidence optimizing apparatus based on a bayesian model according to an embodiment of the present invention. Icon: The system comprises an acquisition module 100, a calculation selection module 200, a fine classification module 300; A threshold value determining module 400, and a result outputting module 500. In order to make the objects, technical solutions and advantages of the embodiments of the present invention more clear, the technical solutions of the embodiments of the present invention will be clearly and completely described below with reference to the accompanying drawings in the embodiments of the present invention. It should be understood that the specific embodiments described herein are for purposes of illustration only and are not intended to limit the scope of the invention. Examples As shown in fig. 1, the evidence optimization method based on the bayesian model provided by the embodiment of the invention may include the following steps S10 to S40: and S10, acquiring a text file containing the mutation classification result. Wherein the mutation classification result at least comprises mutation, ACMG/AMP evidence and mutation pathogenicity classification information. And the variability, ACMG/AMP evidence and variability pathogenicity classification information are partitioned by adopting a tab. And S20, calculating posterior probability post_P corresponding to 17 evidence combinations given by an ACMG/AMP guide according to a preset cycle number under a given Prior probability Prior_P when the pathogenicity probability among the evidence intensity levels has an exponential relation, and obtaining a minimum pathogenicity probability value corresponding to each evidence intensity level when the selected evidence combination rule meets the posterior probability post_P classification, wherein the minimum pathogenicity probability value is used as a theoretical pathogenicity probability corresponding to each evidence intensity level. In this example, it is first assumed that there is an exponential relationship in the probability of pathogenicity between evidence intensity classes. In implementation, the preset cycle number is preferably 10000, and in the preset cycle number, the posterior probability post_p corresponding to 17 evidence combinations provided by the ACMG/AMP guide is calculated under the given Prior probability Prior_p. When the selected evidence combination rule meets the post_P classification of the posterior probability, obtaining a minimum pathogenicity probability value corresponding to each evidence intensity level, and taking the minimum pathogenicity probability value as the theoretical pathogenicity probability corresponding to each evidence intensity level. In one embodiment, the posterior probability post_P classification is specifically classified into the case that the posterior probability post_P of a pathogenic combination satisfies 0.99, the posterior probability post_P of a possible pathogenic combination satisfies 0.90< 0.99, the posterior probability post_P of a possible benign combination satisfies 0.001 <0.10, and the posterior probability post_P of a benign combination satisfies 0.001. Further, the calculation formula of the theoretical pathogenicity probability corresponding to each evidence intensity level is as follows: ; the method comprises the steps of OP: odds Path, pathogenicity probability obtained after ACMG/AMP evidence combination, O PVSt: pathogenicity probability corresponding to a Very Strong (Very Strong) pathogenicity evidence intensity level, N PVSt: evidence number with the Very Strong (Very Strong) pathogenicity evidence intensity level, N PSt: evidence number with the Strong (Strong) pathogenicity evidence intensity level, N PM: evidence number with the medium (Moderate) pathogenicity evidence intensity level, N PSu: evidence number with the support (support) evidence intensity level, N BSt: evidence number with the Strong (support) evidence intensity level, and N BSu: evidence number with the support (support) evidence intensity level. Further, the calculation formula of the posterior probability post_p is: ; Wherein, post_P is the mutation pathogenicity posterior probability, and Prior_P is the mutation pathogenicity Prior probability. In this embodiment, the correspondence between the variant pathogenicity classification, the posterior probability post_p and the evidence combination is shown in fig. 2, and the evidence combination is 17 combination modes. In FIG. 2, O PVSt is the probability of pathogenicity for the Strong (Very Strong) pathogenic evidence intensity level, O PSt is the probability of pathogenicity for the Strong (Strong) pathogenic evidence intensity level, O PM is the probability of pathogenicity for the medium (Moderate) pathogenic evidence intensity level, O PSu is the probability of pathogenicity for the Supporting (Supporting) pathogenic evidence intensity level, O BSt is the probability of pathogenicity for the Strong (Strong) benign evidence intensity level, and O BSu is the probability of pathogenicity for the Supporting (Supporting) benign evidence intensity level. The variant pathogenicity classes include P (pathogenicity), LP (likely pathogenic, possibly pathogenic), B (benign ), LB (likely benign, possibly benign) and US (uncertain significance, unknown). And step S30, classifying the clinically-insignificant variation VUS into a first level hot, a second level wall, a third level tepid, a fourth level cool, a fifth level cold and a sixth level ice cold, taking the clinically-significant variation VUS classified into the first level hot, the second level wall and the third level tepid as clinically-significant variation PL-VUS prone to cause diseases, taking the clinically-significant variation VUS classified into the fourth level cool, the fifth level cold and the sixth level ice cold as clinically-significant variation BL-VUS prone to cause diseases, and filtering the clinically-significant variation PL-VUS prone to cause diseases when evidence is optimized. Step S40, for the classified variables, positive likelihood ratio LR + is calculated, for the continuous variables, local positive likelihood ratio LR + is calculated, and thresholds corresponding to different evidence intensity levels are determined by comparing positive likelihood ratio LR + or local positive likelihood ratio LR + with theoretical pathogenicity probabilities corresponding to the evidence intensity levels. In one embodiment, for the classification variables, various statistical indicators for each test value, including true positive, false positive, true negative, accuracy, true positive rate, true negative rate, positive predictive value, negative predictive value, F1 score, and positive likelihood ratio LR +, are calculated by calculating the number of P/LP and BL-VUS/B/LB variations that meet or do not meet the test conditions, a 95% confidence interval estimate for positive likelihood ratio LR + is obtained by a bootstrapping algorithm, and then evidence intensity levels and thresholds are determined by comparing the theoretical pathogenicity probabilities for the 95% confidence interval lower limit for positive likelihood ratio LR + to the respective evidence intensity levels obtained in step S20. It should be noted that the Bootstrapping procedure is formally described as a method of selecting a specific guided training classification model for a given natural language processing task, then requiring two datasets, typically a small number of labeled datasets L and labeled datasets U, and finally expanding the labeled datasets step by step through the unlabeled datasets U, thereby training a final classifier to achieve the specific natural language processing task. Bootstrap is a process of iterative iteration that can utilize fewer annotation corpora to obtain a greater amount of annotation corpora with higher confidence. The Bootstrapping method is realized through two main processes, namely firstly providing a heuristic rule or other classification method which can effectively classify a small amount of corpus and secondly evaluating a new labeling corpus generated by a classifier. The annotation corpus with higher confidence is obtained through evaluation, so that a larger annotation data set can be obtained through iteration. The iteration termination condition is that a threshold value for the number of iterations is given, or that the number of new annotation data is generated too little, or the like. The classification variable refers to a classification variable, for example, whether the mutation is marked with a evidence tag (such as PM2, PS1, etc.), for example, whether the mutation is significantly enriched in the population (PS 4 evidence, corresponding to a test value of OR >5 and p < 0.05). For the classification variables, a four-grid table is obtained, and then the positive likelihood ratio LR + values are calculated. Further, the calculation formula of the positive likelihood ratio LR + is: ; TP: true positive, number of P/LP variations above the test value, FP: false positive, number of BL-VUS/B/LB variations above the test value, TN: true negative, number of BL-VUS/B/LB variations below the test value, FN: false negative, number of P/LP variations above the test value. The calculation formula of the local positive likelihood ratio lr + is as follows: ; Wherein, p is probability, s is test value, v is variation; representing the density of benign mutation scores at a certain test value; the density of the pathogenic mutation score distribution at a certain test value is shown. In one embodiment, for a continuous variable, all observations are ordered, centered on each observation, and for a given sliding window, the pathogenicity local posterior probability Local posterior probability for each test value within the interval is calculated, and the 95% confidence interval for each test value local posterior probability is iteratively estimated by a preset number of times to evaluate the evidence intensity level correspondence threshold. The continuous variable refers to a continuous variable, for example, PM2/BS1 evidence corresponds to a threshold value of frequency of variation in a crowd, PP3/BP4 corresponds to a threshold value of pathogenicity score of variation predicted by software, and when determining the thresholds corresponding to different evidence intensity levels of the evidence, each frequency value or score value is tested, and the values are continuous and range. In practice, the preset number of times is set by the user, preferably 100 times, 1000 times and 5000 times. Further, the calculation formula of the pathogenicity local posterior probability Local posterior probability is: ; Wherein Local posterior probability is the local posterior probability, # P/LP VARIANTS IN INTERVAL is the number of P/LP variations in a given sliding window, # non-pathogenic VARIANTS IN INTERVAL is the number of BL-VUS/B/LB variations in a given sliding window, and Weight is the probability of occurrence of BL-VUS/B/LB variations in the dataset. The embodiment can promote the transition from subjective assessment to quantitative and objective assessment by determining the threshold corresponding to the evidence intensity level, thereby improving the flexibility and convenience of quantifying the ACMG/AMP evidence intensity level and establishing the corresponding threshold. And S50, re-marking ACMG/AMP evidence labels according to the optimized evidence intensity corresponding grade and the corresponding threshold, and respectively giving out the pathogenicity classification results of the mutation according to the evidence combination rule, the Bayesian framework and the score system given by the ACMG/AMP guideline. According to the method, the accuracy and the consistency of variation interpretation in clinical gene detection are hopefully further improved by expanding the evidence intensity level of ACMG/AMP guidelines, and classification of clinically unknown variation is improved, for example, the method can provide powerful support for early intervention and personalized treatment of Mendelian genetic diseases. Example 2 As shown in fig. 3, the embodiment of the present invention further provides a bayesian model-based evidence optimizing apparatus, which may include an acquisition module 100, a calculation selection module 200, a fine classification module 300, a threshold determination module 400, and a result output module 500. The obtaining module 100 is configured to obtain a text file containing a mutation classification result, where the mutation classification result includes mutation, ACMG/AMP evidence, and mutation pathogenicity classification information. The calculation selection module 200 is configured to calculate, according to a preset cycle number, a posterior probability post_p corresponding to 17 evidence combinations given by the ACMG/AMP guideline under a given Prior probability primary_p when the pathogenicity probabilities among the evidence intensity levels have an exponential relationship, and obtain a minimum pathogenicity probability value corresponding to each evidence intensity level when the selected evidence combination rule satisfies the posterior probability post_p classification, and use the minimum pathogenicity probability value as a theoretical pathogenicity probability corresponding to each evidence intensity level. The fine classification module 300 is configured to classify the clinically-insignificant variation VUS into a first level hot, a second level wall, a third level tepid, a fourth level cool, a fifth level cold and a sixth level ice cold, take the clinically-significant variation VUS classified into the first level hot, the second level wall and the third level tepid as clinically-significant variation PL-VUS prone to cause diseases, take the clinically-significant variation VUS classified into the fourth level cool, the fifth level cold and the sixth level ice cold as clinically-significant variation BL-VUS prone to cause diseases, and filter the clinically-significant variation PL-VUS prone to cause diseases when the evidence is optimized. The threshold determining module 400 is configured to calculate a positive likelihood ratio LR + for the classified variables, calculate a local positive likelihood ratio LR + for the continuous variables, and determine thresholds corresponding to different evidence intensity levels by comparing the positive likelihood ratio LR + or the local positive likelihood ratio LR + with theoretical pathogenicity probabilities corresponding to the evidence intensity levels. The result output module 500 is configured to re-label the ACMG/AMP evidence label according to the optimized evidence intensity correspondence level and the correspondence threshold, and respectively provide the pathogenicity classification result of the mutation according to the evidence combination rule, the bayesian framework and the score system provided by the ACMG/AMP guideline. In detail, each module in the evidence optimizing device based on the bayesian model provided in the embodiment of the present invention adopts the same technical means as the evidence optimizing method based on the bayesian model provided in the above embodiment 1 when in use, and can generate the same technical effects, which are not described herein. Example 3 The embodiment of the invention also provides computer equipment, which comprises a memory and a processor. The memory has stored therein a computer program which, when executed by a processor, causes the processor to perform the steps of the method described in embodiment 1. The processor may be formed by an integrated circuit in some embodiments, for example, a single packaged integrated circuit, or may be formed by a plurality of integrated circuits packaged with the same function or different functions, including one or more central processing units (Central Processing unit, CPU), microprocessors, digital processing chips, graphics processors, and combinations of various control chips. The processor is a Control Unit (Control Unit) of the electronic device, connects various components of the entire electronic device using various interfaces and lines, and executes various functions and processes data by running or executing programs or modules (e.g., bayesian model-based evidence optimization programs, etc.) stored in the memory, and calling data stored in the memory. The memory may in some embodiments be an internal storage unit of the electronic device, such as a mobile hard disk of the electronic device. The memory may also be an external storage device of the electronic device in other embodiments, such as a plug-in mobile hard disk, a smart memory card (SMART MEDIA CARD, SMC), a Secure Digital (SD) card, a flash memory card (FLASH CARD), etc. that are provided on the electronic device. Further, the memory may also include both internal storage units and external storage devices of the electronic device. The memory can be used for storing application software installed in the electronic equipment and various data, such as codes of evidence optimizing programs based on a Bayesian model, and the like, and can be used for temporarily storing data which are output or are to be output. Example 4 The present invention also provides a storage medium having stored thereon a computer program which, when executed by a processor, causes the processor to perform the steps of the method described in embodiment 1. The storage medium is a readable storage medium, and may include flash memory, a mobile hard disk, a multimedia card, a card memory (e.g., SD or DX memory), a magnetic memory, a magnetic disk, an optical disk, and so on. In summary, the embodiment of the invention firstly obtains the text file containing the variation classification result, calculates the posterior probability corresponding to 17 evidence combinations given by the ACMG/AMP guide under the given prior probability, and obtains the theoretical pathogenicity probability corresponding to each evidence intensity level when the selected evidence combination rule satisfies the posterior probability post_P classification. For the classification variables, a positive likelihood ratio LR + is calculated, and for the continuous variables, a local positive likelihood ratio LR + is calculated. The thresholds corresponding to the different evidence intensity levels are determined by comparing the positive likelihood ratio LR + or the local positive likelihood ratio LR + with the theoretical pathogenicity probabilities corresponding to the evidence intensity levels, so that the flexibility and convenience of quantifying the ACMG/AMP evidence intensity levels and establishing the corresponding thresholds are improved, and the transition from subjective assessment to quantitative and objective assessment can be promoted. And reclassifying the pathogenicity of the mutation according to the evidence combination rule, the Bayesian framework and the score system which are given by the ACMG/AMP guide, and reclassifying the pathogenicity of the mutation based on the evidence optimization result, wherein the classification is not only limited to the ACMG/AMP combination rule, but also can be carried out according to the Bayesian framework calculation posterior probability. In the embodiments provided in the present invention, it should be understood that the disclosed apparatus, device and method may be implemented in other manners. For example, the above-described apparatus embodiments are merely illustrative, and for example, the division of the modules is merely a logical function division, and there may be other manners of division when actually implemented. The modules described as separate components may or may not be physically separate, and components shown as modules may or may not be physical units, may be located in one place, or may be distributed over multiple network units. Some or all of the modules may be selected according to actual needs to achieve the purpose of the solution of this embodiment. In addition, each functional module in the embodiments of the present invention may be integrated in one processing unit, or each unit may exist alone physically, or two or more units may be integrated in one unit. The integrated units can be realized in a form of hardware or a form of hardware and a form of software functional modules. It should be noted that the above embodiments are merely for illustrating the technical solution of the present invention and not for limiting the same, and although the present invention has been described in detail with reference to the above embodiments, it should be understood by those skilled in the art that the technical solution described in the above embodiments may be modified or some or all of the technical features may be equivalently replaced, and these modifications or substitutions do not make the essence of the corresponding technical solution deviate from the scope of the technical solution of the embodiments of the present invention.

### Claims

Claims (10) Translated from Chinese 1.一种基于贝叶斯模型的证据优化方法，其特征在于，包括以下步骤：1. A method for evidence optimization based on a Bayesian model, characterized by comprising the following steps: S10：获取含有变异分类结果的文本文件，所述变异分类结果包括变异、ACMG/AMP 证据和变异致病性分类信息；S10: Obtain a text file containing variant classification results, wherein the variant classification results include variants, ACMG/AMP evidence, and variant pathogenicity classification information; S20：在各证据强度等级间致病性几率存在指数关系时，按照预设循环次数计算在给定先验概率Prior_P下，ACMG/AMP指南给定的17个证据组合对应的后验概率Post_P，当选取的证据组合规则满足后验概率Post_P分类时，得到各证据强度等级对应的最小致病性几率值，将所述最小致病性几率值作为各证据强度等级对应的理论致病性几率；S20: When there is an exponential relationship between the pathogenicity probabilities of each evidence strength level, the posterior probability Post_P corresponding to the 17 evidence combinations given in the ACMG/AMP guidelines under a given prior probability Prior_P is calculated according to the preset number of cycles. When the selected evidence combination rule satisfies the posterior probability Post_P classification, the minimum pathogenicity probability value corresponding to each evidence strength level is obtained, and the minimum pathogenicity probability value is used as the theoretical pathogenicity probability corresponding to each evidence strength level; S30：将临床意义不明变异VUS细分类为第一级别hot、第二级别warm、第三级别tepid、第四级别cool、第五级别cold和第六级别ice cold，将分类为第一级别hot、第二级别warm和第三级别tepid的临床意义不明变异VUS作为倾向致病的临床意义不明变异PL-VUS，将分类为第四级别cool、第五级别cold和第六级别ice cold的临床意义不明变异VUS作为倾向良性的临床意义不明变异BL-VUS，在证据优化时，过滤倾向致病的临床意义不明变异PL-VUS；S30: VUS of unknown clinical significance is subclassified into first-level hot, second-level warm, third-level tepid, fourth-level cool, fifth-level cold and sixth-level ice cold. VUS of unknown clinical significance classified as first-level hot, second-level warm and third-level tepid are considered as PL-VUS of unknown clinical significance with a tendency to cause disease. VUS of unknown clinical significance classified as fourth-level cool, fifth-level cold and sixth-level ice cold are considered as BL-VUS of unknown clinical significance with a tendency to cause benign disease. When optimizing evidence, PL-VUS of unknown clinical significance with a tendency to cause disease are filtered out. S40：对于分类变量，计算阳性似然比LR+；对于连续变量，计算局部阳性似然比lr+，通过比较阳性似然比LR+或局部阳性似然比lr+和各证据强度等级对应的理论致病性几率，确定不同证据强度等级对应的阈值；S40: For categorical variables, the positive likelihood ratio LR + was calculated; for continuous variables, the local positive likelihood ratio lr + was calculated. By comparing the positive likelihood ratio LR + or the local positive likelihood ratio lr + with the theoretical pathogenicity probability corresponding to each level of evidence strength, the threshold corresponding to different levels of evidence strength was determined; S50：根据优化后的证据强度对应等级及对应阈值，重新对变异标记ACMG/AMP证据标签，根据ACMG/AMP指南给出的证据组合规则、贝叶斯框架和分数系统分别给出变异的致病性分类结果。S50: According to the optimized evidence strength corresponding level and corresponding threshold, the ACMG/AMP evidence label is re-labeled for the variant, and the pathogenicity classification results of the variant are given according to the evidence combination rules, Bayesian framework and scoring system given in the ACMG/AMP guidelines. 2.根据权利要求1所述的基于贝叶斯模型的证据优化方法，其特征在于，在步骤S20中，所述后验概率Post_P分类具体为：致病组合的后验概率Post_P满足：后验概率Post_P >0.99；可能致病组合的后验概率Post_P满足：0.90 < 后验概率Post_P ≤ 0.99；可能良性组合的后验概率Post_P满足：0.001 ≤ 后验概率Post_P < 0.10；良性组合的后验概率Post_P满足：后验概率Post_P < 0.001；2. According to the Bayesian model-based evidence optimization method of claim 1, it is characterized in that, in step S20, the posterior probability Post_P classification is specifically as follows: the posterior probability Post_P of the pathogenic combination satisfies: posterior probability Post_P>0.99; the posterior probability Post_P of the possible pathogenic combination satisfies: 0.90 < posterior probability Post_P ≤ 0.99; the posterior probability Post_P of the possible benign combination satisfies: 0.001 ≤ posterior probability Post_P < 0.10; the posterior probability Post_P of the benign combination satisfies: posterior probability Post_P < 0.001; 所述各证据强度等级对应的理论致病性几率的计算公式为：The calculation formula for the theoretical pathogenicity probability corresponding to each level of evidence strength is: ； ; 其中，OP：Odds Path，ACMG/AMP证据组合后得到的致病性几率；OPVSt：非常强（VeryStrong）致病性证据强度等级对应的致病性几率；NPVSt：致病性证据强度等级为非常强（Very Strong）的证据个数；NPSt：致病性证据强度等级为强（Strong）的证据个数；NPM：致病性证据强度等级为中等（Moderate）的证据个数；NPSu：致病性证据强度等级为支持（Supporting）的证据个数；NBSt：良性证据强度等级为强（Strong）的证据个数；NBSu：良性证据强度等级为支持（Supporting）的证据个数；Among them, OP: Odds Path, the pathogenicity probability obtained by combining ACMG/AMP evidence; O PVSt : The pathogenicity probability corresponding to the Very Strong pathogenicity evidence strength level; N PVSt : The number of evidence with a pathogenicity evidence strength level of Very Strong; N PSt : The number of evidence with a pathogenicity evidence strength level of Strong; N PM : The number of evidence with a pathogenicity evidence strength level of Moderate; N PSu : The number of evidence with a pathogenicity evidence strength level of Supporting; N BSt : The number of evidence with a benign evidence strength level of Strong; N BSu : The number of evidence with a benign evidence strength level of Supporting; 后验概率Post_P的计算公式为：The calculation formula of the posterior probability Post_P is: ； ; 其中，Post_P：变异致病性后验概率；Prior_P：变异致病性先验概率。Among them, Post_P: posterior probability of variant pathogenicity; Prior_P: prior probability of variant pathogenicity. 3.根据权利要求1所述的基于贝叶斯模型的证据优化方法，其特征在于，在步骤S40中，对于分类变量，通过计算满足或不满足测试条件的P/LP和 BL-VUS/B/LB 变异的数目来计算每个测试条件的各种统计指标，包括真阳性、假阳性、真阴性、准确性、真阳性率、真阴性率、阳性预测值、阴性预测值、F1 评分和阳性似然比LR+，通过bootstrapping算法获得阳性似然比LR+的95%置信区间估计值，然后通过比较阳性似然比LR+的95%置信区间下限值与步骤S20中得到的各证据强度等级对应的理论致病性几率来确定证据强度等级和阈值。3. The evidence optimization method based on the Bayesian model according to claim 1 is characterized in that, in step S40, for categorical variables, various statistical indicators for each test condition, including true positive, false positive, true negative, accuracy, true positive rate, true negative rate, positive predictive value, negative predictive value, F1 score and positive likelihood ratio LR+, are calculated by calculating the number of P/LP and BL-VUS/B/LB variations that meet or do not meet the test conditions, and the 95% confidence interval estimate of the positive likelihood ratio LR + is obtained by the bootstrapping algorithm, and then the evidence strength level and threshold are determined by comparing the 95% confidence interval lower limit of the positive likelihood ratio LR + with the theoretical pathogenicity probability corresponding to each evidence strength level obtained in step S20. 4.根据权利要求3所述的基于贝叶斯模型的证据优化方法，其特征在于，所述阳性似然比LR+的计算公式为：4. The Bayesian model-based evidence optimization method according to claim 3, characterized in that the calculation formula of the positive likelihood ratio LR + is: ； ; 其中，TP：True positive，真阳性，满足测试条件的 P/LP 变异的数量；FP：Falsepositive，假阳性，满足测试条件的BL-VUS/B/LB 变异的数量；TN：真阴性，不满足测试条件的 BL-VUS/B/LB 变异的数量；FN：假阴性，不满足测试条件的 P/LP 变异的数量；Among them, TP: True positive, the number of P/LP variants that meet the test conditions; FP: False positive, the number of BL-VUS/B/LB variants that meet the test conditions; TN: True negative, the number of BL-VUS/B/LB variants that do not meet the test conditions; FN: False negative, the number of P/LP variants that do not meet the test conditions; 所述局部阳性似然比lr+的计算公式为：The calculation formula of the local positive likelihood ratio lr + is: ； ; 其中，p：概率；s：测试值；v：变异；：表示某一测试值下良性变异分数的密度；：表示某一测试值下致病变异分数分布的密度。Among them, p: probability; s: test value; v: variation; : represents the density of the benign variation score under a certain test value; : represents the density of the distribution of pathogenic variant scores under a certain test value. 5.根据权利要求1所述的基于贝叶斯模型的证据优化方法，其特征在于，在步骤S40中，对于连续变量，对所有观测值进行排序，以每个观测值为中心，对于给定的滑动窗口，计算区间内每个测试值的致病性局部后验概率Local posterior probability，通过预设次数迭代估计每个测试值局部后验概率的95%置信区间，以评估证据强度等级对应阈值。5. The method for optimizing the evidence based on the Bayesian model according to claim 1 is characterized in that, in step S40, for continuous variables, all observations are sorted, and each observation is taken as the center. For a given sliding window, the local posterior probability of pathogenicity of each test value in the interval is calculated, and the 95% confidence interval of the local posterior probability of each test value is estimated by a preset number of iterations to evaluate the threshold corresponding to the evidence strength level. 6.根据权利要求5所述的基于贝叶斯模型的证据优化方法，其特征在于，所述致病性局部后验概率Local posterior probability的计算公式为：6. The Bayesian model-based evidence optimization method according to claim 5, characterized in that the calculation formula of the pathogenicity local posterior probability Local posterior probability is: ； ; 其中，Local posterior probability：局部后验概率；#P/LP variants in interval：给定滑动窗口内P/LP变异的数目；#non-pathogenic variants in interval：给定滑动窗口内BL-VUS/B/LB变异的数目；Weight：数据集中BL-VUS/B/LB变异出现的概率。Among them, Local posterior probability: local posterior probability; #P/LP variants in interval: the number of P/LP variants in a given sliding window; #non-pathogenic variants in interval: the number of BL-VUS/B/LB variants in a given sliding window; Weight: the probability of BL-VUS/B/LB variants occurring in the dataset. 7.根据权利要求1所述基于贝叶斯模型的证据优化方法，其特征在于，所述分类变量的测试值是一个二分类变量；所述连续变量的测试值是一个连续变量。7. The method for optimizing evidence based on a Bayesian model according to claim 1, wherein the test value of the categorical variable is a binary variable; and the test value of the continuous variable is a continuous variable. 8.一种基于贝叶斯模型的证据优化装置，其特征在于，包括：8. An evidence optimization device based on a Bayesian model, characterized by comprising: 获取模块，用于获取含有变异分类结果的文本文件，所述变异分类结果包括变异、ACMG/AMP 证据和变异致病性分类信息；An acquisition module, used to acquire a text file containing variant classification results, wherein the variant classification results include variants, ACMG/AMP evidence, and variant pathogenicity classification information; 计算选取模块，用于在各证据强度等级间致病性几率存在指数关系时，按照预设循环次数计算在给定先验概率Prior_P下，ACMG/AMP指南给定的17个证据组合对应的后验概率Post_P，当选取的证据组合规则满足后验概率Post_P分类时，得到各证据强度等级对应的最小致病性几率值，将所述最小致病性几率值作为各证据强度等级对应的理论致病性几率；A calculation and selection module is used to calculate the posterior probability Post_P corresponding to the 17 evidence combinations given in the ACMG/AMP guidelines under a given prior probability Prior_P according to a preset number of cycles when there is an exponential relationship between the pathogenicity probabilities of each evidence strength level. When the selected evidence combination rule satisfies the posterior probability Post_P classification, the minimum pathogenicity probability value corresponding to each evidence strength level is obtained, and the minimum pathogenicity probability value is used as the theoretical pathogenicity probability corresponding to each evidence strength level; 细分类模块，用于将临床意义不明变异VUS细分类为第一级别hot、第二级别warm、第三级别tepid、第四级别cool、第五级别cold和第六级别ice cold，将分类为第一级别hot、第二级别warm和第三级别tepid的临床意义不明变异VUS作为倾向致病的临床意义不明变异PL-VUS，将分类为第四级别cool、第五级别cold和第六级别ice cold的临床意义不明变异VUS作为倾向良性的临床意义不明变异BL-VUS，在证据优化时，过滤倾向致病的临床意义不明变异PL-VUS；A subclassification module is used to subclassify clinically unknown variants VUS into first-level hot, second-level warm, third-level tepid, fourth-level cool, fifth-level cold, and sixth-level ice cold, and to classify clinically unknown variants VUS classified as first-level hot, second-level warm, and third-level tepid as clinically unknown variants PL-VUS with a tendency to cause disease, and to classify clinically unknown variants VUS classified as fourth-level cool, fifth-level cold, and sixth-level ice cold as clinically unknown variants BL-VUS with a tendency to benign. When optimizing evidence, clinically unknown variants PL-VUS with a tendency to cause disease are filtered out; 阈值确定模块，用于对于分类变量，计算阳性似然比LR+；对于连续变量，计算局部阳性似然比lr+，通过比较阳性似然比LR+或局部阳性似然比lr+和各证据强度等级对应的理论致病性几率，确定不同证据强度等级对应的阈值；A threshold determination module is used to calculate the positive likelihood ratio LR + for categorical variables; and the local positive likelihood ratio lr + for continuous variables, and to determine the thresholds corresponding to different evidence strength levels by comparing the positive likelihood ratio LR + or the local positive likelihood ratio lr + with the theoretical pathogenicity probability corresponding to each evidence strength level; 结果输出模块，用于根据优化后的证据强度对应等级及对应阈值，重新对变异标记ACMG/AMP证据标签，根据ACMG/AMP指南给出的证据组合规则、贝叶斯框架和分数系统分别给出变异的致病性分类结果。The result output module is used to re-label the variants with ACMG/AMP evidence labels according to the optimized evidence strength corresponding levels and corresponding thresholds, and to give the pathogenicity classification results of the variants according to the evidence combination rules, Bayesian framework and score system given in the ACMG/AMP guidelines. 9.一种计算机设备，其特征在于，包括存储器和处理器，所述存储器中存储有计算机程序，所述计算机程序被处理器执行时，使得所述处理器执行权利要求1-7中任一项权利要求所述方法的步骤。9. A computer device, comprising a memory and a processor, wherein a computer program is stored in the memory, and when the computer program is executed by the processor, the processor executes the steps of the method according to any one of claims 1 to 7. 10.一种存储介质，其特征在于，所述存储介质上存储有计算机程序，所述计算机程序被处理器执行时，使得所述处理器执行权利要求1-7中任一项权利要求所述方法的步骤。10. A storage medium, characterized in that a computer program is stored on the storage medium, and when the computer program is executed by a processor, the processor executes the steps of the method according to any one of claims 1 to 7.
