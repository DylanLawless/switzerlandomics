## Patent Reference

- Title: Improved variant calling procedure using single cell analysis
- URL: https://patents.google.com/patent/CN114766056A/en

### Abstract

Abstract Translated from Chinese 本文描述包括两步过程的改良的变体调用方法，所述两步过程涉及1)通过细胞特异性过程对序列读段中的碱基进行误差校正，和2)使用所述误差校正的序列读段在细胞群体中进行变体调用。通常，第一步误差校正涉及应用第一机器学习模型来鉴别并校正序列读段的碱基。第二步变体调用涉及应用第二机器学习模型来分类碱基。此类改良的变体调用方法可用于鉴别参与生物过程，例如患病生物过程的变体。 Described herein is an improved variant calling method comprising a two-step process involving 1) error correction of bases in sequence reads by a cell-specific process, and 2) use of the error-corrected sequence reads Segments make variant calls in cell populations. Typically, the first step of error correction involves applying a first machine learning model to identify and correct the bases of the sequence reads. The second step variant calling involves applying a second machine learning model to classify bases. Such improved variant calling methods can be used to identify variants involved in biological processes, eg, diseased biological processes.

### Description

Description Translated from Chinese 使用单细胞分析的改良的变体调用程序Improved variant calling program using single-cell analysis 交叉引用cross reference 本申请要求于2019年10月2日提交的美国临时专利申请第62/909,670号的权益和优先权，所述美国临时专利申请的全部公开内容出于所有目的以引用方式在此并入。This application claims the benefit of and priority to US Provisional Patent Application No. 62/909,670, filed October 2, 2019, the entire disclosure of which is incorporated herein by reference for all purposes. 背景技术Background technique 测序技术通常会生成具有介于0.5％-2％范围内的误差的序列读段，所述误差源自PCR和测序误差。旨在调用细胞群体中的变体的变体调用程序通常因这些误差而鉴别出假阳性，这对变体调用程序的准确性造成负面影响。减少假阳性的常规策略通常采用硬截止(hard cutoff)；然而，实施这些硬截止会消除大量真阳性，所述问题通常称为丢失数据问题。因此，需要可更好地鉴别假阳性而不牺牲真阳性的改良的变体调用程序。Sequencing techniques typically generate sequence reads with errors in the range of 0.5%-2% due to PCR and sequencing errors. Variant callers that aim to call variants in a population of cells often identify false positives due to these errors, which negatively affects the accuracy of the variant caller. Conventional strategies to reduce false positives typically employ hard cutoffs; however, implementing these hard cutoffs eliminates a large number of true positives, a problem commonly referred to as the missing data problem. Therefore, there is a need for an improved variant calling program that can better identify false positives without sacrificing true positives. 发明内容SUMMARY OF THE INVENTION 本文描述通过两步过程改良变体调用的实施方案，所述两步过程涉及1)通过细胞特异性过程对序列读段中的碱基进行误差校正，和2)使用误差校正的序列读段在细胞群体中进行变体调用。碱基中的误差通常源自PCR误差、测序误差、测序比对误差或校正误差中的任一个。在此处，两步过程使得能够鉴别并校正错误碱基，由此使得能够进行更准确的变体调用。在多个实施方案中，碱基的误差校正涉及实施用于校正错误碱基的第一经训练机器学习模型，下文称为误差校正模型。因此，误差校正模型使得能够校正来自单个细胞的序列读段。通过细胞特异性方式进行碱基的误差校正与校正源自批量测序的序列读段相比是有利的。例如，序列读段中的碱基误差可源自单细胞，且因此可针对单细胞一起校正这些碱基误差。在多个实施方案中，细胞群体中的变体调用涉及实施第二经训练机器学习模型，下文称为变体调用程序模型。变体调用程序模型分析校正的序列读段以调用更可能为存在于细胞群体中的真变体的变体。总之，涉及实施误差校正模型和变体调用程序模型的两步过程实现调用真变体的更高的准确性。此可用于鉴别可能与疾病(例如癌症)有关的真变体。Described herein are embodiments of improved variant calling through a two-step process involving 1) error correction of bases in sequence reads through a cell-specific process, and 2) use of error-corrected sequence reads in Variant calling in cell populations. Errors in bases typically result from any of PCR errors, sequencing errors, sequencing alignment errors, or calibration errors. Here, a two-step process enables identification and correction of erroneous bases, thereby enabling more accurate variant calling. In various embodiments, error correction of bases involves implementing a first trained machine learning model for correcting erroneous bases, hereinafter referred to as an error correction model. Thus, the error correction model enables the correction of sequence reads from individual cells. Error correction of bases in a cell-specific manner is advantageous compared to correction of sequence reads derived from batch sequencing. For example, base errors in a sequence read can originate from a single cell, and thus these base errors can be corrected together for a single cell. In various embodiments, variant calling in a cell population involves implementing a second trained machine learning model, hereinafter referred to as a variant calling program model. The variant calling program model analyzes corrected sequence reads to call variants that are more likely to be true variants present in the cell population. In summary, a two-step process involving implementing an error correction model and a variant caller model achieves higher accuracy in calling true variants. This can be used to identify true variants that may be associated with diseases such as cancer. 本文公开用于调用细胞群体的一种或多种变体的方法，所述方法包括：从细胞群体的细胞获得多个序列读段；对于细胞群体中的多个细胞，校正从细胞获得的序列读段，所述校正包括：鉴别序列读段的不同于参考碱基的所关注碱基；应用误差校正模型来分析所关注碱基的单细胞特征，所述误差校正模型经训练以预测所关注碱基的概率；和校正源自细胞的序列读段的所关注碱基；通过聚集细胞群体的细胞的校正的序列读段来生成细胞群体特征，校正的序列读段包含校正的碱基；和将变体调用程序模型应用于源自聚集的序列读段的细胞群体特征以鉴别细胞群体中的一种或多种变体。Disclosed herein are methods for calling one or more variants of a population of cells, the methods comprising: obtaining a plurality of sequence reads from cells of the population of cells; for the plurality of cells in the population of cells, correcting the sequences obtained from the cells reads, the correction comprising: identifying bases of interest of the sequence reads that differ from reference bases; applying an error correction model to analyze single-cell characteristics of the bases of interest, the error correction model trained to predict the bases of interest and correcting the bases of interest of the cell-derived sequence reads; generating a cell population signature by aggregating corrected sequence reads of cells of the cell population, the corrected sequence reads comprising the corrected bases; and A variant calling program model is applied to cell population characteristics derived from aggregated sequence reads to identify one or more variants in the cell population. 在多个实施方案中，单细胞特征包括所关注碱基周围的上下文序列、所关注碱基的测序深度、所关注碱基的等位基因频率和所关注碱基周围的窗口中的碱基的等位基因频率。在多个实施方案中，鉴别序列读段的所关注碱基包括将包含参考碱基与错配碱基之间的转换的可能性的转换矩阵应用于在错配碱基的序列读段中观察到一定比例的核苷酸碱基的概率。在多个实施方案中，鉴别序列读段的所关注碱基还包括：确定在错配碱基的序列读段中观察到一定比例的核苷酸碱基的概率；和比较确定的概率与来自转换矩阵的转换的可能性。在多个实施方案中，响应于确定的概率大于转换的可能性，从而将错配碱基鉴别为所关注碱基。在多个实施方案中，转换矩阵是使用训练数据生成，所述训练数据包含源自一个或多个细胞样品群体的序列读段。在多个实施方案中，转换矩阵是使用来自细胞群体的细胞的多个序列读段生成。在多个实施方案中，当校正细胞群体的一个或多个细胞的序列读段时，转换矩阵中的转换可能性被动态更新。In various embodiments, the single-cell characteristics include the context sequence surrounding the base of interest, the sequencing depth of the base of interest, the allele frequency of the base of interest, and the number of bases in the window surrounding the base of interest. Allele frequency. In various embodiments, identifying the bases of interest of the sequence reads comprises applying a transition matrix comprising the likelihood of transitions between the reference base and the mismatched bases to observations in the sequence reads of the mismatched bases probability to a certain percentage of nucleotide bases. In various embodiments, identifying the bases of interest of the sequence reads further comprises: determining the probability that a certain proportion of nucleotide bases are observed in the sequence reads of the mismatched bases; and comparing the determined probability to the probability derived from The transformation possibilities of the transformation matrix. In various embodiments, the mismatched base is identified as the base of interest in response to the determined probability being greater than the probability of the transition. In various embodiments, the transformation matrix is generated using training data comprising sequence reads derived from one or more populations of cell samples. In various embodiments, the transition matrix is generated using multiple sequence reads from cells of the cell population. In various embodiments, the transition likelihoods in the transition matrix are dynamically updated when correcting sequence reads for one or more cells of the cell population. 在多个实施方案中，误差校正模型是神经网络。在多个实施方案中，误差校正模型是深度学习神经网络，所述深度学习神经网络包括一个或多个层，所述一个或多个层学习所关注碱基周围的基序和局部序列上下文。在多个实施方案中，校正源自细胞结果的多个序列读段的一个或多个序列读段包括校正至少25％的不同于参考碱基的所关注碱基。In various embodiments, the error correction model is a neural network. In various embodiments, the error correction model is a deep learning neural network comprising one or more layers that learn motifs and local sequence context around bases of interest. In various embodiments, correcting one or more sequence reads of the plurality of sequence reads derived from the cellular result comprises correcting at least 25% of the bases of interest that are different from the reference base. 在多个实施方案中，细胞群体特征包括以下中的一者或多者：杂合子调用百分比、杂合子调用的中值变体等位基因频率(VAF)、杂合子调用的中值基因型质量、杂合子调用的中值读段深度、纯合子调用百分比、纯合子调用的中值VAF、纯合子调用的中值基因型质量、纯合子调用的中值读段深度、参考调用百分比、用于纯合子调用的读段深度的变异系数(CV)、用于杂合子调用的读段深度的CV、纯合子调用的基因型质量的CV、杂合子调用的基因型质量的CV、用于纯合子调用的VAF的CV、用于杂合子调用的VAF的CV、用于纯合子调用的平均VAF与中值VAF之间的差、用于杂合子调用的平均VAF与中值VAF之间的差和扩增子GC百分比。In various embodiments, cell population characteristics include one or more of the following: percent heterozygous calls, median variant allele frequency (VAF) for heterozygous calls, median genotype quality for heterozygous calls , Median Read Depth for Heterozygous Calls, Percent Homozygous Calls, Median VAF for Homozygous Calls, Median Genotype Quality for Homozygous Calls, Median Read Depth for Homozygous Calls, Percent Reference Calls, for Coefficient of variation (CV) for read depth for homozygous calls, CV for read depth for heterozygous calls, CV for genotype quality for homozygous calls, CV for genotype quality for heterozygous calls, CV for homozygous calls Sum Amplicon GC percentage. 在多个实施方案中，变体调用程序模型预测所关注杂合变体或所关注纯合变体中的至少一个。在多个实施方案中，变体调用程序模型还预测不确定的变体。在多个实施方案中，变体调用程序模型是使用训练数据来训练，所述训练数据包含源自一种或多种细胞系的序列读段和存在于一种或多种细胞系中的已知杂合或纯合变体的指示。在多个实施方案中，与常规GTAK变体调用程序相比，误差校正模型和变体调用程序模型的应用在0.5％的检测限值(LOD)下实现真变体阳性预测值的至少两倍增加。在多个实施方案中，误差校正模型和变体调用程序模型的应用在0.5％的检测限值(LOD)下实现至少0.6的真变体阳性预测值。在多个实施方案中，源自细胞的多个序列读段是通过单细胞工作流分析来确定。在多个实施方案中，参考碱基是根据参考基因组序列来确定。在多个实施方案中，参考碱基是根据从对照细胞获得的一个或多个序列读段来确定。In various embodiments, the variant caller model predicts at least one of a heterozygous variant of interest or a homozygous variant of interest. In various embodiments, the variant caller model also predicts indeterminate variants. In various embodiments, the variant caller model is trained using training data comprising sequence reads derived from one or more cell lines and existing in one or more cell lines Heterozygous or homozygous variants are known. In various embodiments, application of error correction models and variant caller models achieves at least twice the positive predictive value of true variants at a limit of detection (LOD) of 0.5% compared to conventional GTAK variant callers Increase. In various embodiments, application of the error correction model and variant caller model achieves a true variant positive predictive value of at least 0.6 at a limit of detection (LOD) of 0.5%. In various embodiments, the plurality of sequence reads derived from a cell are determined by single cell workflow analysis. In various embodiments, reference bases are determined from a reference genome sequence. In various embodiments, reference bases are determined from one or more sequence reads obtained from control cells. 另外，本文公开用于调用细胞群体的一种或多种变体的非暂时性计算机可读介质，所述非暂时性计算机可读介质包括如下指令，所述指令在由处理器执行时使得处理器：从细胞群体的细胞获得多个序列读段；对于细胞群体中的多个细胞，校正从细胞获得的序列读段，所述校正包括：鉴别序列读段的不同于参考碱基的所关注碱基；应用误差校正模型来分析所关注碱基的单细胞特征，所述误差校正模型经训练以预测所关注碱基的概率；和校正源自细胞的序列读段的所关注碱基；通过聚集细胞群体的细胞的校正的序列读段来生成细胞群体特征，校正的序列读段包含校正的碱基；和将变体调用程序模型应用于源自聚集的序列读段的细胞群体特征以鉴别细胞群体中的一种或多种变体。In addition, disclosed herein is a non-transitory computer-readable medium for invoking one or more variants of a population of cells, the non-transitory computer-readable medium comprising instructions that, when executed by a processor, cause processing device: obtains a plurality of sequence reads from cells of a cell population; for a plurality of cells in the cell population, corrects the sequence reads obtained from the cells, the correction comprising: identifying sequence reads of interest that differ from the reference base bases; analyze single-cell characteristics of bases of interest using an error correction model trained to predict probabilities of bases of interest; and correct bases of interest for cell-derived sequence reads; by aggregating corrected sequence reads of cells of the cell population to generate a cell population signature, the corrected sequence reads comprising corrected bases; and applying a variant caller model to the cell population signature derived from the aggregated sequence reads to identify One or more variants in a population of cells. 在多个实施方案中，单细胞特征包括所关注碱基周围的上下文序列、所关注碱基的测序深度、所关注碱基的等位基因频率和所关注碱基周围的窗口中的碱基的等位基因频率。在多个实施方案中，使得处理器鉴别序列读段的所关注碱基的指令还包括在由处理器执行时使得处理器应用转换矩阵的指令，所述转换矩阵包含参考碱基与错配碱基之间的转换的可能性。In various embodiments, the single-cell characteristics include the context sequence surrounding the base of interest, the sequencing depth of the base of interest, the allele frequency of the base of interest, and the number of bases in the window surrounding the base of interest. Allele frequency. In various embodiments, the instructions that cause the processor to identify the bases of interest of the sequence reads further comprise instructions that, when executed by the processor, cause the processor to apply a transformation matrix, the transformation matrix comprising reference bases and mismatch bases Possibility of conversion between bases. 在多个实施方案中，使得处理器鉴别序列读段的所关注碱基的指令还包括如下指令，所述指令在由处理器执行时使得处理器：确定在错配碱基的序列读段中观察到一定比例的核苷酸碱基的概率；和比较确定的概率与来自转换矩阵的转换的可能性。在多个实施方案中，响应于确定的概率大于转换的可能性，将错配碱基鉴别为所关注碱基。在多个实施方案中，转换矩阵是使用训练数据生成，所述训练数据包含源自一个或多个细胞样品群体的序列读段。在多个实施方案中，转换矩阵是使用来自细胞群体的细胞的多个序列读段生成。在多个实施方案中，当校正细胞群体的一个或多个细胞的序列读段时，转换矩阵中的转换可能性被动态更新。In various embodiments, the instructions that cause the processor to identify the bases of interest of the sequence reads further comprise instructions that, when executed by the processor, cause the processor to: determine that in the sequence reads of mismatched bases the probability of observing a certain proportion of nucleotide bases; and comparing the determined probability to the probability of the transition from the transition matrix. In various embodiments, the mismatched base is identified as the base of interest in response to the determined probability being greater than the probability of the transition. In various embodiments, the transformation matrix is generated using training data comprising sequence reads derived from one or more populations of cell samples. In various embodiments, the transition matrix is generated using multiple sequence reads from cells of the cell population. In various embodiments, the transition likelihoods in the transition matrix are dynamically updated when correcting sequence reads for one or more cells of the cell population. 在多个实施方案中，误差校正模型是神经网络。在多个实施方案中，误差校正模型是深度学习神经网络，所述深度学习神经网络包括一个或多个层，所述一个或多个层学习所关注碱基周围的基序和局部序列上下文。在多个实施方案中，校正源自细胞结果的多个序列读段的一个或多个序列读段包括校正至少25％的不同于参考碱基的所关注碱基。在多个实施方案中，细胞群体特征包括以下中的一者或多者：杂合子调用百分比、杂合子调用的中值变体等位基因频率(VAF)、杂合子调用的中值基因型质量、杂合子调用的中值读段深度、纯合子调用百分比、纯合子调用的中值VAF、纯合子调用的中值基因型质量、纯合子调用的中值读段深度、参考调用百分比、用于纯合子调用的读段深度的变异系数(CV)、用于杂合子调用的读段深度的CV、纯合子调用的基因型质量的CV、杂合子调用的基因型质量的CV、用于纯合子调用的VAF的CV、用于杂合子调用的VAF的CV、用于纯合子调用的平均VAF与中值VAF之间的差、用于杂合子调用的平均VAF与中值VAF之间的差和扩增子GC百分比。In various embodiments, the error correction model is a neural network. In various embodiments, the error correction model is a deep learning neural network comprising one or more layers that learn motifs and local sequence context around bases of interest. In various embodiments, correcting one or more sequence reads of the plurality of sequence reads derived from the cellular result comprises correcting at least 25% of the bases of interest that are different from the reference base. In various embodiments, cell population characteristics include one or more of the following: percent heterozygous calls, median variant allele frequency (VAF) for heterozygous calls, median genotype quality for heterozygous calls , Median Read Depth for Heterozygous Calls, Percent Homozygous Calls, Median VAF for Homozygous Calls, Median Genotype Quality for Homozygous Calls, Median Read Depth for Homozygous Calls, Percent Reference Calls, for Coefficient of variation (CV) for read depth for homozygous calls, CV for read depth for heterozygous calls, CV for genotype quality for homozygous calls, CV for genotype quality for heterozygous calls, CV for homozygous calls Sum Amplicon GC percentage. 在多个实施方案中，变体调用程序模型预测所关注杂合变体或所关注纯合变体中的至少一个。在多个实施方案中，变体调用程序模型还预测不确定的变体。在多个实施方案中，变体调用程序模型是使用训练数据来训练，所述训练数据包含源自一种或多种细胞系的序列读段和存在于一种或多种细胞系中的已知杂合或纯合变体的指示。在多个实施方案中，与常规GTAK变体调用程序相比，误差校正模型和变体调用程序模型的应用在0.5％的检测限值(LOD)下实现真变体阳性预测值的至少两倍增加。在多个实施方案中，误差校正模型和变体调用程序模型的应用在0.5％的检测限值(LOD)下实现至少0.6的真变体阳性预测值。在多个实施方案中，源自细胞的多个序列读段是通过单细胞工作流分析来确定。在多个实施方案中，参考碱基是根据参考基因组序列来确定。在多个实施方案中，参考碱基是根据从对照细胞获得的一个或多个序列读段来确定。In various embodiments, the variant caller model predicts at least one of a heterozygous variant of interest or a homozygous variant of interest. In various embodiments, the variant caller model also predicts indeterminate variants. In various embodiments, the variant caller model is trained using training data comprising sequence reads derived from one or more cell lines and existing in one or more cell lines Heterozygous or homozygous variants are known. In various embodiments, application of error correction models and variant caller models achieves at least twice the positive predictive value of true variants at a limit of detection (LOD) of 0.5% compared to conventional GTAK variant callers Increase. In various embodiments, application of the error correction model and variant caller model achieves a true variant positive predictive value of at least 0.6 at a limit of detection (LOD) of 0.5%. In various embodiments, the plurality of sequence reads derived from a cell are determined by single cell workflow analysis. In various embodiments, reference bases are determined from a reference genome sequence. In various embodiments, reference bases are determined from one or more sequence reads obtained from control cells. 另外，本文公开系统，所述系统包括：单细胞分析工作流装置，所述单细胞分析工作流装置经配置以生成细胞群体中的细胞的多个序列读段；计算装置，所述计算装置通信耦接到单细胞分析工作流装置，计算装置经配置以：从细胞群体的细胞获得多个序列读段；对于细胞群体中的多个细胞，校正从细胞获得的序列读段，所述校正包括：鉴别序列读段的不同于参考碱基的所关注碱基；应用误差校正模型来分析所关注碱基的单细胞特征，所述误差校正模型经训练以预测所关注碱基的概率；和校正源自细胞的序列读段的所关注碱基；通过聚集细胞群体的细胞的校正的序列读段来生成细胞群体特征，校正的序列读段包含校正的碱基；和将变体调用程序模型应用于源自聚集的序列读段的细胞群体特征以鉴别细胞群体中的一种或多种变体。在多个实施方案中，单细胞特征包括所关注碱基周围的上下文序列、所关注碱基的测序深度、所关注碱基的等位基因频率和所关注碱基周围的窗口中的碱基的等位基因频率。Additionally, disclosed herein are systems comprising: a single-cell analysis workflow device configured to generate a plurality of sequence reads of cells in a cell population; a computing device in communication Coupled to the single-cell analysis workflow device, the computing device is configured to: obtain a plurality of sequence reads from cells of the cell population; for the plurality of cells in the cell population, correct the sequence reads obtained from the cells, the correction comprising : identify a base of interest of a sequence read that differs from a reference base; apply an error correction model to analyze single-cell characteristics of the base of interest, the error correction model trained to predict the probability of the base of interest; and correct bases of interest from cell-derived sequence reads; generating cell population characteristics by aggregating corrected sequence reads of cells of the cell population, the corrected sequence reads containing the corrected bases; and applying the variant caller model Characterization of cell populations derived from aggregated sequence reads to identify one or more variants in the cell population. In various embodiments, the single-cell characteristics include the context sequence surrounding the base of interest, the sequencing depth of the base of interest, the allele frequency of the base of interest, and the number of bases in the window surrounding the base of interest. Allele frequency. 在多个实施方案中，鉴别序列读段的所关注碱基包括：将包含参考碱基与错配碱基之间的转换的可能性的转换矩阵应用于在错配碱基的序列读段中观察到一定比例的核苷酸碱基的概率。在多个实施方案中，鉴别序列读段的所关注碱基包括：确定在错配碱基的序列读段中观察到一定比例的核苷酸碱基的概率；和比较确定的概率与来自转换矩阵的转换的可能性。在多个实施方案中，响应于确定的概率大于转换的可能性，将错配碱基鉴别为所关注碱基。在多个实施方案中，转换矩阵是使用训练数据生成，所述训练数据包含源自一个或多个细胞样品群体的序列读段。在多个实施方案中，转换矩阵是使用来自细胞群体的细胞的多个序列读段生成。在多个实施方案中，当校正细胞群体的一个或多个细胞的序列读段时，转换矩阵中的转换可能性被动态更新。In various embodiments, identifying the bases of interest of the sequence reads comprises: applying a transition matrix comprising the likelihood of transitions between the reference base and the mismatched bases in the sequence reads of the mismatched bases The probability of observing a certain proportion of nucleotide bases. In various embodiments, identifying the bases of interest of the sequence reads comprises: determining the probability that a certain proportion of nucleotide bases are observed in the sequence reads of the mismatched bases; and comparing the determined probability to the probability from the transition Possibilities for the transformation of the matrix. In various embodiments, the mismatched base is identified as the base of interest in response to the determined probability being greater than the probability of the transition. In various embodiments, the transformation matrix is generated using training data comprising sequence reads derived from one or more populations of cell samples. In various embodiments, the transition matrix is generated using multiple sequence reads from cells of the cell population. In various embodiments, the transition likelihoods in the transition matrix are dynamically updated when correcting sequence reads for one or more cells of the cell population. 在多个实施方案中，误差校正模型是神经网络。在多个实施方案中，误差校正模型是深度学习神经网络，所述深度学习神经网络包括一个或多个层，所述一个或多个层学习所关注碱基周围的基序和局部序列上下文。在多个实施方案中，校正源自细胞结果的多个序列读段的一个或多个序列读段包括校正至少25％的不同于参考碱基的所关注碱基。In various embodiments, the error correction model is a neural network. In various embodiments, the error correction model is a deep learning neural network comprising one or more layers that learn motifs and local sequence context around bases of interest. In various embodiments, correcting one or more sequence reads of the plurality of sequence reads derived from the cellular result comprises correcting at least 25% of the bases of interest that are different from the reference base. 在多个实施方案中，细胞群体特征包括以下中的一者或多者：杂合子调用百分比、杂合子调用的中值变体等位基因频率(VAF)、杂合子调用的中值基因型质量、杂合子调用的中值读段深度、纯合子调用百分比、纯合子调用的中值VAF、纯合子调用的中值基因型质量、纯合子调用的中值读段深度、参考调用百分比、用于纯合子调用的读段深度的变异系数(CV)、用于杂合子调用的读段深度的CV、纯合子调用的基因型质量的CV、杂合子调用的基因型质量的CV、用于纯合子调用的VAF的CV、用于杂合子调用的VAF的CV、用于纯合子调用的平均VAF与中值VAF之间的差、用于杂合子调用的平均VAF与中值VAF之间的差和扩增子GC百分比。In various embodiments, cell population characteristics include one or more of the following: percent heterozygous calls, median variant allele frequency (VAF) for heterozygous calls, median genotype quality for heterozygous calls , Median Read Depth for Heterozygous Calls, Percent Homozygous Calls, Median VAF for Homozygous Calls, Median Genotype Quality for Homozygous Calls, Median Read Depth for Homozygous Calls, Percent Reference Calls, for Coefficient of variation (CV) for read depth for homozygous calls, CV for read depth for heterozygous calls, CV for genotype quality for homozygous calls, CV for genotype quality for heterozygous calls, CV for homozygous calls Sum Amplicon GC percentage. 在多个实施方案中，变体调用程序模型预测所关注杂合变体或所关注纯合变体中的至少一个。在多个实施方案中，变体调用程序模型还预测不确定的变体。在多个实施方案中，变体调用程序模型是使用训练数据来训练，所述训练数据包含源自一种或多种细胞系的序列读段和存在于一种或多种细胞系中的已知杂合或纯合变体的指示。In various embodiments, the variant caller model predicts at least one of a heterozygous variant of interest or a homozygous variant of interest. In various embodiments, the variant caller model also predicts indeterminate variants. In various embodiments, the variant caller model is trained using training data comprising sequence reads derived from one or more cell lines and existing in one or more cell lines Heterozygous or homozygous variants are known. 在多个实施方案中，与常规GTAK变体调用程序相比，误差校正模型和变体调用程序模型的应用在0.5％的检测限值(LOD)下实现真变体阳性预测值的至少两倍增加。在多个实施方案中，误差校正模型和变体调用程序模型的应用在0.5％的检测限值(LOD)下实现至少0.6的真变体阳性预测值。在多个实施方案中，参考碱基是根据参考基因组序列来确定。在多个实施方案中，参考碱基是根据从对照细胞获得的一个或多个序列读段来确定。In various embodiments, application of error correction models and variant caller models achieves at least twice the positive predictive value of true variants at a limit of detection (LOD) of 0.5% compared to conventional GTAK variant callers Increase. In various embodiments, application of the error correction model and variant caller model achieves a true variant positive predictive value of at least 0.6 at a limit of detection (LOD) of 0.5%. In various embodiments, reference bases are determined from a reference genome sequence. In various embodiments, reference bases are determined from one or more sequence reads obtained from control cells. 附图中几个视图的简述Brief Description of Several Views in the Drawings 参考以下描述和附图将更好地理解本发明的这些和其他特征、方面和优点，其中：These and other features, aspects and advantages of the present invention will be better understood with reference to the following description and accompanying drawings, wherein: 图(FIG.)1描绘根据实施方案的整体系统环境，所述整体系统环境包括细胞分析工作流装置和用于鉴别变体调用的碱基调用程序装置。Figure (FIG.) 1 depicts an overall system environment including a cellular analysis workflow device and a basecaller device for identifying variant calls, according to an embodiment. 图2是根据实施方案的碱基调用程序装置的单独模块的方块图。2 is a block diagram of the individual modules of a basecaller apparatus, according to an embodiment. 图3A是根据实施方案用于校正源自单细胞的序列读段的流程图。3A is a flow diagram for correcting sequence reads derived from single cells, according to an embodiment. 图3B描绘根据实施方案使用校正的序列读段来调用细胞群体的变体的流程图。3B depicts a flow diagram for calling variants of a cell population using corrected sequence reads, according to an embodiment. 图4A描绘根据实施方案的误差校正模型的实施。4A depicts the implementation of an error correction model according to an embodiment. 图4B描绘根据实施方案的变体调用程序模型的实施。4B depicts an implementation of a variant invoker model according to an embodiment. 图5描绘用于实施参考图1-4描述的系统和方法的示例性计算装置。5 depicts an exemplary computing device for implementing the systems and methods described with reference to FIGS. 1-4. 图6描绘碱基误差的示例性分布，其中大部分碱基误差仅在一种细胞中观察到。Figure 6 depicts an exemplary distribution of base errors, where the majority of base errors are observed in only one type of cell. 图7是转换矩阵的示例性描绘。7 is an exemplary depiction of a transformation matrix. 图8A和图8B是不同位置的6个序列读段的堆积的示例性描绘。8A and 8B are exemplary depictions of the stacking of 6 sequence reads at different positions. 图9A描绘误差校正模型的示例性输入和输出。9A depicts exemplary inputs and outputs of an error correction model. 图9B描绘使用由误差校正模型预测的概率校正所关注碱基的实例。Figure 9B depicts an example of bases of interest corrected using the probability predicted by the error correction model. 图10展示校正四个不同细胞群体中的20％-35％碱基作为实施误差校正模型的结果。Figure 10 shows the results of correcting 20%-35% of bases in four different cell populations as a result of implementing an error correction model. 图11展示在实施误差校正模型和变体调用程序模型后真变体的改良的阳性预测值。Figure 11 shows the improved positive predictive value for true variants after implementing the error correction model and variant caller model. 具体实施方式Detailed ways 定义definition 除非另有规定，否则如下文所阐述的对权利要求书和说明书中使用的术语进行定义。Unless otherwise specified, terms used in the claims and specification are defined as set forth below. 短语“错配碱基”和“替代碱基”可互换使用且是指某一位置的碱基，所述碱基不同于同一位置的已知参考碱基。在一些情况下，错配碱基被错误地鉴别(例如在测序期间被错误地鉴别)。碱基的错误鉴别可源自多个来源，例如PCR误差、测序误差、测序比对误差和/或校正误差。为提供实例，参考位置的已知碱基可为腺嘌呤(A)。错配碱基或替代碱基是指同一位置的除腺嘌呤(A)外的碱基(例如，碱基是鸟嘌呤(G)、胞嘧啶(C)或胸腺嘧啶(T)中的任一个)。The phrases 'mismatched base' and 'alternative base' are used interchangeably and refer to a base at a position that differs from a known reference base at the same position. In some cases, mismatched bases are incorrectly identified (eg, during sequencing). Misidentification of bases can arise from a number of sources, such as PCR errors, sequencing errors, sequencing alignment errors, and/or calibration errors. To provide an example, the known base at the reference position may be adenine (A). A mismatched base or a substituted base refers to a base other than adenine (A) at the same position (eg, the base is any of guanine (G), cytosine (C), or thymine (T) ). 短语“参考碱基”是指具有已知核苷酸碱基的已知碱基。在一个实施方案中，参考碱基是根据参考基因组序列来确定。在一个实施方案中，参考碱基是根据从对照细胞获得的一个或多个序列读段来确定。The phrase 'reference base' refers to a known base with a known nucleotide base. In one embodiment, the reference base is determined from a reference genome sequence. In one embodiment, reference bases are determined from one or more sequence reads obtained from control cells. 短语“误差校正模型”是指预测模型或机器学习模型，它经实施以分析所关注碱基，使得所关注碱基可被校正。通常，误差校正模型经实施来以细胞特异性方式分析所关注碱基。在一个实施方案中，误差校正模型分析针对所关注碱基生成的堆积，所述堆积量化源自单细胞的序列读段的碱基。在此类实施方案中，来自包括所关注碱基的单细胞的序列读段可一起校正。The phrase 'error correction model' refers to a predictive model or machine learning model that is implemented to analyze bases of interest so that the bases of interest can be corrected. Typically, error correction models are implemented to analyze bases of interest in a cell-specific manner. In one embodiment, the error correction model analyzes the stacking generated for the bases of interest that quantifies the bases of sequence reads derived from single cells. In such embodiments, sequence reads from single cells that include the base of interest can be corrected together. 短语“所关注碱基”是指与参考碱基相比发生错配的源自细胞的序列读段中的碱基。在多个实施方案中，通过应用转换矩阵，所关注碱基可能是错误碱基。通常，通过误差校正模型分析针对所关注碱基生成的堆积以确定所关注碱基是否可能是错误碱基。The phrase 'base of interest' refers to a base in a cell-derived sequence read that is mismatched compared to a reference base. In various embodiments, by applying a transformation matrix, the base of interest may be an erroneous base. Typically, the stacking generated for the base of interest is analyzed by an error correction model to determine whether the base of interest is likely to be an erroneous base. 短语“单细胞特征”是指与单细胞的序列读段中的所关注碱基相关的特征。在多个实施方案中，通过误差校正模型分析单细胞特征以确定对应于四种核苷酸碱基(腺嘌呤、鸟嘌呤、胞嘧啶和胸腺嘧啶)的概率分布，所述概率分布代表所关注碱基为四种核苷酸碱基中的一者的可能性。单细胞特征的实例包括所关注碱基周围的上下文序列、所关注碱基的测序深度、所关注碱基的等位基因频率和所关注碱基周围的窗口中的碱基的等位基因频率。The phrase 'single cell feature' refers to a feature associated with a base of interest in a sequence read of a single cell. In various embodiments, single-cell signatures are analyzed by an error-corrected model to determine probability distributions corresponding to the four nucleotide bases (adenine, guanine, cytosine, and thymine) representing the probability distribution of interest The likelihood that the base is one of the four nucleotide bases. Examples of single-cell features include the context sequence around the base of interest, the sequencing depth of the base of interest, the allele frequency of the base of interest, and the allele frequency of bases in a window around the base of interest. 短语“变体调用程序模型”是指预测模型或机器学习模型，它经实施以调用细胞群体的变体。变体调用程序模型分析源自细胞群体的校正的序列读段的细胞群体特征，所述序列读段已经受误差校正(例如，使用误差校正模型校正)。在一个实施方案中，变体调用程序模型接收细胞群体特征作为输入且预测候选变体的分类。在一个实施方案中，变体调用程序模型从先前校正的序列读段提取细胞群体特征且基于所提取细胞群体特征预测候选变体的分类。The phrase 'variant calling program model' refers to a predictive model or machine learning model that is implemented to call variants of a population of cells. The variant caller model analyzes cell population characteristics of corrected sequence reads derived from a cell population that have been error corrected (eg, using an error correction model). In one embodiment, the variant caller model receives cell population characteristics as input and predicts the classification of candidate variants. In one embodiment, the variant calling program model extracts cell population characteristics from previously corrected sequence reads and predicts the classification of candidate variants based on the extracted cell population characteristics. 短语“细胞群体特征”是指与源自细胞群体的校正的序列读段的候选变体相关的特征。通过变体调用程序模型分析细胞群体特征以预测细胞群体的真变体。细胞群体特征的实例包括杂合子调用百分比、杂合子调用的中值变体等位基因频率(VAF)、杂合子调用的中值基因型质量、杂合子调用的中值读段深度、纯合子调用百分比、纯合子调用的中值VAF、纯合子调用的中值基因型质量、纯合子调用的中值读段深度、参考调用百分比、用于纯合子调用的读段深度的变异系数(CV)、用于杂合子调用的读段深度的CV、纯合子调用的基因型质量的CV、杂合子调用的基因型质量的CV、用于纯合子调用的VAF的CV、用于杂合子调用的VAF的CV、用于纯合子调用的平均VAF与中值VAF之间的差、用于杂合子调用的平均VAF与中值VAF之间的差和扩增子GC百分比。The phrase 'cell population characteristic' refers to a characteristic associated with a candidate variant of a corrected sequence read derived from a cell population. Cell population characteristics were analyzed by variant calling program models to predict true variants of cell populations. Examples of cell population characteristics include percent heterozygous calls, median variant allele frequency (VAF) for heterozygous calls, median genotype quality for heterozygous calls, median read depth for heterozygous calls, homozygous calls Percentage, median VAF for homozygous calls, median genotype quality for homozygous calls, median read depth for homozygous calls, percent reference calls, coefficient of variation (CV) for read depth for homozygous calls, CV for read depth for heterozygous calls, CV for genotype quality for homozygous calls, CV for genotype quality for heterozygous calls, CV for VAF for homozygous calls, CV for VAF for heterozygous calls CV, difference between mean and median VAF for homozygous calls, difference between mean and median VAF for heterozygous calls and amplicon GC percentage. 短语“候选变体”是指与参考碱基相比发生错配的细胞群体的序列读段中的碱基。通常，变体调用程序模型经实施以确定候选变体是否是真变体，例如纯合变体或杂合变体。The phrase 'candidate variant' refers to a base in a sequence read of a population of cells that is mismatched compared to a reference base. Typically, variant caller models are implemented to determine whether a candidate variant is a true variant, eg, a homozygous variant or a heterozygous variant. 短语“真变体”是指存在于细胞群体的一个或多个细胞中的遗传变体。The phrase 'true variant' refers to a genetic variant that exists in one or more cells of a cell population. 概述Overview 本文所述的实施方案是指进行碱基的细胞特异性误差校正且还使用误差校正的序列读段进行变体鉴别的改良的变体调用程序。在多个实施方案中，细胞特异性误差校正涉及实施误差校正模型，且变体鉴别涉及实施变体调用程序模型。总之，与误差校正模型和/或变体调用程序模型相反的采用硬截止的常规变体调用方法(例如基因组分析工具盒(GATK))相比，本文所述的变体调用方法在调用存在于细胞中的真变体方面实现更高的准确性。关于GATK中所用的硬过滤器的进一步描述参见De Summa,S.、Malerba,G.、Pinto,R.等人，GATK hard filtering:tunable parameters to improve variant calling fornext generation sequencing targeted gene panel data.BMC Bioinformatics 18,119(2017)，所述参考文献的全文以引用方式在此并入。Embodiments described herein refer to an improved variant calling program that performs cell-specific error correction of bases and also uses error-corrected sequence reads for variant identification. In various embodiments, cell-specific error correction involves implementing an error correction model, and variant identification involves implementing a variant caller model. In conclusion, in contrast to conventional variant calling methods (eg, Genome Analysis Toolkit (GATK)) that employ hard cutoffs, as opposed to error correction models and/or variant caller models, the variant calling methods described herein are Achieve higher accuracy in terms of true variants in cells. For a further description of the hard filters used in GATK see De Summa, S., Malerba, G., Pinto, R. et al., GATK hard filtering: tunable parameters to improve variant calling fornext generation sequencing targeted gene panel data. BMC Bioinformatics 18, 119 (2017), the entire contents of which are incorporated herein by reference. 参考图1，它描绘根据实施方案的整体系统环境实施方案100，其包括细胞分析工作流装置120和用于变体调用的碱基调用程序装置130。获得细胞群体110。在多个实施方案中，细胞群体110可由从受试者或患者获得的测试样品分离而来。在多个实施方案中，细胞群体110包括取自健康受试者的健康细胞。在多个实施方案中，细胞群体110包括取自受试者的患病细胞。在一个实施方案中，细胞群体110包括取自先前经诊断患有癌症的受试者的癌细胞。例如，癌细胞可为可在经诊断患有癌症的受试者的血流中获得的肿瘤细胞。作为另一实例，癌细胞可为通过肿瘤活检获得的细胞。Referring to FIG. 1, there is depicted an overall system environment embodiment 100 including a cell analysis workflow device 120 and a basecaller device 130 for variant calling, according to an embodiment. Cell population 110 is obtained. In various embodiments, cell population 110 can be isolated from a test sample obtained from a subject or patient. In various embodiments, cell population 110 comprises healthy cells obtained from healthy subjects. In various embodiments, cell population 110 includes diseased cells obtained from a subject. In one embodiment, cell population 110 includes cancer cells taken from a subject previously diagnosed with cancer. For example, cancer cells can be tumor cells that can be obtained in the bloodstream of a subject diagnosed with cancer. As another example, cancer cells may be cells obtained by tumor biopsy. 细胞分析工作流装置120是指处理细胞并生成测序用核酸的装置。在多个实施方案中，细胞分析工作流装置120是指包括处理细胞并生成测序用核酸的一种或多种装置的系统。在多个实施方案中，细胞分析工作流装置120是工作流装置，它从单细胞生成核酸，由此使得能够随后鉴别序列读段和序列读段所源自的单个细胞。在多个实施方案中，细胞分析工作流装置120可通过将单个细胞囊封到乳液中、裂解乳液内的细胞、对乳液中的细胞裂解物进行细胞条码化并在乳液中进行核酸扩增反应来进行单细胞处理。因此，可收集扩增的核酸并进行测序。美国申请第14/420,646号描述单细胞工作流过程的示例性实施方案的进一步描述，所述美国申请的全文在此以引用方式并入本文。Cell analysis workflow device 120 refers to a device that processes cells and generates nucleic acids for sequencing. In various embodiments, cell analysis workflow device 120 refers to a system that includes one or more devices that process cells and generate nucleic acids for sequencing. In various embodiments, cell analysis workflow device 120 is a workflow device that generates nucleic acids from single cells, thereby enabling subsequent identification of sequence reads and the single cells from which the sequence reads are derived. In various embodiments, the cell analysis workflow device 120 can perform nucleic acid amplification reactions in the emulsion by encapsulating single cells into an emulsion, lysing cells within the emulsion, cell barcoding cell lysates in the emulsion, and performing nucleic acid amplification reactions in the emulsion. for single-cell processing. Thus, amplified nucleic acids can be collected and sequenced. A further description of an exemplary embodiment of a single cell workflow process is described in US Application No. 14/420,646, which is hereby incorporated by reference in its entirety. 在具体实施方案中，细胞分析工作流装置120可为TapestriTM平台、inDropTM系统、NadiaTM仪器或ChromiumTM仪器中的任一个。在多个实施方案中，细胞分析工作流装置120包括用于对核酸测序以生成序列读段的测序仪。In particular embodiments, the cellular analysis workflow device 120 may be any of the Tapestri ™ platform, the inDrop ™ system, the Nadia ™ instrument, or the Chromium ™ instrument. In various embodiments, the cellular analysis workflow device 120 includes a sequencer for sequencing nucleic acids to generate sequence reads. 碱基调用程序装置130经配置以从细胞分析工作流装置120接收序列读段并处理序列读段以调用一种或多种变体140。在多个实施方案中，碱基调用程序装置130被通信耦接到细胞分析工作流装置120，且因此直接从细胞分析工作流装置120接收序列读段。碱基调用程序装置130对序列读段中的所关注碱基进行误差校正且然后调用细胞群体110中的可能变体。在具体实施方案中，碱基调用程序装置130通过细胞特异性工作流过程校正序列读段中的所关注碱基，且随后使用校正的序列读段调用细胞群体中的变体。总之，此细胞特异性误差校正和细胞群体变体调用两步过程使得能够在细胞群体110中进行更准确的变体调用140。Basecaller device 130 is configured to receive sequence reads from cell analysis workflow device 120 and process the sequence reads to call one or more variants 140 . In various embodiments, basecaller device 130 is communicatively coupled to cell analysis workflow device 120 and thus receives sequence reads directly from cell analysis workflow device 120 . The base caller device 130 performs error correction on the bases of interest in the sequence reads and then calls possible variants in the cell population 110 . In particular embodiments, the base caller device 130 corrects the bases of interest in the sequence reads through a cell-specific workflow process, and then uses the corrected sequence reads to call variants in the cell population. Taken together, this two-step process of cell-specific error correction and cell population variant calling enables more accurate variant calling 140 in cell population 110 . 碱基调用程序装置base caller device 图2是根据图1中所述的实施方案的碱基调用程序装置130的方块图。如图2中所显示，碱基调用程序装置130包括碱基鉴别模块210、碱基校正模块220、细胞群体模块230、碱基调用程序模块240和训练模块250。在一些实施方案中，碱基调用程序装置130的模块可不同于图2中所显示的实施方案进行排列。例如，可通过除碱基调用程序装置130外的装置实施训练模块250(如以虚线显示)且可通过其它装置进行下文针对训练模块250描述的方法。FIG. 2 is a block diagram of the basecaller apparatus 130 according to the embodiment described in FIG. 1 . As shown in FIG. 2 , the basecaller device 130 includes a base calling module 210 , a base correction module 220 , a cell population module 230 , a basecaller module 240 and a training module 250 . In some embodiments, the modules of the basecaller device 130 may be arranged differently than the embodiment shown in FIG. 2 . For example, training module 250 (as shown in phantom) may be implemented by a device other than basecaller device 130 and the methods described below for training module 250 may be performed by other devices. 通常，碱基鉴别模块210分析源自单个细胞的序列读段且鉴别与参考碱基相比发生错配的一个或多个所关注碱基。碱基鉴别模块210基于每个细胞鉴别所关注碱基。例如，碱基鉴别模块210分析来自第一细胞的序列读段以确定来自第一细胞的序列读段的所关注碱基。碱基鉴别模块210还分析来自第二细胞的序列读段以确定来自第二细胞的序列读段的所关注碱基等等。来自不同细胞的序列读段可使用条码技术彼此进行区分，PCT/US2016/016444进一步描述所述条码技术的实例，所述申请的全文以引用方式在此并入。另外，对于每一细胞，碱基鉴别模块210生成对应于细胞的所关注碱基的序列读段的堆积且将堆积提供到碱基校正模块220以确定是否校正所关注碱基中的任一个。Typically, the base identification module 210 analyzes sequence reads derived from a single cell and identifies one or more bases of interest that are mismatched compared to a reference base. The base identification module 210 identifies bases of interest on a per cell basis. For example, the base identification module 210 analyzes the sequence reads from the first cell to determine the bases of interest of the sequence reads from the first cell. The base identification module 210 also analyzes the sequence reads from the second cell to determine the bases of interest of the sequence reads from the second cell, and so on. Sequence reads from different cells can be distinguished from each other using barcode technology, examples of which are further described in PCT/US2016/016444, which is incorporated herein by reference in its entirety. Additionally, for each cell, base identification module 210 generates a stack of sequence reads corresponding to the bases of interest for the cell and provides the stack to base correction module 220 to determine whether to correct any of the bases of interest. 在多个实施方案中，碱基鉴别模块210获得与参考基因组比对的序列读段。作为实例，碱基鉴别模块210可以可读文件格式(例如SAM(序列比对图)文件格式或BAM(二进制比对图)文件格式)获得序列读段。In various embodiments, the base calling module 210 obtains sequence reads that are aligned to a reference genome. As an example, the base calling module 210 may obtain sequence reads in a readable file format, such as a SAM (Sequence Alignment Map) file format or a BAM (Binary Alignment Map) file format. 给定比对的序列读段，碱基鉴别模块210在源自细胞的序列读段中鉴别一个或多个所关注碱基。在多个实施方案中，碱基鉴别模块210分析每一错配碱基以确定错配碱基是否是所关注碱基。Given the aligned sequence reads, the base identification module 210 identifies one or more bases of interest in the cell-derived sequence reads. In various embodiments, the base identification module 210 analyzes each mismatched base to determine whether the mismatched base is the base of interest. 在多个实施方案中，为鉴别所关注碱基，碱基鉴别模块210应用过滤器来确定在来自细胞的位置处是否至少阈值数量的序列读段具有不同于该位置处参考碱基的特定核苷酸碱基。在多个实施方案中，如果在该位置超过阈值数量的序列读段具有不同于参考碱基的核苷酸碱基，那么碱基鉴别模块210将该碱基鉴别为所关注碱基用于后续校正。In various embodiments, to identify a base of interest, the base identification module 210 applies a filter to determine whether at least a threshold number of sequence reads at a location from a cell have a particular nucleus that differs from a reference base at that location nucleotide bases. In various embodiments, if more than a threshold number of sequence reads at that position have nucleotide bases that differ from the reference base, the base identification module 210 identifies the base as the base of interest for subsequent use Correction. 在多个实施方案中，该位置的序列读段的阈值数量是固定值。在多个实施方案中，序列读段的阈值数量大于1000个、大于2000个、大于3000个、大于4000个、大于5000个、大于6000个、大于7000个、大于8000个、大于9000个、大于10,000个、大于20,000个、大于30,000个、大于40,000个、大于50,000个、大于75,000个、大于100,000个、大于150,000个、大于200,000个、大于250,000个或大于500,000个序列读段。在多个实施方案中，序列读段的阈值数量大于来自细胞的该位置的总序列读段的5％、大于来自细胞的该位置的总序列读段的10％、大于来自细胞的该位置的总序列读段的20％、大于来自细胞的该位置的总序列读段的30％、大于来自细胞的该位置的总序列读段的40％、大于来自细胞的该位置的总序列读段的50％、大于来自细胞的该位置的总序列读段的60％、大于来自细胞的该位置的总序列读段的70％、大于来自细胞的该位置的总序列读段的75％、大于来自细胞的该位置的总序列读段的80％、大于来自细胞的该位置的总序列读段的85％、大于来自细胞的该位置的总序列读段的90％或大于来自细胞的该位置的总序列读段的95％。In various embodiments, the threshold number of sequence reads at that position is a fixed value. In various embodiments, the threshold number of sequence reads is greater than 1000, greater than 2000, greater than 3000, greater than 4000, greater than 5000, greater than 6000, greater than 7000, greater than 8000, greater than 9000, greater than 10,000, greater than 20,000, greater than 30,000, greater than 40,000, greater than 50,000, greater than 75,000, greater than 100,000, greater than 150,000, greater than 200,000, greater than 250,000, or greater than 500,000 sequence reads. In various embodiments, the threshold number of sequence reads is greater than 5% of the total sequence reads from the position of the cell, greater than 10% of the total sequence reads from the position of the cell, greater than 5% of the total sequence reads from the position of the cell 20% of total sequence reads, greater than 30% of total sequence reads at this position from cells, greater than 40% of total sequence reads at this position from cells, greater than 30% of total sequence reads at this position from cells 50%, greater than 60% of the total sequence reads at the position from the cell, greater than 70% of the total sequence reads at the position from the cell, greater than 75% of the total sequence reads at the position from the cell, greater than 80% of the total sequence reads at the position of the cell, greater than 85% of the total sequence reads from the position of the cell, greater than 90% of the total sequence reads from the position of the cell, or greater than 80% of the total sequence reads from the position of the cell 95% of total sequence reads. 在多个实施方案中，碱基鉴别模块210通过应用转换矩阵来鉴别所关注碱基。在此类实施方案中，应用转换矩阵包括比较转换矩阵的概率与反映观察到序列读段的一定比例的核苷酸碱基的可能性的概率。In various embodiments, the base identification module 210 identifies bases of interest by applying a transformation matrix. In such embodiments, applying the transition matrix includes comparing the probabilities of the transition matrix to probabilities that reflect the likelihood of observing a proportion of the nucleotide bases of the sequence reads. 首先提到的转换矩阵包括代表特定位置的参考碱基的核苷酸与观察到的碱基的核苷酸之间的转换频率的概率。通常，代表转换矩阵的转换频率的概率使得碱基鉴别模块210能够区分可能因误差(PCR误差、测序误差等)引起的错配碱基与并非因误差产生的错配碱基。The first-mentioned transition matrix includes the probability of transition frequencies between nucleotides representing the reference base at a particular position and nucleotides at the observed base. Generally, the probabilities representing the transition frequencies of the transition matrix enable the base identification module 210 to distinguish mismatched bases that may be due to errors (PCR errors, sequencing errors, etc.) from mismatched bases that are not due to errors. 在多个实施方案中，对于给定参考碱基(例如A、C、G或T)，转换矩阵包括参考碱基在序列读段中被观察为的不同碱基的概率。在多个实施方案中，转换矩阵包括12个概率值(例如，3个概率值反映参考碱基到错配碱基的转换)。在多个实施方案中，转换矩阵包括16个概率值。此包括每一参考碱基的在序列读段中观察到的碱基与参考碱基匹配的概率。下文图7中描述示例性转换矩阵。In various embodiments, for a given reference base (eg, A, C, G, or T), the transition matrix includes the probability that the reference base is observed as a distinct base in the sequence read. In various embodiments, the transition matrix includes 12 probability values (eg, 3 probability values reflecting the transition of reference bases to mismatched bases). In various embodiments, the transition matrix includes 16 probability values. This includes the probability that the observed base in the sequence read matches the reference base for each reference base. An exemplary transformation matrix is described in FIG. 7 below. 图7是转换矩阵的示例性描绘。在此处，转换矩阵包括参考碱基(例如y轴上的“REF”)和观察到的碱基(例如x轴上的“观察到的碱基”)的名称。转换矩阵中的每个细胞包括代表参考碱基的核苷酸被观察为观察到的碱基的核苷酸的概率的可能性值。例如，转换矩阵的第一行指示对于已知腺嘌呤参考碱基“A”，观察到的碱基与参考腺嘌呤碱基匹配的概率是99％(第一行)。然而，在一些情况下，在序列读段中不同地观察到的参考腺嘌呤碱基。例如，对于已知腺嘌呤参考碱基“A”，观察到的碱基与参考腺嘌呤碱基错配的概率是0.26％(第一行第二列指示观察到的胸腺嘧啶碱基)、0.61％(第一行第三列指示观察到的鸟嘌呤碱基)和0.13％(第一行第四列指示观察到的胞嘧啶碱基)。7 is an exemplary depiction of a transformation matrix. Here, the transformation matrix includes the names of reference bases (eg, 'REF' on the y-axis) and observed bases (eg, 'observed bases' on the x-axis). Each cell in the transformation matrix includes a likelihood value representing the probability that the nucleotide of the reference base is observed as the nucleotide of the observed base. For example, the first row of the transformation matrix indicates that for a known adenine reference base 'A', the probability that the observed base matches the reference adenine base is 99% (first row). In some cases, however, the reference adenine bases were observed differently in the sequence reads. For example, for a known adenine reference base 'A', the probability of a mismatch between the observed base and the reference adenine base is 0.26% (the first row and second column indicate the observed thymine base), 0.61 % (first row third column indicates observed guanine bases) and 0.13% (first row fourth column indicates observed cytosine bases). 在一些实施方案中，转换矩阵先前从一种或多种先前样品生成。先前样品可包括细胞群体的细胞或可包括细胞群体混合物的细胞。在此类实施方案中，转换矩阵用作可在不同样品中应用的参考。因此，转换矩阵可用于鉴别不同样品的所关注碱基。在多个实施方案中，碱基鉴别模块210生成经受变体调用过程的每一样品的转换矩阵。因此，在此类实施方案中，在鉴别所关注碱基时，碱基鉴别模块210为每一样品应用不同的转换矩阵。此在一些情况下可能是优选的，这是因为误差可以样品依赖性方式产生。In some embodiments, the transformation matrix was previously generated from one or more previous samples. The previous sample may include cells of a cell population or may include cells of a mixture of cell populations. In such embodiments, the transformation matrix serves as a reference that can be applied in different samples. Thus, transformation matrices can be used to identify bases of interest for different samples. In various embodiments, the base calling module 210 generates a transformation matrix for each sample subjected to the variant calling process. Thus, in such embodiments, base identification module 210 applies a different transformation matrix for each sample when identifying bases of interest. This may be preferable in some cases because errors can arise in a sample-dependent manner. 在多个实施方案中，碱基鉴别模块210使用碱基鉴别模块210正在分析的至少部分相同的序列读段生成转换矩阵来鉴别所关注碱基。在此类实施方案中，随着所关注碱基被校正(例如使用如下文所述的误差校正模型校正)，碱基鉴别模块210可动态更新转换矩阵中的概率，以反映校正碱基的新核苷酸碱基。作为碱基鉴别模块210如何生成转换矩阵的实例，对于具有参考碱基“A”的位置，碱基鉴别模块210确定在该位置具有四种核苷酸碱基(A、C、T或G)中的任一种的序列读段的比例。因此，碱基鉴别模块210量化具有参考碱基“A”的位置的四种核苷酸碱基的概率分布。碱基鉴别模块210可确定参考核苷酸碱基“C”、“T”和“G”的转换的概率。In various embodiments, base identification module 210 uses at least partially identical sequence reads that base identification module 210 is analyzing to generate a transformation matrix to identify bases of interest. In such embodiments, as the bases of interest are corrected (eg, using an error correction model as described below), the base identification module 210 can dynamically update the probabilities in the transition matrix to reflect the new corrections for the bases. Nucleotide bases. As an example of how base identification module 210 generates a transformation matrix, for a position with reference base 'A', base identification module 210 determines that there are four nucleotide bases (A, C, T, or G) at that position The proportion of sequence reads for any of the . Thus, the base identification module 210 quantifies the probability distribution of the four nucleotide bases having the position of the reference base 'A'. The base identification module 210 can determine the probability of transitions of reference nucleotide bases 'C', 'T' and 'G'. 在多个实施方案中，碱基鉴别模块210确定反映在序列读段中对该位置观察到所述比例的核苷酸碱基的可能性的概率。在一些实施方案中，概率可表示为：In various embodiments, the base identification module 210 determines a probability that reflects the likelihood of observing the proportion of nucleotide bases at the position in the sequence read. In some embodiments, the probability can be expressed as: P(腺嘌呤＝W，胞嘧啶＝X，鸟嘌呤＝Y，胸腺嘧啶＝Z|N读段)P(Adenine=W, Cytosine=X, Guanine=Y, Thymine=Z|N read) 其中W是在该位置观察到的具有腺嘌呤核苷酸碱基的序列读段的数量，其中X是在该位置观察到的具有胞嘧啶核苷酸碱基的序列读段的数量，其中Y是在该位置观察到的具有胸腺嘧啶核苷酸碱基的序列读段的数量，其中Z是在该位置观察到的具有胸腺嘧啶核苷酸碱基的序列读段的数量，且其中N是在该位置观察到的序列读段的总数量。where W is the number of observed sequence reads with adenine nucleotide bases at that position, where X is the number of observed sequence reads with cytosine nucleotide bases at that position, and where Y is the number of observed sequence reads with thymidine nucleotide bases at that position, where Z is the number of observed sequence reads with thymidine nucleotide bases at that position, and where N is The total number of sequence reads observed at this position. 在一些实施方案中，概率反映在序列读段中对该位置观察到所述比例的错配核苷酸碱基的可能性。在此处，概率可表示为：In some embodiments, the probability reflects the likelihood of observing the proportion of mismatched nucleotide bases at that position in the sequence read. Here, the probability can be expressed as: P(碱基1＝X，碱基2＝Y，碱基3＝Z|N读段)P (base 1=X, base 2=Y, base 3=Z|N read) 其中碱基1、碱基2和碱基3是指与参考碱基不匹配的核苷酸碱基，其中X是在该位置观察到的具有碱基1的序列读段的数量，其中Y是在该位置观察到的具有碱基2的序列读段的数量，其中Z是在该位置观察到的具有碱基3的序列读段的数量，且其中N是在该位置观察到的序列读段的总数量。where base 1, base 2, and base 3 refer to nucleotide bases that do not match the reference base, where X is the number of observed sequence reads with base 1 at that position, and where Y is The number of observed sequence reads with base 2 at that position, where Z is the number of observed sequence reads with base 3 at that position, and where N is the observed sequence read at that position total number of . 碱基鉴别模块210比较反映对该位置观察到所述比例的核苷酸碱基的可能性的概率与转换矩阵的概率。在多个实施方案中，如果比较产生反映观察到所述比例的核苷酸碱基的可能性的概率大于转换矩阵的概率，那么碱基鉴别模块210将碱基鉴别为所关注碱基。因此，所关注碱基随后可经受校正。如果比较产生反映观察到所述比例的核苷酸碱基的可能性的概率小于转换矩阵的概率，那么碱基鉴别模块210不将碱基鉴别为所关注碱基。因此，碱基不经受校正且仍为错配碱基。The base identification module 210 compares the probability reflecting the likelihood of observing the ratio of nucleotide bases at the position with the probability of the transition matrix. In various embodiments, the base identification module 210 identifies the base as the base of interest if the probability that the comparison yields the likelihood reflecting the observed ratio of nucleotide bases is greater than the probability of the transition matrix. Thus, the base of interest can then be subjected to correction. The base identification module 210 does not identify the base as a base of interest if the probability that the comparison yields a probability that reflects the likelihood of observing the ratio of nucleotide bases is less than the probability of the transition matrix. Therefore, the bases are not subject to correction and remain mismatched bases. 作为鉴别所关注碱基的整体实例，碱基鉴别模块210可鉴别该位置的大多数序列读段具有腺嘌呤(参考碱基)到鸟嘌呤(观察到的碱基)错配。转换矩阵包括反映从参考腺嘌呤碱基转换成观察到的鸟嘌呤碱基的可能性的概率。假设此概率为0.01。碱基鉴别模块210可确定，观察到除参考碱基外的所述比例的核苷酸碱基(例如观察到鸟嘌呤、胞嘧啶或胸腺嘧啶核苷酸碱基)的概率为0.05。碱基鉴别模块210比较观察到所述比例的核苷酸碱基的概率(0.05)与转换矩阵的概率(0.01)。在此处，鉴于观察到所述比例的核苷酸碱基的概率(0.05)大于转换矩阵的概率(0.01)，碱基鉴别模块210将碱基鉴别为所关注碱基。As an overall example of identifying bases of interest, base identification module 210 can identify that most sequence reads at that position have adenine (reference base) to guanine (observed base) mismatches. The transition matrix includes probabilities reflecting the likelihood of transitioning from a reference adenine base to an observed guanine base. Suppose this probability is 0.01. The base identification module 210 may determine that the probability of observing the ratio of nucleotide bases other than the reference base (eg, observing a guanine, cytosine, or thymine nucleotide base) is 0.05. The base identification module 210 compares the probability (0.05) of observing the ratio of nucleotide bases with the probability (0.01) of the transition matrix. Here, the base identification module 210 identifies the base as the base of interest given that the probability (0.05) of observing the ratio of nucleotide bases is greater than the probability (0.01) of the transformation matrix. 在多个实施方案中，在已鉴别出所关注碱基的情况下，碱基鉴别模块210生成每一所关注碱基的序列读段的堆积。特定来说，碱基鉴别模块210生成包括序列读段的堆积，所述序列读段包括位于所关注碱基上游X个位置和下游Y个位置的碱基。在多个实施方案中，X和Y是相同的值。在其它实施方案中，X和Y是不同的值。在多个实施方案中，X可为所关注碱基上游的1个位置、2个位置、3个位置、4个位置、5个位置、6个位置、7个位置、8个位置、9个位置、10个位置、15个位置、20个位置、25个位置、30个位置、40个位置、50个位置、60个位置、70个位置、80个位置、90个位置、100个位置、110个位置、120个位置、130个位置、140个位置或150个位置。在多个实施方案中，Y可为所关注碱基下游的1个位置、2个位置、3个位置、4个位置、5个位置、6个位置、7个位置、8个位置、9个位置、10个位置、15个位置、20个位置、25个位置、30个位置、40个位置、50个位置、60个位置、70个位置、80个位置、90个位置、100个位置、110个位置、120个位置、130个位置、140个位置或150个位置。In various embodiments, where bases of interest have been identified, base identification module 210 generates a stack of sequence reads for each base of interest. In particular, base identification module 210 generates a stack that includes sequence reads including bases located X positions upstream and Y positions downstream of the base of interest. In various embodiments, X and Y are the same value. In other embodiments, X and Y are different values. In various embodiments, X can be 1 position, 2 positions, 3 positions, 4 positions, 5 positions, 6 positions, 7 positions, 8 positions, 9 positions upstream of the base of interest positions, 10 positions, 15 positions, 20 positions, 25 positions, 30 positions, 40 positions, 50 positions, 60 positions, 70 positions, 80 positions, 90 positions, 100 positions, 110 positions, 120 positions, 130 positions, 140 positions or 150 positions. In various embodiments, Y can be 1 position, 2 positions, 3 positions, 4 positions, 5 positions, 6 positions, 7 positions, 8 positions, 9 positions downstream of the base of interest positions, 10 positions, 15 positions, 20 positions, 25 positions, 30 positions, 40 positions, 50 positions, 60 positions, 70 positions, 80 positions, 90 positions, 100 positions, 110 positions, 120 positions, 130 positions, 140 positions or 150 positions. 在多个实施方案中，碱基鉴别模块210生成堆积，使得对于位于所关注碱基位置上游和下游的位置，堆积包括指示所述比例的具有四种核苷酸碱基(例如腺嘌呤、鸟嘌呤、胞嘧啶或胸腺嘧啶)中的一者的序列读段的概率。例如，堆积可体现为矩阵，使得对于堆积中的每一位置，矩阵包括鉴别所述比例的在该位置具有相应腺嘌呤、鸟嘌呤、胞嘧啶或胸腺嘧啶的序列读段的概率。In various embodiments, the base identification module 210 generates stacks such that for positions located upstream and downstream of the base position of interest, the stack includes a base having four nucleotides (eg, adenine, guanine, etc.) indicating the ratio. Probability of sequence reads for one of purine, cytosine, or thymine). For example, a stack can be embodied as a matrix such that for each position in the stack, the matrix includes the probability of identifying the proportion of sequence reads that have the corresponding adenine, guanine, cytosine, or thymine at that position. 碱基校正模块220应用误差校正模型来确定所关注碱基的可能核苷酸。因此，碱基校正模块220可校正源自细胞的一个或多个序列读段中的所关注碱基。校正的序列读段代表随后可用于调用真变体的改良的序列读段。通常，碱基校正模型220通过细胞特异性过程校正序列读段。在此处，碱基校正模型220可校正第一细胞的序列读段中的所关注碱基，但无法校正第二细胞的序列读段中的相同碱基。由于误差(例如PCR误差、测序误差、测序比对误差或校正误差)可出现在单个细胞中，通过碱基校正模型220进行的方法使得能够基于每个细胞校正序列读段以解决这些误差。The base correction module 220 applies an error correction model to determine the likely nucleotides for the base of interest. Accordingly, base correction module 220 can correct bases of interest in one or more sequence reads derived from cells. Corrected sequence reads represent improved sequence reads that can then be used to call true variants. Typically, the base correction model 220 corrects the sequence reads by a cell-specific process. Here, the base correction model 220 can correct the base of interest in the sequence read of the first cell, but cannot correct the same base in the sequence read of the second cell. Since errors (eg, PCR errors, sequencing errors, sequencing alignment errors, or calibration errors) can occur in individual cells, the approach by base correction model 220 enables sequence reads to be corrected on a per-cell basis to account for these errors. 碱基校正模块220接收对所关注碱基生成的堆积。在一个实施方案中，碱基校正模块220将所关注碱基的堆积作为输入应用于误差校正模型。在此处，误差校正模型可提取并分析堆积的单细胞特征，包括所关注碱基周围的上下文序列、所关注碱基的测序深度、所关注碱基的等位基因频率和所关注碱基周围的窗口中的碱基的等位基因频率。在多个实施方案中，“窗口”是指位于所关注碱基上游的X个碱基和位于所关注碱基下游的Y个碱基。在多个实施方案中，X和Y可彼此独立地为2个碱基、3个碱基、4个碱基、5个碱基、6个碱基、7个碱基、8个碱基、9个碱基、10个碱基、20个碱基、30个碱基、40个碱基、50个碱基、60个碱基、70个碱基、75个碱基、80个碱基、90个碱基、100个碱基、150个碱基、200个碱基、300个碱基、400个碱基或500个碱基。作为实例，误差校正模型可为从堆积提取单细胞特征并分析单细胞特征的神经网络(例如深度学习神经网络)。在一些实施方案中，碱基校正模块220进行特征提取过程以从堆积提取单细胞特征。在此类实施方案中，单细胞特征可作为输入提供到误差校正模型。在多个实施方案中，误差校正模型输出对应于四种核苷酸碱基(腺嘌呤、鸟嘌呤、胞嘧啶和胸腺嘧啶)的概率分布，所述概率分布代表基于所分析的单细胞特征，所关注碱基是四种核苷酸碱基中的一者的可能性。Base correction module 220 receives stacks generated for bases of interest. In one embodiment, the base correction module 220 applies the stacking of bases of interest as input to an error correction model. Here, an error-corrected model extracts and analyzes stacked single-cell features, including the context sequence around the base of interest, the sequencing depth of the base of interest, the allele frequency of the base of interest, and the surrounding bases of interest The allele frequency of the bases in the window. In various embodiments, a 'window' refers to X bases upstream of the base of interest and Y bases downstream of the base of interest. In various embodiments, X and Y can be independently of each other 2 bases, 3 bases, 4 bases, 5 bases, 6 bases, 7 bases, 8 bases, 9 bases, 10 bases, 20 bases, 30 bases, 40 bases, 50 bases, 60 bases, 70 bases, 75 bases, 80 bases, 90 bases, 100 bases, 150 bases, 200 bases, 300 bases, 400 bases or 500 bases. As an example, the error correction model may be a neural network (eg, a deep learning neural network) that extracts single-cell features from the stack and analyzes the single-cell features. In some embodiments, the base correction module 220 performs a feature extraction process to extract single cell features from the stack. In such embodiments, single cell features may be provided as input to the error correction model. In various embodiments, the error-corrected model outputs a probability distribution corresponding to the four nucleotide bases (adenine, guanine, cytosine, and thymine) representing a single-cell signature based on the analysis, The likelihood that the base of interest is one of the four nucleotide bases. 在多个实施方案中，碱基校正模型220基于由误差校正模型输出的概率分布将所关注碱基校正为不同的核苷酸碱基。在一个实施方案中，碱基校正模型220将所关注碱基校正为在由误差校正模型输出的分布概率中具有最高概率的核苷酸碱基。在此处，校正的核苷酸碱基代表存在于细胞中的可能碱基。为将所关注碱基校正为不同的核苷酸碱基，碱基校正模型220校正包括所关注碱基的一个或多个序列读段以反映正确的核苷酸碱基。总之，碱基校正模型220使用更准确地反映细胞的序列的校正的核苷酸碱基再生成校正的序列读段。In various embodiments, the base correction model 220 corrects the bases of interest to different nucleotide bases based on the probability distribution output by the error correction model. In one embodiment, the base correction model 220 corrects the base of interest to the nucleotide base with the highest probability in the distribution probability output by the error correction model. Here, the corrected nucleotide bases represent possible bases present in the cell. To correct the bases of interest to different nucleotide bases, the base correction model 220 corrects one or more sequence reads that include the bases of interest to reflect the correct nucleotide bases. In summary, the base correction model 220 regenerates corrected sequence reads using corrected nucleotide bases that more accurately reflect the sequence of the cell. 在多个实施方案中，碱基校正模型220校正源自具有所关注碱基的单细胞的所有序列读段，使得在校正后，校正的序列读段包括正确的碱基。在多个实施方案中，碱基校正模型220校正源自具有所关注碱基的单细胞的序列读段的一部分。例如，具有所关注碱基的一些序列读段可具有正确的碱基且因此无需校正。作为另一实例，具有所关注碱基的一些序列读段可为低置信度读段且可丢弃而非校正。在多个实施方案中，碱基校正模型220以可读文件格式(例如BAM文件格式或SAM文件格式)生成校正的序列读段。In various embodiments, the base correction model 220 corrects all sequence reads derived from single cells having bases of interest such that, after correction, the corrected sequence reads include the correct bases. In various embodiments, the base correction model 220 corrects a portion of a sequence read derived from a single cell having a base of interest. For example, some sequence reads with bases of interest may have correct bases and therefore need not be corrected. As another example, some sequence reads with bases of interest may be low confidence reads and may be discarded rather than corrected. In various embodiments, the base correction model 220 generates corrected sequence reads in a readable file format (eg, a BAM file format or a SAM file format). 细胞群体模块230根据细胞群体的校正的序列读段来确定细胞群体特征。通常，细胞群体模块230分析基于每个细胞组织的校正的序列读段，且确定描述细胞群体的细胞群体特征。The cell population module 230 determines cell population characteristics from the corrected sequence reads of the cell population. Generally, the cell population module 230 analyzes the corrected sequence reads based on each cell tissue and determines cell population characteristics that describe the cell population. 细胞群体模块230鉴别细胞群体中在已对细胞的序列读段进行误差校正后保留的一种或多种候选变体。在多个实施方案中，候选变体包括在已校正序列读段后保留的所有变体。在多个实施方案中，细胞群体模块230进行过滤，使得候选变体是在已校正序列读段后保留的所有变体的子集。例如，如果碱基满足一个或多个标准，那么细胞群体模块230鉴别特定位置的候选变体。在多个实施方案中，一个或多个标准用作硬截止，它包括以下中的一者或两者：1)最小等位基因频率和2)在该位置具有错配碱基的最少数量的细胞。The cell population module 230 identifies one or more candidate variants in the cell population that remain after the sequence reads of the cells have been error corrected. In various embodiments, candidate variants include all variants that remain after the sequence reads have been corrected. In various embodiments, the cell population module 230 filters such that candidate variants are a subset of all variants that remain after the sequence reads have been corrected. For example, the cell population module 230 identifies candidate variants for a particular position if the base meets one or more criteria. In various embodiments, one or more criteria are used as hard cutoffs, which include one or both of the following: 1) minimum allele frequency and 2) minimum number of mismatched bases at that position cell. 在多个实施方案中，为确定细胞群体的细胞群体特征，细胞群体模块230基于每个细胞聚集校正的序列读段，且然后使用聚集的序列读段确定细胞群体的细胞群体特征。例如，对于每一细胞，细胞群体模块230可量化在每一位置具有特定核苷酸碱基(例如A、C、T或G)的序列读段的比例。细胞群体模块230随后通过分析量化的序列读段比例来确定细胞群体的细胞群体特征。In various embodiments, to determine the cell population characteristics of the cell population, the cell population module 230 aggregates corrected sequence reads based on each cell, and then uses the aggregated sequence reads to determine the cell population characteristics of the cell population. For example, for each cell, the cell population module 230 can quantify the proportion of sequence reads that have a particular nucleotide base (eg, A, C, T, or G) at each position. The cell population module 230 then determines the cell population characteristics of the cell population by analyzing the quantified sequence read ratios. 在多个实施方案中，细胞群体模块230确定一种或多种候选变体中的每一种的细胞群体特征。作为具体实例，细胞群体特征可为特定候选变体的杂合子调用百分比(例如，在特定位置，第一拷贝的候选变体与参考碱基相比是错配的且第二拷贝的候选变体与参考碱基匹配的细胞的百分比)。因此，对于细胞，细胞群体模块230聚集细胞的校正的序列读段且确定细胞的候选变体是否是杂合子调用。细胞群体模块230在细胞群体的细胞中重复此过程以导出具有对应于候选变体的杂合子调用的细胞的百分比。对于其它候选变体，细胞群体模块230确定具有其它候选变体中的每一种的杂合拷贝的细胞的百分比。In various embodiments, the cell population module 230 determines cell population characteristics for each of the one or more candidate variants. As a specific example, a cell population characteristic may be the percentage of heterozygous calls for a particular candidate variant (eg, at a particular position, the first copy of the candidate variant is mismatched compared to the reference base and the second copy of the candidate variant is mismatched) percentage of cells matching the reference base). Thus, for a cell, the cell population module 230 aggregates the corrected sequence reads of the cell and determines whether the candidate variant of the cell is a heterozygous call. The cell population module 230 repeats this process in the cells of the cell population to derive the percentage of cells with heterozygous calls corresponding to the candidate variant. For other candidate variants, the cell population module 230 determines the percentage of cells with heterozygous copies of each of the other candidate variants. 细胞群体特征的实例包括(但不限于)杂合子调用百分比、杂合子调用的中值变体等位基因频率(VAF)、杂合子调用的中值基因型质量、杂合子调用的中值读段深度、纯合子调用百分比、纯合子调用的中值VAF、纯合子调用的中值基因型质量、纯合子调用的中值读段深度、参考调用百分比、用于纯合子调用的读段深度的变异系数(CV)、用于杂合子调用的读段深度的CV、纯合子调用的基因型质量的CV、杂合子调用的基因型质量的CV、用于纯合子调用的VAF的CV、用于杂合子调用的VAF的CV、用于纯合子调用的平均VAF与中值VAF之间的差、用于杂合子调用的平均VAF与中值VAF之间的差和扩增子GC百分比。Examples of cell population characteristics include, but are not limited to, percent heterozygous calls, median variant allele frequency (VAF) for heterozygous calls, median genotype quality for heterozygous calls, median reads for heterozygous calls Depth, percent homozygous calls, median VAF for homozygous calls, median genotype quality for homozygous calls, median read depth for homozygous calls, percent reference calls, variation in read depth for homozygous calls Coefficient (CV), CV for read depth for heterozygous calls, CV for genotype quality for homozygous calls, CV for genotype quality for heterozygous calls, CV for VAF for homozygous calls, CV for heterozygous calls CV of VAF for zygotic calls, difference between mean and median VAF for homozygous calling, difference between mean and median VAF for heterozygous calling, and percentage of amplicon GC. 碱基调用程序模块240应用变体调用程序模型以预测细胞群体的一种或多种真变体。在多个实施方案中，碱基调用程序模块240将候选变体的细胞群体特征提供到变体调用程序模型作为输入。变体调用程序模型分析细胞群体特征并输出对候选变体的预测。The basecaller module 240 applies the variant caller model to predict one or more true variants of the cell population. In various embodiments, the basecaller module 240 provides cell population characteristics of candidate variants as input to the variant caller model. The variant caller model analyzes cell population characteristics and outputs predictions for candidate variants. 在多个实施方案中，变体调用程序是从多个可能的分类中输出候选变体的分类的分类器。在一些实施方案中，变体调用程序模型是输出候选变体的两种分类中的一者的分类器。作为实例，变体调用程序模型可输出真变体或假阳性变体的分类。作为另一实例，变体调用程序模型可输出关于真变体类型的分类，例如纯合变体或杂合变体中的一者。在一些实施方案中，变体调用程序模型是输出候选变体的两种以上的可能分类中的一者的分类器。作为实例，变体调用程序模型可输出纯合变体、杂合变体或假阳性变体的分类。在一些实施方案中，变体调用程序模型输出不确定变体的分类。不确定变体可代表低置信度调用，它可能需要额外分析来确认不确定变体是否是真变体。在一些实施方案中，变体调用程序模型输出非变体(例如假阳性变体)的分类。In various embodiments, the variant caller is a classifier that outputs classifications of candidate variants from a plurality of possible classifications. In some embodiments, the variant caller model is a classifier that outputs one of two classifications of candidate variants. As an example, a variant caller model may output a classification of true variants or false positive variants. As another example, a variant caller model may output a classification of true variant types, such as one of a homozygous variant or a heterozygous variant. In some embodiments, the variant caller model is a classifier that outputs one of more than two possible classifications of candidate variants. As an example, a variant caller model can output a classification of homozygous variants, heterozygous variants, or false positive variants. In some embodiments, the variant caller model outputs the classification of indeterminate variants. An indeterminate variant can represent a low-confidence call, which may require additional analysis to confirm that the indeterminate variant is a true variant. In some embodiments, the variant caller model outputs a classification of non-variants (eg, false positive variants). 训练模块250通常实施用于生成误差校正模型和变体调用程序模型中的一者或两者的方法。在多个实施方案中，训练模块250由除碱基调用程序装置130以外的装置或系统来实施。例如，训练模块250可由第三方实施。在此情况下，第三方生成误差校正模型和变体调用程序模型中的一者或两者。第三方随后可将经训练的误差校正模型和经训练的变体调用程序模型中的一者或两者提供到碱基调用程序装置130。The training module 250 typically implements methods for generating one or both of an error correction model and a variant caller model. In various embodiments, training module 250 is implemented by a device or system other than basecaller device 130 . For example, training module 250 may be implemented by a third party. In this case, the third party generates one or both of the error correction model and the variant caller model. The third party may then provide one or both of the trained error correction model and the trained variant caller model to the basecaller device 130 . 在多个实施方案中，训练模块250训练误差校正模型。训练模块250可采用机器学习实施的方法来训练误差校正模型，例如线性回归算法、逻辑回归算法、决策树算法、支持向量机分类、朴素贝叶斯分类(Bayes classification)、K-最近邻分类、随机森林算法、深度学习算法、梯度提升算法和维数缩减技术(例如流形学习、主要组分分析、因子分析、自动编码器正则化和独立组分分析)中的任一者或其组合。在多个实施方案中，训练模块250采用监督学习算法、非监督学习算法、半监督学习算法(例如部分监督)、转移学习、多任务学习或其任一组合来训练误差校正模型。In various embodiments, the training module 250 trains an error correction model. The training module 250 can employ methods implemented by machine learning to train the error correction model, such as linear regression algorithm, logistic regression algorithm, decision tree algorithm, support vector machine classification, naive Bayesian classification ( Bayes classification), K-nearest neighbor classification, random forest algorithms, deep learning algorithms, gradient boosting algorithms, and dimensionality reduction techniques such as manifold learning, principal components analysis, factor analysis, autoencoder regularization, and independent component analysis ) any or a combination thereof. In various embodiments, the training module 250 employs supervised learning algorithms, unsupervised learning algorithms, semi-supervised learning algorithms (eg, partially supervised), transfer learning, multi-task learning, or any combination thereof to train the error correction model. 训练模块250使用误差校正训练样品来训练误差校正模型。在多个实施方案中，误差校正训练样品包括源自单个细胞的训练序列读段。此类训练样品可以常用文件格式(例如SAM或BAM文件格式)表示。在多个实施方案中，误差校正训练样品中的训练序列读段包括具有与参考碱基相比发生错配的已知所关注碱基的序列读段。这些训练序列读段可源自已知在已知所关注碱基的位置具有遗传变体的单个细胞。The training module 250 uses the error-corrected training samples to train the error-corrected model. In various embodiments, the error-corrected training sample includes training sequence reads derived from a single cell. Such training samples can be represented in common file formats such as SAM or BAM file formats. In various embodiments, the training sequence reads in the error-corrected training sample include sequence reads with known bases of interest that are mismatched compared to the reference base. These training sequence reads can be derived from single cells known to have genetic variants at positions known to bases of interest. 在多个实施方案中，误差校正训练样品可使用指示存在于细胞中的遗传变体的已知碱基的参考基础事实来标记。在多个实施方案中，用于已知碱基的标记可为整数(例如0、1、2和3)，其中每一整数值指示用于已知碱基的核苷酸碱基(例如A、C、T或G中的一者)。在多个实施方案中，用于已知碱基的标记可结构化为向量(例如1×4矩阵，例如[0,0,0,1])。在此类实例中，矩阵中的每一细胞对应于四种核苷酸碱基中的一种。“0”值指示相应核苷酸碱基并非已知碱基，而“1”值指示相应核苷酸碱基为已知碱基。In various embodiments, error correction training samples can be labeled using reference ground truths indicative of known bases of genetic variants present in cells. In various embodiments, labels for known bases can be integers (eg, 0, 1, 2, and 3), where each integer value indicates a nucleotide base for known bases (eg, A , C, T or G). In various embodiments, labels for known bases can be structured as a vector (eg, a 1x4 matrix, eg, [0,0,0,1]). In such an example, each cell in the matrix corresponds to one of the four nucleotide bases. A value of '0' indicates that the corresponding nucleotide base is not a known base, while a value of '1' indicates that the corresponding nucleotide base is a known base. 在多个实施方案中，误差校正训练样品包括：1)源自具有所关注碱基的细胞的一个或多个训练序列读段，和2)指示已知碱基的标记。在多个实施方案中，训练模块250使用误差校正训练样品的一个或多个训练序列读段创建不同大小的训练堆积。因此，误差校正模型可使用源自训练样品的训练序列读段的堆积来以迭代方式训练。在训练迭代期间调整误差校正模型的参数，使得误差校正模型可更好地预测所关注碱基的概率分布。In various embodiments, the error-corrected training samples comprise: 1) one or more training sequence reads derived from cells having bases of interest, and 2) labels indicating known bases. In various embodiments, the training module 250 creates training stacks of different sizes using one or more training sequence reads of the error-corrected training samples. Thus, the error correction model can be trained iteratively using a stack of training sequence reads derived from the training samples. The parameters of the error correction model are adjusted during training iterations so that the error correction model can better predict the probability distribution of bases of interest. 在多个实施方案中，训练模块250训练变体调用程序模型。训练模块250可采用机器学习实施的方法来训练变体调用程序模型，例如线性回归算法、逻辑回归算法、决策树算法、支持向量机分类、朴素贝叶斯分类、K-最近邻分类、随机森林算法、深度学习算法、梯度提升算法和维数缩减技术(例如流形学习、主要组分分析、因子分析、自动编码器正则化和独立组分分析)中的任一者或其组合。在多个实施方案中，训练模块250采用监督学习算法、非监督学习算法、半监督学习算法(例如部分监督)、转移学习、多任务学习或其任一组合来训练变体调用程序模型。In various embodiments, the training module 250 trains the variant caller model. The training module 250 may employ machine learning implemented methods to train variant caller models, such as linear regression algorithms, logistic regression algorithms, decision tree algorithms, support vector machine classification, naive Bayes classification, K-nearest neighbor classification, random forests Any or a combination of algorithms, deep learning algorithms, gradient boosting algorithms, and dimensionality reduction techniques such as manifold learning, principal components analysis, factor analysis, autoencoder regularization, and independent component analysis. In various embodiments, the training module 250 employs supervised learning algorithms, unsupervised learning algorithms, semi-supervised learning algorithms (eg, partially supervised), transfer learning, multi-task learning, or any combination thereof to train the variant caller model. 训练模块250使用变体调用程序训练样品来训练变体调用程序模型。在多个实施方案中，变体调用程序训练样品包括训练序列读段，所述训练序列读段包括已知变体或已知参考碱基。在多个实施方案中，变体调用程序训练样品包括源自训练序列读段的细胞群体特征。The training module 250 uses the variant caller training samples to train the variant caller model. In various embodiments, variant caller training samples include training sequence reads that include known variants or known reference bases. In various embodiments, the variant caller training sample includes cell population characteristics derived from the training sequence reads. 变体调用程序训练样品可用指示变体分类的参考基础事实来标记。在一个实施方案中，参考基础事实区分真变体与假阳性变体。在一个实施方案中，参考基础事实区分不同真变体，例如纯合变体和异质变体。在一个实施方案中，参考基础事实区分纯合变体、杂合变体与参考碱基(例如非变体)。Variant caller training samples can be labeled with reference ground truths indicative of variant classification. In one embodiment, true variants are distinguished from false positive variants with reference to ground truth. In one embodiment, different true variants, eg, homozygous variants and heterozygous variants, are differentiated with reference to ground truth. In one embodiment, homozygous variants, heterozygous variants, and reference bases (eg, non-variants) are distinguished by reference to the ground truth. 在多个实施方案中，变体调用程序训练样品的标记先前可通过其它测序方法(例如批量测序方法)来确定和/或确认。在多个实施方案中，变体调用程序训练样品的标记先前可至少部分地基于存在于某些细胞系中的已知遗传变体来确定。在多个实施方案中，标记可为指示变体是真变体还是假阳性变体的二进制值(例如0或1值)。在一些实施方案中，根据变体调用程序模型经设计以预测的分类的数量，标记可为不同整数值(例如0、1、2、3等)。例如，对于预测纯合变体、杂合变体和参考碱基(例如非变体)的变体调用程序模型，标记可为三个整数值(例如0、1和2)，每一整数值对应于分类中的一者。In various embodiments, the markers of the variant calling program training samples can be previously determined and/or confirmed by other sequencing methods (eg, batch sequencing methods). In various embodiments, markers of variant calling program training samples can be previously determined based at least in part on known genetic variants present in certain cell lines. In various embodiments, the marker can be a binary value (eg, a 0 or 1 value) that indicates whether the variant is a true variant or a false positive variant. In some implementations, the markers can be different integer values (eg, 0, 1, 2, 3, etc.) depending on the number of classes the variant caller model is designed to predict. For example, for a variant caller model that predicts homozygous variants, heterozygous variants, and reference bases (eg, non-variants), the flags can be three integer values (eg, 0, 1, and 2), one for each integer value corresponds to one of the categories. 在多个实施方案中，每一变体调用程序训练样品包括：1)具有已知参考碱基或已知变体的细胞群体的训练序列读段，和2)指示对应于训练序列读段的已知参考碱基或已知变体的存在的标记。因此，变体调用程序模型可使用每一变体调用程序训练样品以迭代方式来训练。在多个实施方案中，在训练迭代期间调整变体调用程序模型的参数，使得变体调用程序模型可更好地预测细胞群体的序列读段是否具有参考碱基或真变体。In various embodiments, each variant caller training sample includes: 1) a training sequence read for a population of cells with known reference bases or known variants, and 2) a training sequence read indicating a corresponding training sequence read Labels for the presence of known reference bases or known variants. Thus, the variant caller model can be trained iteratively using each variant caller training sample. In various embodiments, parameters of the variant caller model are adjusted during training iterations such that the variant caller model can better predict whether sequence reads of a population of cells have reference bases or true variants. 用于调用细胞群体的变体的方法Methods for calling variants of cell populations 现参考图3A和图3B中所显示的流程图300和350，它们描述两步过程，所述两步过程涉及1)通过细胞特异性过程对序列读段中的碱基进行误差校正，和2)使用误差校正的序列读段在细胞群体中进行变体调用。Reference is now made to the flowcharts 300 and 350 shown in Figures 3A and 3B, which describe a two-step process involving 1) error correction of bases in sequence reads by a cell-specific process, and 2 ) using error-corrected sequence reads for variant calling in cell populations. 图3A是根据实施方案用于校正源自单细胞的序列读段的流程图300。在步骤305处，从细胞获得序列读段。在多个实施方案中，将来自一个细胞的序列读段与来自另一细胞的序列读段区分开(例如先前使用条码技术进行区分)。另外，此类序列读段可与参考基因组进行比对。3A is a flowchart 300 for correcting single cell-derived sequence reads, according to an embodiment. At step 305, sequence reads are obtained from the cells. In various embodiments, sequence reads from one cell are distinguished from sequence reads from another cell (eg, previously using barcode technology). Additionally, such sequence reads can be aligned to a reference genome. 在步骤310处，通过校正序列读段中的错误碱基来校正细胞的序列读段。步骤310是涉及步骤315、320和325的细胞特异性过程。在多个实施方案中，对于细胞群体的一个或多个细胞中的每一者，步骤315、320和325平行进行。在多个实施方案中，对于细胞群体的一个或多个细胞中的每一者，步骤315、320和325依序进行。总之，步骤315、320和325可对细胞群体的一个或多个细胞中的每一者生成校正的序列读段。At step 310, the sequence reads of the cell are corrected by correcting erroneous bases in the sequence reads. Step 310 is a cell-specific process involving steps 315, 320, and 325. In various embodiments, steps 315, 320 and 325 are performed in parallel for each of the one or more cells of the cell population. In various embodiments, steps 315, 320 and 325 are performed sequentially for each of the one or more cells of the cell population. Taken together, steps 315, 320, and 325 can generate corrected sequence reads for each of one or more cells of the cell population. 步骤315涉及鉴别来自细胞的序列读段的所关注碱基，所关注碱基不同于参考碱基。在多个实施方案中，鉴别所关注碱基涉及应用转换矩阵来确定碱基错配是否可能归因于误差。应用转移矩阵涉及比较转移矩阵的概率与反映观察到序列读段的一定比例的核苷酸碱基的可能性的概率。Step 315 involves identifying the bases of interest from the sequence reads from the cell that are different from the reference bases. In various embodiments, identifying bases of interest involves applying a transition matrix to determine whether base mismatches are likely due to errors. Applying a transition matrix involves comparing the transition matrix's probabilities to probabilities that reflect the likelihood of observing a certain proportion of the nucleotide bases of the sequence reads. 步骤320涉及应用误差校正模型来预测所关注碱基的概率。在多个实施方案中，误差校正模型分析源自对所关注碱基生成的堆积的单细胞特征并输出概率分布。Step 320 involves applying an error correction model to predict the probability of the base of interest. In various embodiments, the error correction model analyzes single-cell signatures derived from stacking generated for bases of interest and outputs a probability distribution. 步骤325涉及校正所关注碱基。在此处，所关注碱基被校正为对应于所预测概率的不同碱基。来自含有所关注碱基的细胞的一个或多个序列读段可被校正为不同碱基。Step 325 involves correcting the bases of interest. Here, the bases of interest are corrected to different bases corresponding to the predicted probabilities. One or more sequence reads from cells containing the bases of interest can be corrected to different bases. 图3B描绘根据实施方案使用校正的序列读段来调用细胞群体的变体的流程图350。在此处，在细胞群体水平上进行步骤355、360和365，由此使得能够调用细胞群体中的真变体。3B depicts a flow diagram 350 for calling variants of a cell population using corrected sequence reads, according to an embodiment. Here, steps 355, 360 and 365 are performed at the cell population level, thereby enabling calling of true variants in the cell population. 步骤355涉及从细胞群体中的校正的序列读段生成细胞群体特征。在多个实施方案中，步骤355涉及使用校正的序列读段对细胞群体中的候选变体生成细胞群体特征。步骤360涉及将变体调用程序模型应用于细胞群体特征。在多个实施方案中，候选变体的细胞群体特征作为输入应用于变体调用程序模型。变体调用程序模型可重复应用于不同候选变体以确定每一候选变体是否是可能的真变体。Step 355 involves generating cell population characteristics from the corrected sequence reads in the cell population. In various embodiments, step 355 involves generating cell population characteristics for candidate variants in the cell population using the corrected sequence reads. Step 360 involves applying the variant caller model to cell population characteristics. In various embodiments, cell population characteristics of candidate variants are applied as input to the variant caller model. The variant caller model can be applied repeatedly to different candidate variants to determine whether each candidate variant is a likely true variant. 在步骤365处，基于变体调用程序模型的输出，调用细胞群体中的一种或多种变体。在多个实施方案中，调用变体包括将候选变体调用为纯合变体、杂合变体或不确定变体中的一者。At step 365, one or more variants in the cell population are called based on the output of the variant caller model. In various embodiments, calling a variant includes calling a candidate variant as one of a homozygous variant, a heterozygous variant, or an indeterminate variant. 总之，通过流程图300和350鉴别的细胞群体的被调用变体代表超出使用常规变体调用程序管路的常规被调用变体的改良。因此，被调用变体可为多种应用提供信息，所述应用的实例包括表征异常细胞和/或疾病(例如癌症)。Taken together, the called variants of the cell populations identified by flow diagrams 300 and 350 represent improvements over conventional called variants using conventional variant caller pipelines. Thus, called variants can be informative for a variety of applications, examples of which include characterizing abnormal cells and/or diseases (eg, cancer). 误差校正模型和变体校正模型的实施方案Implementations of Error Correction Models and Variation Correction Models 在具体实施方案中，误差校正模型和变体校正模型是机器学习模型。误差校正模型和变体校正模型中的每一者可使用训练数据来训练。在训练后，可部署误差校正模型和变体校正模型(例如根据上文参考图3A和图3B所述的过程部署)。In particular embodiments, the error correction model and the variant correction model are machine learning models. Each of the error correction model and the variant correction model may be trained using training data. After training, the error correction model and the variant correction model may be deployed (eg, according to the process described above with reference to FIGS. 3A and 3B ). 在多个实施方案中，误差校正模型和变体校正模型中的一者或两者是以下中的任一者：回归模型(例如，线性回归、逻辑回归或多项式回归)、决策树、随机森林、支持向量机器、朴素贝叶斯模型、k-均值聚类或神经网络(例如，前馈网络、卷积神经网络(CNN)、深度神经网络(DNN)、自动编码器神经网络、生成对抗网络或递归网络(例如，长短期记忆网络(LSTM)、双向递归网络、深度双向递归网络)。In various embodiments, one or both of the error-corrected model and the variant-corrected model are any of the following: regression models (eg, linear regression, logistic regression, or polynomial regression), decision trees, random forests , Support Vector Machines, Naive Bayesian Models, K-Means Clustering, or Neural Networks (e.g., Feedforward Networks, Convolutional Neural Networks (CNN), Deep Neural Networks (DNN), Autoencoder Neural Networks, Generative Adversarial Networks Or recurrent networks (e.g. Long Short Term Memory (LSTM), Bidirectional Recurrent Networks, Deep Bidirectional Recurrent Networks). 在多个实施方案中，误差校正模型和变体校正模型中的一者或两者具有一个或多个参数，例如超参数或模型参数。超参数通常是在训练之前确立。超参数的实例包括学习速率、决策树的深度或叶子、深度神经网络中的隐藏层数、k-均值聚类中的聚类数、回归模型中的惩罚和与成本函数相关的正则化参数。通常在训练期间调整误差校正模型和变体校正模型中的一者或两者的模型参数。模型参数的实例包括与神经网络层中的节点相关的权重、支持向量机器中的支持向量和回归模型中的系数。使用训练数据训练(例如调整)机器学习模型的模型参数以改良机器学习模型的预测力。In various embodiments, one or both of the error correction model and the variant correction model have one or more parameters, eg, hyperparameters or model parameters. Hyperparameters are usually established before training. Examples of hyperparameters include learning rate, depth or leaves of decision trees, number of hidden layers in deep neural networks, number of clusters in k-means clustering, penalties in regression models, and regularization parameters related to cost functions. The model parameters of one or both of the error-corrected model and the variant-corrected model are typically adjusted during training. Examples of model parameters include weights associated with nodes in neural network layers, support vectors in support vector machines, and coefficients in regression models. Model parameters of the machine learning model are trained (eg, tuned) using the training data to improve the predictive power of the machine learning model. 在一些实施方案中，误差校正模型和变体校正模型中的一者或两者是参数模型，其中模型的一个或多个参数定义自变量与因变量之间的相依性。在多个实施方案中，参数型模型的各个参数经训练以最小化损失函数，训练通过基于梯度的数值优化算法(例如批量梯度算法、随机梯度算法等)进行。在一些实施方案中，误差校正模型和变体校正模型中的一者或两者是非参数模型，其中模型结构是根据训练数据确定且并不严格基于固定参数集。In some embodiments, one or both of the error-corrected model and the variant-corrected model are parametric models, wherein one or more parameters of the model define dependencies between independent variables and dependent variables. In various embodiments, the various parameters of the parametric model are trained to minimize the loss function by a gradient-based numerical optimization algorithm (eg, batch gradient algorithm, stochastic gradient algorithm, etc.). In some embodiments, one or both of the error-corrected model and the variant-corrected model are nonparametric models, wherein the model structure is determined from training data and is not strictly based on a fixed set of parameters. 图4A描绘根据实施方案的误差校正模型410的实施。在此实施方案中，误差校正模型410分析包括所关注碱基的堆积，其中堆积是从源自单细胞的序列读段生成。在多个实施方案中，误差校正模型410分析源自对所关注碱基生成的堆积的单细胞特征。单细胞特征是与所关注碱基相关的特征，包括所关注碱基周围的上下文序列、所关注碱基的测序深度、所关注碱基的等位基因频率和所关注碱基周围的窗口中的碱基的等位基因频率。基于单细胞特征，误差校正模型410输出代表所关注碱基是另一碱基的可能性的碱基概率(例如腺嘌呤、胸腺嘧啶、鸟嘌呤和胞嘧啶中的一者、两者、三者或四者的概率)的分布。FIG. 4A depicts the implementation of an error correction model 410 according to an embodiment. In this embodiment, the error correction model 410 analysis includes stacking of bases of interest, where the stacking is generated from sequence reads derived from single cells. In various embodiments, the error correction model 410 analyzes single-cell signatures derived from stacking generated for bases of interest. Single-cell signatures are those associated with the base of interest, including the context sequence around the base of interest, the sequencing depth of the base of interest, the allele frequency of the base of interest, and the number in the window around the base of interest. The allele frequency of the base. Based on the single-cell features, the error-corrected model 410 outputs base probabilities representing the likelihood that the base of interest is another base (eg, one, two, three of adenine, thymine, guanine, and cytosine). or the probability of the four). 在具体实施方案中，误差校正模型410是神经网络。在一些实施方案中，误差校正模型410是深度学习神经网络。误差校正模型410可被结构化有两个、三个、四个、五个、六个、七个、八个、九个或十个层。误差校正模型410的层包含一个或多个节点。层中的节点可连接到其它层的其它节点，节点之间的连接与参数相关。一个节点处的值可表示为连接到特定节点的节点值的组合，所述组合由与该特定节点相关的激活函数映射的相关参数加权。In particular embodiments, the error correction model 410 is a neural network. In some embodiments, the error correction model 410 is a deep learning neural network. Error correction model 410 may be structured with two, three, four, five, six, seven, eight, nine, or ten layers. The layers of the error correction model 410 contain one or more nodes. Nodes in a layer can be connected to other nodes in other layers, and the connections between nodes are related to parameters. A value at a node can be represented as a combination of node values connected to a particular node, weighted by the relevant parameters of the activation function map associated with that particular node. 图4B描绘根据实施方案的变体调用程序模型的实施。在图4B中所显示的实施方案中，变体调用程序模型420分析源自细胞群体的校正的序列读段的细胞群体特征。变体调用程序模型420输出变体的分类。在一些实施方案中，变体的分类是真变体或假阳性变体中的一者。在一些实施方案中，变体的分类是纯合变体或杂合变体中的一者。在一些实施方案中，变体的分类是纯合变体、杂合变体或不确定变体中的一者。4B depicts an implementation of a variant invoker model according to an embodiment. In the embodiment shown in Figure 4B, the variant caller model 420 analyzes the cell population characteristics of corrected sequence reads derived from the cell population. The variant caller model 420 outputs a classification of variants. In some embodiments, the classification of the variant is one of a true variant or a false positive variant. In some embodiments, the classification of the variant is one of a homozygous variant or a heterozygous variant. In some embodiments, the classification of the variant is one of a homozygous variant, a heterozygous variant, or an indeterminate variant. 在一些实施方案中，变体调用程序模型420接收序列读段或序列读段的堆积而非细胞群体特征作为输入。在此类实施方案中，在实施变体调用程序模型420之前，无需从聚集的读段提取细胞群体特征。在一些实施方案中，聚集的读段可被编译(例如在堆积中编译)且聚集的读段的堆积可作为输入提供到变体调用程序模型420来预测变体分类。例如，可为在误差校正后与参考碱基相比是错配的碱基编译聚集的读段的堆积。变体调用程序模型420分析对碱基生成的堆积并预测碱基的变体分类。In some embodiments, variant caller model 420 receives as input sequence reads or stacks of sequence reads rather than cell population characteristics. In such embodiments, cell population characteristics need not be extracted from the aggregated reads prior to implementing the variant caller model 420. In some embodiments, the aggregated reads may be compiled (eg, compiled in a stack) and the stack of aggregated reads may be provided as input to variant caller model 420 to predict variant classification. For example, a stack of aggregated reads can be compiled for bases that are mismatches compared to the reference base after error correction. The variant caller model 420 analyzes the stacking for base generation and predicts the variant classification of the base. 在具体实施方案中，变体调用程序模型420是神经网络。在一些实施方案中，变体调用程序模型420是深度学习神经网络。变体调用程序模型420可被结构化有两个、三个、四个、五个、六个、七个、八个、九个或十个层。变体调用程序模型420的层包含一个或多个节点。层中的节点可连接到其它层的其它节点，节点之间的连接与参数相关。一个节点处的值可表示为连接到特定节点的节点值的组合，所述组合由与该特定节点相关的激活函数映射的相关参数加权。In particular embodiments, variant caller model 420 is a neural network. In some embodiments, variant invoker model 420 is a deep learning neural network. The variant invoker model 420 may be structured with two, three, four, five, six, seven, eight, nine, or ten layers. The layers of variant invoker model 420 contain one or more nodes. Nodes in a layer can be connected to other nodes in other layers, and the connections between nodes are related to parameters. A value at a node can be represented as a combination of node values connected to a particular node, weighted by the relevant parameters of the activation function map associated with that particular node. 用于测序和读段比对的方法Methods for sequencing and read alignment 本文所公开本发明的实施方案涉及核酸的测序和序列读段与参考基因组的比对。在多个实施方案中，对核酸测序并比对序列读段与参考基因组的步骤是通过测序仪(例如细胞分析工作流装置120的测序仪)来进行，如上文参考图1所述。因此，经测序和比对的序列读段可通过碱基调用程序装置130来分析，且更具体来说可通过碱基鉴别模块210(参见图2)来分析以鉴别所关注碱基。Embodiments of the invention disclosed herein relate to the sequencing of nucleic acids and the alignment of sequence reads to a reference genome. In various embodiments, the steps of sequencing the nucleic acid and aligning the sequence reads to a reference genome are performed by a sequencer (eg, a sequencer of the cellular analysis workflow device 120 ), as described above with reference to FIG. 1 . Thus, the sequenced and aligned sequence reads can be analyzed by the basecaller device 130, and more particularly by the base identification module 210 (see Figure 2), to identify bases of interest. 序列读段可以通过可商购获得的下一代测序(NGS)平台来实现，所述NGS平台包括执行边合成边测序、边连接边测序、焦磷酸测序、使用可逆终止子化学测序、使用连接磷的荧光核苷酸测序或实时测序中的任一者的平台。例如，扩增的核酸可以在Illumina MiSeq平台上进行测序。Sequence reads can be achieved by commercially available next-generation sequencing (NGS) platforms that include performing sequencing by synthesis, sequencing by ligation, pyrosequencing, sequencing using reversible terminator chemistry, using ligation phosphorous. platform for either fluorescent nucleotide sequencing or real-time sequencing. For example, amplified nucleic acids can be sequenced on the Illumina MiSeq platform. 当进行焦磷酸测序时，将NGS片段的文库克隆，通过使用包被有与衔接子互补的寡核苷酸的颗粒捕获一个基质分子来原位扩增。每个含有相同类型基质的颗粒被放置在“油包水”类型的微气泡中，并且使用称为乳液PCR的方法克隆扩增基质。扩增后，乳液被破坏，并且颗粒被堆叠于在测序反应期间充当流动池的滴定微微板(picoplate)的单独孔中。在存在测序酶和发光报告剂诸如萤光素酶的情况下将四种dNTP试剂中的每一种有序地多次施用到流动池中。在将适宜dNTP添加到测序引物的3′端的情形下，所得ATP在孔内产生闪光，使用CCD照相机记录所述闪光。有可能实现大于或等于400个碱基的读段长度，并且有可能获得序列的106个读段，从而产生高达500百万个碱基对(兆字节)的序列。Voelkerding等人，Clinical Chem.,55:641-658,2009；MacLean等人，Nature Rev.Microbiol.,7:287-296；美国专利第6,210,891号；美国专利第6,258,568号描述关于焦磷酸测序的其它细节；所述文献中的每一者的全文以引用方式在此并入。When pyrosequencing is performed, a library of NGS fragments is cloned and amplified in situ by capturing a matrix molecule using particles coated with oligonucleotides complementary to the adaptor. Each particle containing the same type of matrix is placed in a 'water-in-oil' type microbubble, and the matrix is cloned and amplified using a method called emulsion PCR. After amplification, the emulsion is broken and the particles are stacked in individual wells of a titration picoplate that acts as a flow cell during the sequencing reaction. Each of the four dNTP reagents is applied to the flow cell multiple times in an orderly manner in the presence of a sequencing enzyme and a luminescent reporter such as luciferase. With the addition of an appropriate dNTP to the 3' end of the sequencing primer, the resulting ATP produces a flash within the well, which is recorded using a CCD camera. It is possible to achieve read lengths greater than or equal to 400 bases, and it is possible to obtain 106 reads of the sequence, resulting in sequences of up to 500 million base pairs (megabytes). Voelkerding et al., Clinical Chem., 55:641-658, 2009; MacLean et al., Nature Rev. Microbiol., 7:287-296; US Pat. No. 6,210,891; Details; the entire contents of each of these documents are hereby incorporated by reference. 在Solexa/Illumina平台上，以短读段的形式产生测序数据。在这种方法中，NGS片段文库的片段被捕获在包被有寡核苷酸锚定分子的流动池的表面上。将锚定分子用作PCR引物，但由于基质的长度和所述分子靠近其它邻近的锚定寡核苷酸，通过PCR延伸导致分子形成“拱顶”，其中所述分子与相邻锚定寡核苷酸杂交，并且在流动池表面上形成桥接结构。这些DNA环被变性和切割。然后使用可逆染色终止子对直链进行测序。所述序列中包含的核苷酸通过检测包含之后的荧光来确定，其中在下一个dNTP添加循环之前去除每个荧光剂和封闭剂。关于使用Illumina平台测序的其它细节参见Voelkerding等人，Clinical Chem.,55:641-658,2009；MacLean等人，Nature Rev.Microbiol.,7:287-296；美国专利第6,833,246号；美国专利第7,115,400号；美国专利第6,969,488号；所述文献中的每一者的全文以引用方式在此并入。On the Solexa/Illumina platform, sequencing data are generated in the form of short reads. In this method, fragments of an NGS fragment library are captured on the surface of a flow cell coated with oligonucleotide anchor molecules. An anchor molecule is used as a PCR primer, but due to the length of the matrix and the proximity of the molecule to other adjacent anchor oligonucleotides, extension by PCR results in the formation of a 'vault' of the molecule with adjacent anchor oligonucleotides. Nucleotides hybridize and bridge structures are formed on the flow cell surface. These DNA loops are denatured and cleaved. The straight chains were then sequenced using reversible dye terminators. The nucleotides contained in the sequence were determined by detecting the fluorescence after inclusion, where each fluorescer and blocking agent were removed prior to the next dNTP addition cycle. For additional details on sequencing using the Illumina platform see Voelkerding et al., Clinical Chem., 55:641-658, 2009; MacLean et al., Nature Rev. Microbiol., 7:287-296; US Patent No. 6,833,246; US Patent No. 7,115,400; US Patent No. 6,969,488; the entire contents of each of which are incorporated herein by reference. 使用SOLiD技术对核酸分子进行测序包括使用乳液PCR克隆扩增NGS片段文库。此后，将含有基质的颗粒固定在玻璃流动池的衍生化表面上，并且用与衔接寡核苷酸互补的引物退火。然而，使用它代替使用指示的引物进行3'延伸来获得5'磷酸基团用于连接含有两个探针特异性碱基和随后6个简并碱基和四种荧光标记中的一者的测试探针。在SOLiD系统中，测试探针具有在每个探针的3'端的两个碱基和在5'端的四种荧光染料中的一者的16种可能的组合。荧光染料的颜色和因此每个探针的属性对应于某一颜色空间编码方案。在探针比对、探针连接和荧光信号检测的多个循环后，在变性后使用与原始引物相比移位一个碱基的引物进行第二个测序循环。以这种方式，可以通过计算重构矩阵的序列；对矩阵碱基检查两次，这导致准确性增加。关于使用SOLiD技术测序的其它细节参见Voelkerding等人，Clinical Chem.,55:641-658,2009；MacLean等人，Nature Rev.Microbiol.,7:287-296；美国专利第5,912,148号；美国专利第6,130,073号；所述文献中的每一者的全文以引用方式并入。Sequencing nucleic acid molecules using SOLiD technology involves cloning an NGS fragment library using emulsion PCR. Thereafter, the matrix-containing particles were immobilized on the derivatized surface of a glass flow cell and annealed with primers complementary to adapter oligonucleotides. However, it was used instead of 3' extension using the indicated primers to obtain a 5' phosphate group for ligation containing two probe-specific bases followed by 6 degenerate bases and one of the four fluorescent labels Test probe. In the SOLiD system, test probes have 16 possible combinations of two bases at the 3' end of each probe and one of four fluorescent dyes at the 5' end. The colors of the fluorescent dyes and thus the properties of each probe correspond to a certain color space encoding scheme. After multiple cycles of probe alignment, probe ligation, and fluorescent signal detection, a second cycle of sequencing was performed with primers shifted by one base compared to the original primers after denaturation. In this way, the sequence of the matrix can be reconstructed by computation; the matrix is base checked twice, which results in increased accuracy. For additional details on sequencing using SOLiD technology see Voelkerding et al., Clinical Chem., 55:641-658, 2009; MacLean et al., Nature Rev. Microbiol., 7:287-296; US Patent No. 5,912,148; US Patent No. 6,130,073; the entire contents of each of these documents are incorporated by reference. 在特定的实施方案中，使用来自Helicos BioSciences的HeliScope。通过添加聚合酶和连续添加荧光标记的dNTP试剂来实现测序。接通导致出现对应于dNTP的荧光信号，并且在每个dNTP添加循环之前，CCD照相机捕获到指定的信号。序列的读段长度从25-50个核苷酸变化，其中每个分析工作周期的总产量超过10亿个核苷酸对。关于使用HeliScope进行测序的其它细节参见Voelkerding等人，Clinical Chem.,55:641-658,2009；MacLean等人，Nature Rev.Microbiol.,7:287-296；美国专利第7,169,560号；美国专利第7,282,337号；美国专利第7,482,120号；美国专利第7,501,245号；美国专利第6,818,395号；美国专利第6,911,345号；美国专利第7,501,245号；所述文献中的每一者的全文以引用方式并入。In a specific embodiment, the HeliScope from Helicos BioSciences is used. Sequencing is achieved by addition of polymerase and sequential addition of fluorescently labeled dNTP reagents. Switching on resulted in the appearance of a fluorescent signal corresponding to the dNTPs, and before each dNTP addition cycle, the designated signal was captured by the CCD camera. The read lengths of the sequences varied from 25-50 nucleotides, with a total yield of over 1 billion nucleotide pairs per analysis cycle. For additional details on sequencing using HeliScope see Voelkerding et al., Clinical Chem., 55:641-658, 2009; MacLean et al., Nature Rev. Microbiol., 7:287-296; US Patent No. 7,169,560; US Patent No. US Patent No. 7,282,337; US Patent No. 7,482,120; US Patent No. 7,501,245; US Patent No. 6,818,395; US Patent No. 6,911,345; 在一些实施方案中，使用Roche测序系统454。测序454涉及两个步骤。在第一步骤中，将DNA切割成约300-800个碱基对的片段，并且这些片段具有钝端。然后将寡核苷酸衔接子连接到片段的末端。衔接子作为引物用于片段的扩增和测序。片段可例如使用含有5'-生物素标签的衔接子连接到DNA捕获珠粒，例如链霉亲和素包被的珠粒。在油-水乳液的液滴内通过PCR扩增连接到颗粒的片段。结果是克隆扩增的DNA片段在每个珠粒上有多个拷贝。在第二阶段，颗粒被捕获到孔中(体积为几皮升)。平行地对每个DNA片段进行焦磷酸测序。添加一个或多个核苷酸可生成光信号，它被记录在测序仪器的CCD照相机上。信号强度与所纳入的核苷酸数量成比例。焦磷酸测序使用焦磷酸(PPi)，其在添加核苷酸时被释放。在腺苷5'磷酸硫酸酯存在下，使用ATP硫酸化酶将PPi转化成ATP。萤光素酶使用ATP将萤光素转化为氧化萤光素，并且作为这种反应的结果，产生进行检测和分析的光。关于进行测序454的其它细节参见Margulies等人(2005)Nature 437:376-380，所述文献的全文以引用方式在此并入。In some embodiments, the Roche sequencing system 454 is used. Sequencing 454 involves two steps. In the first step, the DNA is cleaved into fragments of approximately 300-800 base pairs, and these fragments have blunt ends. Oligonucleotide adapters are then ligated to the ends of the fragments. Adapters serve as primers for fragment amplification and sequencing. Fragments can be ligated to DNA capture beads, such as streptavidin-coated beads, eg, using an adaptor containing a 5'-biotin tag. The fragments attached to the particles were amplified by PCR within the droplets of the oil-water emulsion. The result is multiple copies of clonally amplified DNA fragments on each bead. In the second stage, the particles are trapped in the pores (volumes of several picoliters). Pyrosequencing was performed on each DNA fragment in parallel. The addition of one or more nucleotides generates a light signal, which is recorded on the sequencing instrument's CCD camera. The signal intensity is proportional to the number of nucleotides incorporated. Pyrosequencing uses pyrophosphate (PPi), which is released when nucleotides are added. PPi is converted to ATP using ATP sulfurylase in the presence of adenosine 5' phosphate sulfate. Luciferase uses ATP to convert luciferin to oxyluciferin and, as a result of this reaction, produces light for detection and analysis. For additional details on performing sequencing 454 see Margulies et al. (2005) Nature 437:376-380, which is hereby incorporated by reference in its entirety. 离子激流技术是一种基于检测DNA聚合期间释放的氢离子的DNA测序方法。微孔含有待测序的NGS片段文库的片段。微孔层下是超灵敏离子传感器ISFET。所有层都包含在半导体CMOS芯片内，类似于电子工业中使用的芯片。当将dNTP纳入不断增长的互补链中时，释放出激发超灵敏离子传感器的氢离子。如果模板序列中存在均聚物重复，那么在一个循环中将包含多个dNTP分子。这导致对应量的氢原子被释放，并且与更高的电信号成比例。此技术不同于其他不使用修饰的核苷酸或光学装置的测序技术。关于离子洪流技术的其它细节参见Science 327(5970):1190(2010)；美国专利申请公开第20090026082号、美国专利申请公开第20090127589号、美国专利申请公开第20100301398号、美国专利申请公开第20100197507号、美国专利申请公开第20100188073号和美国专利申请公开第20100137143号，所述文献中的每一者的全文以引用方式并入。Ion torrent technology is a DNA sequencing method based on the detection of hydrogen ions released during DNA polymerization. The wells contain the fragments of the NGS fragment library to be sequenced. Beneath the microporous layer is an ultrasensitive ion sensor ISFET. All layers are contained within a semiconductor CMOS chip, similar to those used in the electronics industry. When dNTPs are incorporated into the growing complementary strand, hydrogen ions are released that excite ultrasensitive ion sensors. If homopolymer repeats are present in the template sequence, then multiple dNTP molecules will be included in one cycle. This results in a corresponding amount of hydrogen atoms being released, proportional to the higher electrical signal. This technique differs from other sequencing techniques that do not use modified nucleotides or optical devices. See Science 327(5970):1190(2010) for additional details on ion flooding techniques; US Patent Application Publication No. 20090026082, US Patent Application Publication No. 20090127589, US Patent Application Publication No. 20100301398, US Patent Application Publication No. 20100197507 , US Patent Application Publication No. 20100188073, and US Patent Application Publication No. 20100137143, each of which is incorporated by reference in its entirety. 在多个实施方案中，从NGS方法获得的测序读段可通过质量进行过滤且根据条码序列使用本领域已知的任何算法(例如Python脚本barcodeCleanup.py)分组。在一些实施方案中，如果给定测序读段的超过约20％的碱基具有小于Q20的质量评分(Q-评分)，此表明碱基调用准确性小于约99％，那么可丢弃给定测序读段。在一些实施方案中，如果超过约5％、约10％、约15％、约20％、约25％、约30％具有小于Q10、Q20、Q30、Q40、Q50、Q60或更大的Q-评分，此分别表明碱基调用准确性小于约90％、小于约99％、小于约99.9％、小于约99.99％、小于约99.999％、小于约99.9999％或更大，那么可丢弃给定测序读段。In various embodiments, sequencing reads obtained from NGS methods can be filtered by quality and grouped according to barcode sequence using any algorithm known in the art (eg, the Python script barcodeCleanup.py). In some embodiments, a given sequencing may be discarded if more than about 20% of the bases of a given sequencing read have a quality score (Q-score) less than Q20, indicating that the base calling accuracy is less than about 99% Read paragraphs. In some embodiments, if more than about 5%, about 10%, about 15%, about 20%, about 25%, about 30% have a Q- score, which respectively indicates that the base calling accuracy is less than about 90%, less than about 99%, less than about 99.9%, less than about 99.99%, less than about 99.999%, less than about 99.9999% or greater, then a given sequencing read can be discarded part. 在一些实施方案中，可以丢弃与含有少于50个读段的条形码相关联的所有测序读段，以确保表示单细胞的所有条形码组含有足够数量的高质量读段。在一些实施方案中，可丢弃与含有少于30个、少于40个、少于50个、少于60个、少于70个、少于80个、少于90个、少于100个或更多个读段的条码相关的所有测序读段以确保代表单细胞的条码组的质量。In some embodiments, all sequencing reads associated with barcodes containing fewer than 50 reads can be discarded to ensure that all barcode sets representing single cells contain a sufficient number of high quality reads. In some embodiments, can be discarded with less than 30, less than 40, less than 50, less than 60, less than 70, less than 80, less than 90, less than 100 or All sequenced reads were correlated with barcodes of more reads to ensure the quality of barcode sets representing single cells. 具有共有条形码序列的序列读段(例如，意味着序列读段源自同一细胞)可以使用本领域已知的方法与参考基因组比对以确定比对位置信息。比对位置信息可以指示参考基因组中与给定序列读段的开始核苷酸碱基和结束核苷酸碱基对应的区域的开始位置和结束位置。参考基因组中的区域可与靶基因或基因区段相关。示例性比对器算法包括BWA、Bowtie、与参考序列的拼接转录物比对(STAR)、Tophat或HISAT2。关于比对序列读段与参考序列的其它细节描述于美国申请第16/279,315号中，所述美国申请的全文以引用方式在此并入。在多个实施方案中，可生成并输出具有SAM(序列比对图)格式或BAM(二进制比对图)格式的输出文件，用于后续分析。Sequence reads having a consensus barcode sequence (eg, meaning that the sequence reads are derived from the same cell) can be aligned to a reference genome using methods known in the art to determine alignment position information. The alignment position information can indicate the start and end positions of a region in the reference genome that corresponds to the start and end nucleotide bases of a given sequence read. Regions in the reference genome can be associated with target genes or gene segments. Exemplary aligner algorithms include BWA, Bowtie, Spliced Transcript Alignment to Reference Sequence (STAR), Tophat, or HISAT2. Additional details regarding aligning sequence reads with reference sequences are described in US Application No. 16/279,315, which is incorporated herein by reference in its entirety. In various embodiments, output files in SAM (Sequence Alignment Map) format or BAM (Binary Alignment Map) format can be generated and output for subsequent analysis. 系统和/或计算机实施方案System and/or Computer Implementation 本文所述的实施方案还涉及用于进行上文所述的变体调用方法的示例性系统和计算机实施方案。后续描述涉及细胞分析工作流装置120和碱基调用程序装置130，如上文参考图1所述。Embodiments described herein also relate to exemplary system and computer embodiments for performing the variant calling methods described above. Subsequent descriptions relate to cell analysis workflow device 120 and basecaller device 130, as described above with reference to FIG. 1 . 在多个实施方案中，细胞分析工作流装置120包括至少微流体装置，它经配置以用试剂囊封细胞、用反应混合物囊封细胞裂解物并进行核酸扩增反应。例如，微流体装置可以包括流体地连接的一个或多个流体通道。因此，通过第一通道的水性流体和通过第二通道的载体流体的组合可生成乳液液滴。在各种实施方案中，微流体装置的流体通道可以具有毫米或更小量级(例如，小于或等于约1毫米)的至少一个横截面尺寸。微通道设计和尺寸的其它细节描述于国际专利申请第PCT/US2016/016444号和美国专利申请第14/420,646号，所述专利申请中的每一者的全文以引用方式并入。微流体装置的一个实例是TapestriTM平台。In various embodiments, cell analysis workflow device 120 includes at least a microfluidic device configured to encapsulate cells with reagents, encapsulate cell lysates with reaction mixtures, and perform nucleic acid amplification reactions. For example, a microfluidic device can include one or more fluidic channels that are fluidly connected. Thus, the combination of the aqueous fluid passing through the first channel and the carrier fluid passing through the second channel can generate emulsion droplets. In various embodiments, the fluidic channels of the microfluidic device can have at least one cross-sectional dimension on the order of millimeters or less (eg, less than or equal to about 1 millimeter). Additional details of microchannel design and dimensions are described in International Patent Application No. PCT/US2016/016444 and US Patent Application No. 14/420,646, each of which is incorporated by reference in its entirety. An example of a microfluidic device is the Tapestri ™ platform. 在多个实施方案中，细胞分析工作流装置120还可包括以下中的一者或多者：(a)温度控制模块，用于控制主题装置的一个或多个部分和/或其中的液滴的温度且可操作地连接到微流体装置，(b)可操作地连接到微流体装置的检测模块，即检测器，例如光学成像仪，(c)可操作地连接到微流体装置的培育器，例如细胞培育器，和(d)可操作地连接到微流体装置的测序仪。一个或多个温度和/或压力控制模块提供对装置的一个或多个流动通道中的载体流体的温度和/或压力的控制。作为实例，温度控制模块可以是调节用于执行核酸扩增的温度的一个或多个热循环仪。一个或多个检测模块(即检测器，例如光学成像仪)经配置以检测一个或多个液滴的存在或其一个或多个特性，包括它们的组成。在一些实施方案中，检测模块经配置以识别一个或多个流动通道中的一个或多个液滴的一种或多种组分。所述测序仪是被配置成执行测序(诸如下一代测序)的硬件装置。测序仪的实例包括Illumina测序仪(例如，MiniSeqTM、MiSeqTM、NextSeqTM 550 Series或NextSeqTM 2000)、Roche测序系统454和Thermo Fisher科学测序仪(例如Ion GeneStudio S5系统、IonTorrent Genexus系统)。In various embodiments, the cellular analysis workflow device 120 may also include one or more of the following: (a) a temperature control module for controlling one or more portions of the subject device and/or droplets therein temperature and is operably connected to the microfluidic device, (b) a detection module operably connected to the microfluidic device, i.e. a detector, such as an optical imager, (c) an incubator operably connected to the microfluidic device , such as a cell incubator, and (d) a sequencer operably connected to the microfluidic device. One or more temperature and/or pressure control modules provide control of the temperature and/or pressure of the carrier fluid in one or more flow channels of the device. As an example, a temperature control module may be one or more thermal cyclers that regulate the temperature used to perform nucleic acid amplification. One or more detection modules (ie, detectors, eg, optical imagers) are configured to detect the presence of one or more droplets or one or more properties thereof, including their composition. In some embodiments, the detection module is configured to identify one or more components of one or more droplets in one or more flow channels. The sequencer is a hardware device configured to perform sequencing, such as next-generation sequencing. Examples of sequencers include Illumina sequencers (eg, MiniSeq ™ , MiSeq ™ , NextSeq ™ 550 Series, or NextSeq ™ 2000), Roche Sequencing System 454, and Thermo Fisher Scientific Sequencers (eg, Ion GeneStudio S5 System, IonTorrent Genexus System). 图5描绘用于实施参考图1-4描述的系统和方法的示例性计算装置。在多个实施方案中，示例性计算装置500用作图1中所述的碱基调用程序装置130用于进行误差校正和调用变体。计算装置的实例可以包括个人计算机、台式计算机、膝上型计算机、服务器计算机、集群内的计算节点、信息处理器、手持装置、多处理器系统、基于微处理器或可编程的消费者电子装置、网络PC、小型计算机、主机计算机、移动电话、PDA、平板电脑、传呼机、路由器、交换机等。5 depicts an exemplary computing device for implementing the systems and methods described with reference to FIGS. 1-4. In various embodiments, the exemplary computing device 500 is used as the basecaller device 130 described in FIG. 1 for error correction and calling variants. Examples of computing devices may include personal computers, desktop computers, laptop computers, server computers, computing nodes within a cluster, information processors, handheld devices, multi-processor systems, microprocessor-based or programmable consumer electronics devices , network PC, minicomputer, mainframe computer, mobile phone, PDA, tablet computer, pager, router, switch, etc. 如图5中所显示，在一些实施方案中，计算装置500包括耦接到芯片组504的至少一个处理器502。芯片组504包括存储器控制器集线器520和输入/输出(I/O)控制器集线器522。存储器506和图形适配器512耦接到存储器控制器集线器520，且显示器518耦接到图形适配器512。存储装置508、输入接口514和网络适配器516耦接到I/O控制器集线器522。计算装置500的其他实施方案具有不同的架构。As shown in FIG. 5 , in some implementations, computing device 500 includes at least one processor 502 coupled to chipset 504 . Chipset 504 includes memory controller hub 520 and input/output (I/O) controller hub 522 . Memory 506 and graphics adapter 512 are coupled to memory controller hub 520 , and display 518 is coupled to graphics adapter 512 . Storage device 508 , input interface 514 and network adapter 516 are coupled to I/O controller hub 522 . Other implementations of computing device 500 have different architectures. 存储装置508是非暂时性计算机可读存储介质，例如硬盘驱动器、光盘只读存储器(CD-ROM)、DVD或固态存储器装置。存储器506保存处理器502使用的指令和数据。输入接口514是触摸屏接口、鼠标、轨迹球或其它类型的输入接口、键盘或其某种组合，并且用于将数据输入到计算装置500中。在一些实施方案中，计算装置500可经配置以经由用户的手势从输入接口514接收输入(例如命令)。图形适配器512在显示器518上显示图像和其它信息。网络适配器516将计算装置500耦接到一个或多个计算机网络。The storage device 508 is a non-transitory computer-readable storage medium, such as a hard drive, a compact disk read only memory (CD-ROM), a DVD, or a solid state memory device. Memory 506 holds instructions and data used by processor 502 . Input interface 514 is a touch screen interface, mouse, trackball or other type of input interface, keyboard, or some combination thereof, and is used to enter data into computing device 500 . In some implementations, computing device 500 may be configured to receive input (eg, commands) from input interface 514 via a user's gesture. Graphics adapter 512 displays images and other information on display 518 . Network adapter 516 couples computing device 500 to one or more computer networks. 计算装置500被调适来执行用于提供本文描述的功能的计算机程序模块。如本文中所使用，术语“模块”是指用于提供指定功能的计算机程序逻辑。因此，模块可以在硬件、固件和/或软件中实施。在一个实施方案中，程序模块存储在存储装置508上，加载到存储器506中，并由处理器502执行。Computing device 500 is adapted to execute computer program modules for providing the functions described herein. As used herein, the term 'module' refers to computer program logic for providing specified functionality. Thus, a module may be implemented in hardware, firmware and/or software. In one embodiment, program modules are stored on storage device 508 , loaded into memory 506 , and executed by processor 502 . 计算装置500的类型可以不同于本文所述的实施方案。例如，计算装置500可缺少上述组件中的一些，例如图形适配器512、输入接口514和显示器518。在一些实施方案中，计算装置500可包括用于执行存储在存储器506上的指令的处理器502。The type of computing device 500 may vary from the embodiments described herein. For example, computing device 500 may lack some of the above-described components, such as graphics adapter 512 , input interface 514 , and display 518 . In some implementations, computing device 500 may include a processor 502 for executing instructions stored on memory 506 . 进行碱基误差校正和变体调用的方法可在硬件或软件或二者的组合中实施。在一个实施方案中，提供非暂时性机器可读存储介质，例如上文所述的非暂时性机器可读存储介质，所述介质包括用机器可读数据编码的数据存储材料，当使用被编程有使用所述数据的指令的机器时，所述数据存储材料能够执行用于进行本文所公开的碱基误差校正和变体调用方法的指令。上文所述的方法的实施方案可以在可编程计算机上执行的计算机程序中实现，所述可编程计算机包括处理器、数据存储系统(包括易失性和非易失性存储器和/或存储元件)、图形适配器、输入接口、网络适配器、至少一个输入装置和至少一个输出装置。显示器耦接至图形适配器。程序代码被应用于输入数据以执行上文所述的功能并生成输出信息。以已知方式将输出信息应用于一个或多个输出装置。计算机可为例如常规设计的个人计算机、微型计算机或工作站。Methods for base error correction and variant calling can be implemented in hardware or software or a combination of both. In one embodiment, a non-transitory machine-readable storage medium, such as the non-transitory machine-readable storage medium described above is provided, the medium comprising data storage material encoded with machine-readable data, when programmed using The data storage material is capable of executing the instructions for performing the base error correction and variant calling methods disclosed herein when there is a machine with instructions to use the data. Embodiments of the methods described above can be implemented in a computer program executing on a programmable computer including a processor, a data storage system (including volatile and nonvolatile memory and/or storage elements) ), a graphics adapter, an input interface, a network adapter, at least one input device, and at least one output device. The display is coupled to the graphics adapter. Program code is applied to input data to perform the functions described above and generate output information. The output information is applied to one or more output devices in a known manner. The computer may be, for example, a conventionally designed personal computer, minicomputer or workstation. 每个程序可用高级程序或面向对象的程序化语言来实施以与计算机系统通信。然而，若需要，程序可以汇编或机器语言来实施。在任一情形下，语言都可为编译的或解释的语言。每个这样的计算机程序优选地存储在可由通用或专用目的可程序化计算机读取的存储介质或装置(例如ROM或磁盘)上，用于当计算机读取存储介质或装置以执行本文所述的程序时配置并操作计算机。所述系统还可视为作为配置有计算机程序的计算机可读存储介质来实施，其中如此配置的存储介质使计算机以特定和预定义的方式操作以执行本文所述的功能。Each program may be implemented in a high-level programming or object-oriented programming language to communicate with a computer system. However, the programs may be implemented in assembly or machine language, if desired. In either case, the language can be a compiled or interpreted language. Each such computer program is preferably stored on a storage medium or device readable by a general or special purpose programmable computer, such as a ROM or magnetic disk, for when the computer reads the storage medium or device to perform the operations described herein Configure and operate the computer during the program. The system can also be considered to be implemented as a computer-readable storage medium configured with a computer program, wherein the storage medium so configured causes a computer to operate in a specific and predefined manner to perform the functions described herein. 可在多种介质中提供签名模式和其数据库以便于它们的使用。“介质”是指含有本发明的签名模式信息的制品。本发明的数据库可记录在计算机可读介质(例如计算机可直接读取和访问的任何介质)上。此类介质包括(但不限于)：磁性存储介质，例如软盘、硬盘存储介质和磁带；光存储介质，例如CD-ROM；电存储介质，例如RAM和ROM；以及这些类别的混合体，例如磁/光存储介质。本领域技术人员可容易地了解如何使用当前已知任一计算机可读介质来创建包含当前数据库信息记录的制品。“记录的”是指使用如本领域中已知的任何此类方法在计算机可读介质上存储信息的过程。基于用于访问所存储信息的手段，可选择任何方便的数据存储结构。可以使用多种数据处理器程序和格式进行存储，例如文字处理文本文件、数据库格式等。Signature schemas and their databases are provided in a variety of media to facilitate their use. 'Medium' refers to an article of manufacture containing the signature schema information of the present invention. The database of the present invention may be recorded on a computer-readable medium (eg, any medium that can be directly read and accessed by a computer). Such media include, but are not limited to: magnetic storage media, such as floppy disks, hard disk storage media, and magnetic tape; optical storage media, such as CD-ROM; electrical storage media, such as RAM and ROM; and hybrids of these classes, such as magnetic / Optical storage media. Those skilled in the art can readily understand how to use any currently known computer readable medium to create an article of manufacture containing the current database information records. 'Recorded' refers to the process of storing information on a computer-readable medium using any such method as known in the art. Any convenient data storage structure may be chosen based on the means used to access the stored information. Storage can be performed using a variety of data processor programs and formats, such as word processing text files, database formats, and the like. 实施例Example 实施例1：在应用误差校正模型之前，在序列读段中观察到的碱基误差Example 1: Base errors observed in sequence reads before applying error correction models 图6描绘碱基误差的示例性分布，其中大部分碱基误差仅在一种细胞中观察到。图6中量化的误差是指在未应用误差校正模型的情况下存在于序列读段中的误差。Figure 6 depicts an exemplary distribution of base errors, where the majority of base errors are observed in only one type of cell. The errors quantified in Figure 6 refer to the errors that exist in the sequence reads without applying the error correction model. 数据是从细胞系样品内部生成，通过TapestriTM运行，并使用TapestriTM标准管路分析。获得每个细胞的误差(错配)且计算细胞中误差的频率以生成该图。具体来说，仅在1个细胞中观察到序列读段中的大多数误差，在多于1个细胞中观察到有限数量的序列读段误差。此表明对单个细胞中的序列读段进行校正可减少被错误地鉴别为与参考碱基相关的匹配碱基或错配碱基的误差(例如假阳性和/或假阴性)数量。换句话说，如果源自细胞的序列读段的碱基被确定为误差，那么源自相同细胞的其它序列读段的相同碱基更可能是误差。因此，进行单个细胞的序列读段的细胞特异性误差校正比常规方法(例如通过批量处理获得的误差校正读段)更准确和/或快速。Data were generated in-house from cell line samples, run through Tapestri ™ , and analyzed using Tapestri ™ standard tubing. The error (mismatch) for each cell was obtained and the frequency of the error in the cell was calculated to generate the graph. Specifically, most errors in sequence reads were observed in only 1 cell, and a limited number of sequence read errors were observed in more than 1 cell. This suggests that correcting sequence reads in a single cell can reduce the number of errors (eg, false positives and/or false negatives) that are erroneously identified as matched bases or mismatched bases relative to the reference base. In other words, if a base of a sequence read derived from a cell is determined to be an error, then the same base of other sequence reads derived from the same cell is more likely to be an error. Thus, performing cell-specific error correction of sequence reads from individual cells is more accurate and/or faster than conventional methods (eg, error-corrected reads obtained by batch processing). 实施例2：实施误差校正模型的示例性方法Example 2: Exemplary Method of Implementing Error Correction Models 通常，下文关于图7-10描述的用于实施误差校正模型的示例性方法是指对源自单个细胞的序列读段中的碱基进行误差校正。In general, the exemplary methods described below with respect to Figures 7-10 for implementing error correction models refer to error correction of bases in sequence reads derived from a single cell. 对样品生成转换矩阵，例如图7中所显示的转换矩阵。通过量化样品的400万个读段的已知碱基来生成转换矩阵的概率，将这些读段与参考基因组进行比对。对于已知参考碱基(例如腺嘌呤、胸腺嘧啶、鸟嘌呤或胞嘧啶的已知参考碱基)，测定4百万个探针中4种核苷酸碱基中的每一者的观察量，以生成转换矩阵的相对概率。A transformation matrix, such as the one shown in Figure 7, is generated for the sample. The transition matrix was generated by quantifying the probabilities of known bases for 4 million reads of the sample, which were aligned to the reference genome. For a known reference base (eg, known reference bases for adenine, thymine, guanine, or cytosine), the amount of observations for each of the 4 nucleotide bases in 4 million probes was determined , to generate the relative probabilities of the transition matrix. 鉴别细胞序列读段中的错配碱基。对于每个碱基，计算多项式概率，所述多项式概率反映在序列读段的所述位置观察到所述比例的替代碱基(例如，不同于参考碱基的3种核苷酸碱基中的任一者)的可能性。具体来说，根据以下公式计算位置的多项式概率：Identify mismatched bases in cellular sequence reads. For each base, calculate a polynomial probability reflecting that the proportion of surrogate bases (eg, of 3 nucleotide bases different from the reference base) were observed at the position of the sequence read either) possibility. Specifically, the polynomial probability of the position is calculated according to the following formula: P(碱基1＝X，碱基2＝Y，碱基3＝Z|N读段)P (base 1=X, base 2=Y, base 3=Z|N read) 其中碱基1、碱基2和碱基3是指与参考碱基不匹配的核苷酸碱基，其中X是在该位置观察到的具有碱基1的序列读段的数量，其中Y是在该位置观察到的具有碱基2的序列读段的数量，其中Z是在该位置观察到的具有碱基3的序列读段的数量，且其中N是在该位置观察到的序列读段的总数量。where base 1, base 2, and base 3 refer to nucleotide bases that do not match the reference base, where X is the number of observed sequence reads with base 1 at that position, and where Y is The number of observed sequence reads with base 2 at that position, where Z is the number of observed sequence reads with base 3 at that position, and where N is the observed sequence read at that position total number of . 比较碱基的多项式概率与转换矩阵的转换概率。转换概率反映从参考核苷酸碱基转换成观察到的核苷酸碱基的可能性。如果多项式概率大于转换矩阵的转换概率，那么将碱基鉴别为所关注碱基。如果多项式概率小于转变矩阵的转变概率，那么不将碱基鉴别为所关注碱基。Compare the polynomial probability of the base with the transition probability of the transition matrix. The transition probability reflects the probability of transitioning from a reference nucleotide base to an observed nucleotide base. If the polynomial probability is greater than the transition probability of the transition matrix, then the base is identified as the base of interest. If the polynomial probability is less than the transition probability of the transition matrix, then the base is not identified as a base of interest. 为每一所关注碱基创建堆积。图8A和图8B是不同位置的6个序列读段的堆积的示例性描绘。图8A和图8B各自描绘示例性位置0-14(顶行)。图8A进一步鉴别每个相应位置(第二行)的参考碱基以及六个比对序列读段中每一者的碱基。图8B描绘在六个序列读段中已量化的每个碱基的概率。本领域技术人员可容易地理解，基因组中的额外位置(例如数千或数百万个位置)、额外参考碱基(例如数千或数百万个参考碱基)和额外序列读段碱基(例如数千或数百万个额外序列读段)可包括在示例性堆积中。A stack is created for each base of interest. 8A and 8B are exemplary depictions of the stacking of 6 sequence reads at different positions. 8A and 8B each depict exemplary positions 0-14 (top row). Figure 8A further identifies the reference base for each corresponding position (second row) and the base for each of the six aligned sequence reads. Figure 8B depicts the quantified probability of each base in the six sequence reads. Those skilled in the art will readily appreciate that additional positions in the genome (eg, thousands or millions of positions), additional reference bases (eg, thousands or millions of reference bases), and additional sequence read bases (eg, thousands or millions of additional sequence reads) can be included in an exemplary stack. 在此处，对与参考碱基相比发生错配的所关注碱基生成实例性堆积。具体来说，对位置7生成实例性堆积。参考碱基指示位置7的胞嘧啶碱基，但6个序列读段中的5个(83％)包括错配的鸟嘌呤碱基。Here, exemplary stacks are generated for bases of interest that are mismatched compared to the reference base. Specifically, an example stackup is generated for location 7. The reference base indicated the cytosine base at position 7, but 5 of the 6 sequence reads (83%) included mismatched guanine bases. 图9A描绘误差校正模型的示例性输入和输出。在此实施例中，堆积(例如图8B中所显示的堆积)作为输入提供到误差校正模型来校正所关注碱基。在此处，误差校正模型是深度学习神经网络(DNN)。使用若干不同的超参数优化误差校正模型以鉴别每一超参数的最佳值。超参数包括(但不限于)核正则化系数、学习速率、层数、激活函数和优化器。9A depicts exemplary inputs and outputs of an error correction model. In this embodiment, stacking, such as that shown in Figure 8B, is provided as input to an error correction model to correct the bases of interest. Here, the error correction model is a deep learning neural network (DNN). The error correction model is optimized using several different hyperparameters to identify the best value for each hyperparameter. Hyperparameters include (but are not limited to) kernel regularization coefficients, learning rate, number of layers, activation functions, and optimizers. 误差校正模型分析堆积的单细胞特征，包括所关注碱基周围的上下文序列、所关注碱基的测序深度和所关注碱基的等位基因频率。Error-corrected models analyze stacked single-cell features, including the context sequence around the base of interest, the sequencing depth of the base of interest, and the allele frequency of the base of interest. 误差校正模型输出四种核苷酸碱基(腺嘌呤、胞嘧啶、鸟嘌呤、胸腺嘧啶)的概率分布，其中每个概率指示所关注碱基是特定碱基的可能性。在图9A所显示的实施例中，误差校正模型输出概率分布，表明所关注碱基是腺嘌呤的可能性为20％，所关注碱基是胞嘧啶的可能性为0％，所关注碱基是鸟嘌呤的可能性为70％，且所关注碱基是胸腺嘧啶的可能性为10％。The error correction model outputs a probability distribution for the four nucleotide bases (adenine, cytosine, guanine, thymine), where each probability indicates the likelihood that the base of interest is a particular base. In the example shown in Figure 9A, the error correction model outputs a probability distribution indicating that the base of interest is 20% likely to be adenine, the base of interest is cytosine 0%, and the base of interest is There is a 70% chance that it is a guanine, and a 10% chance that the base of interest is a thymine. 图9B描绘使用由误差校正模型预测的概率校正所关注碱基的实例。图9B中所显示的前两列鉴别碱基的位置，包括碱基所定位的染色体以及碱基的参考位置。第三列鉴别所关注碱基已经被校正到的校正碱基，此取决于误差校正模型输出的概率。在此处，第四列显示由误差校正模型输出的概率。Figure 9B depicts an example of bases of interest corrected using the probability predicted by the error correction model. The first two columns shown in Figure 9B identify the position of the base, including the chromosome to which the base is located and the reference position of the base. The third column identifies the corrected bases to which the base of interest has been corrected, depending on the probability of the error correction model output. Here, the fourth column shows the probabilities output by the error-corrected model. 具体来说，对于第一行，输出的概率表明所关注碱基最可能是腺嘌呤核苷酸碱基，假设它具有最高的概率(例如，0.6748)。因此，所关注碱基被校正为腺嘌呤。对于第二行，输出的概率表明所关注碱基最可能是胞嘧啶核苷酸碱基，假设它具有最高的概率(例如，0.9127)。对于第三行，输出的概率表明所关注碱基最可能是胞嘧啶核苷酸碱基，假设它具有最高的概率(例如，0.83465)。对于第四行，输出的概率表明所关注碱基最可能是胸腺嘧啶核苷酸碱基，假设它具有最高的概率(例如，0.6193)。Specifically, for the first row, the output probabilities indicate that the base of interest is most likely an adenine nucleotide base, assuming it has the highest probability (eg, 0.6748). Therefore, the base of interest is corrected to adenine. For the second row, the output probabilities indicate that the base of interest is most likely a cytosine nucleotide base, assuming it has the highest probability (eg, 0.9127). For the third row, the output probability indicates that the base of interest is most likely a cytosine nucleotide base, assuming it has the highest probability (eg, 0.83465). For the fourth row, the output probability indicates that the base of interest is most likely a thymine nucleotide base, assuming it has the highest probability (eg, 0.6193). 图10展示校正四个不同细胞群体中的20％-35％碱基作为实施误差校正模型的结果。通过单细胞工作流装置(例如)处理四种细胞系中的每一者，且单细胞DNA经测序以生成序列读段。对于每一细胞，将误差校正模型应用于误差校正源自细胞的序列读段中的所关注碱基。Figure 10 shows the results of correcting 20%-35% of bases in four different cell populations as a result of implementing an error correction model. by single-cell workflow devices (e.g. ) for each of the four cell lines, and single-cell DNA was sequenced to generate sequence reads. For each cell, an error correction model was applied to the base of interest in the error correction cell-derived sequence reads. 总之，将误差校正模型应用于单细胞DNA序列读段可鉴别并校正很大比例的错误碱基，所述错误碱基可能是由于PCR误差、测序误差、测序比对误差或校正误差中的任一者引起。这些校正的序列读段使得能够进行更准确的变体调用，如下文实施例3中所述。In conclusion, applying error correction models to single-cell DNA sequence reads can identify and correct a large proportion of erroneous bases, which may be due to PCR errors, sequencing errors, sequencing alignment errors, or any of the calibration errors. caused by one. These corrected sequence reads enable more accurate variant calling, as described in Example 3 below. 实施例3：实施变体调用程序模型的方法Example 3: Method of Implementing the Variant Invoker Model 对序列读段进行误差校正后，过滤变体以去除不符合阈值(例如最小等位基因频率和突变细胞数)的变体。对于剩余变体中的每一变体，计算细胞群体特征：杂合子调用百分比、杂合子调用的中值变体等位基因频率(VAF)、杂合子调用的中值基因型质量、杂合子调用的中值读段深度、纯合子调用百分比、纯合子调用的中值VAF、纯合子调用的中值基因型质量、纯合子调用的中值读段深度、参考调用百分比、用于纯合子调用的读段深度的变异系数(CV)、用于杂合子调用的读段深度的CV、纯合子调用的基因型质量的CV、杂合子调用的基因型质量的CV、用于纯合子调用的VAF的CV、用于杂合子调用的VAF的CV、用于纯合子调用的平均VAF与中值VAF之间的差、用于杂合子调用的平均VAF与中值VAF之间的差和扩增子GC百分比。After error correction of the sequence reads, variants were filtered to remove those that did not meet thresholds (eg, minimum allele frequency and number of mutant cells). For each of the remaining variants, calculate cell population characteristics: percent heterozygous calls, median variant allele frequency (VAF) for heterozygous calls, median genotype quality for heterozygous calls, heterozygous calls median read depth for homozygous calls, percent for homozygous calls, median VAF for homozygous calls, median genotype quality for homozygous calls, median read depth for homozygous calls, percent reference calls, for homozygous calls Coefficient of variation (CV) for read depth, CV for read depth for heterozygous calls, CV for genotype quality for homozygous calls, CV for genotype quality for heterozygous calls, VAF for homozygous calls CV, CV of VAF for heterozygous calling, difference between mean and median VAF for homozygous calling, difference between mean and median VAF for heterozygous calling, and amplicon GC percentage. 使用从19个样品中获得的细胞的细胞群体特征来训练变体调用程序模型，在此情况下，该模型是多类神经网络分类器。下表1公开训练样品。对于这些样品，将已知变体基于各自样品中存在的已知真变体(根据批量测序方法确认)进行分类(异质变体、纯合变体或参考碱基)。训练样品包括来自各种稀释度高达0.1％的细胞混合物的各种样品，以及通过Tapestri仪器处理并在各种测序仪上测序的临床样品。由于训练数据具有类别不平衡，其中某些类别与其它类别相比具有少得多的调用，所以对较小的类别进行上采样。将模型的超参数使用具有已知真标记的验证数据进行迭代调整。一旦模型实现足够的准确性，训练就停止，且然后对新样品以预测模式使用该模型来鉴别那些样品中的顶级变体。Cell population characteristics of cells obtained from 19 samples were used to train a variant caller model, in this case a multi-class neural network classifier. Table 1 below discloses the training samples. For these samples, known variants were classified (heterogeneous variants, homozygous variants or reference bases) based on known true variants (confirmed according to bulk sequencing methods) present in the respective samples. Training samples included various samples from various dilutions of cell mixtures up to 0.1%, as well as clinical samples processed by Tapestri instruments and sequenced on various sequencers. Since the training data has class imbalance, where some classes have far fewer calls than others, the smaller classes are upsampled. The model's hyperparameters are iteratively tuned using validation data with known true labels. Once the model achieves sufficient accuracy, training is stopped, and the model is then used in predictive mode on new samples to identify the top variants in those samples. 使用十三个测试样品来评估变体调用程序模型的性能。下表2公开测试样品。图11展示在13个样品中实施变体调用程序模型之后真变体的改良的阳性预测值。通过两步误差校正模型和变体预测模型，实现显著改良的中值阳性预测值(PPV)。具体来说，在13个样品的大多数中观察到在0.5％LOD时PPV改良2-3倍。与采用硬截止过滤器的常规GATK模型相比，观察到2-3倍的改良，这与误差校正模型和/或变体预测模型相反。Thirteen test samples were used to evaluate the performance of the variant caller model. Table 2 below discloses the test samples. Figure 11 shows the improved positive predictive value for true variants after implementing the variant caller model in 13 samples. A significantly improved median positive predictive value (PPV) was achieved with a two-step error-corrected model and a variant prediction model. Specifically, a 2-3 fold improvement in PPV at 0.5% LOD was observed in most of the 13 samples. A 2-3-fold improvement was observed compared to conventional GATK models with hard cutoff filters, as opposed to error-corrected models and/or variant prediction models. 表1：用于训练变体调用程序模型的训练样品。Table 1: Training samples used to train variant caller models. 表2：用于验证变体调用程序模型的测试样品。Table 2: Test samples used to validate variant caller models. 总之，这些结果证实，误差校正模型和变体调用程序模型的应用实现变体调用的显著改良。Taken together, these results demonstrate that the application of the error correction model and the variant caller model achieves significant improvements in variant calling.

### Claims

Claims (59) 1. A method for calling one or more variants of a population of cells, the method comprising: obtaining a plurality of sequence reads from cells of the cell population; for a plurality of cells in the population of cells, correcting sequence reads obtained from the cells, the correcting comprising: identifying a base of interest of the sequence read that is different from a reference base; applying an error correction model to analyze a single cell characteristic of the base of interest, the error correction model trained to predict a probability of the base of interest; and correcting the base of interest of the sequence read derived from the cell; generating a cell population characteristic by aggregating corrected sequence reads of cells of the cell population, the corrected sequence reads comprising corrected bases; and applying a variant calling program model to the cell population characteristics derived from the aggregated sequence reads to identify one or more variants in the cell population. 2. The method of claim 1, wherein the single cell features comprise a context sequence around the base of interest, a sequencing depth of the base of interest, an allele frequency of the base of interest, and an allele frequency of a base in a window around the base of interest. 3. The method of claim 1 or 2, wherein identifying the base of interest of the sequence reads comprises applying a transition matrix comprising likelihoods of transitions between reference bases and mismatched bases to probabilities of observing a proportion of nucleotide bases in the sequence reads of mismatched bases. 4. The method of claim 3, wherein identifying the base of interest of the sequence read further comprises: determining the probability that a proportion of nucleotide bases are observed in the sequence reads of the mismatched bases; and comparing the determined probabilities to likelihoods of transitions from the transition matrix. 5. The method of claim 4, wherein the mismatched base is identified as the base of interest in response to the determined probability being greater than the switch likelihood. 6. The method of claim 5, wherein the transformation matrix is generated using training data comprising sequence reads derived from one or more populations of cell samples. 7. The method of claim 5, wherein the transformation matrix is generated using the plurality of sequence reads from cells of the cell population. 8. The method of claim 5, wherein the switch likelihood in the switch matrix is dynamically updated when correcting sequence reads of the one or more cells of the cell population. 9. The method of any one of claims 1-8, wherein the error correction model is a neural network. 10. The method of any one of claims 1-9, wherein the error correction model is a deep learning neural network comprising one or more layers that learn motifs and local sequence context around a base of interest. 11. The method of any one of claims 1-10, wherein correcting one or more sequence reads of the plurality of sequence reads derived from a cellular result comprises correcting at least 25% of bases of interest that are different from a reference base. 12. The method of any one of claims 1-11, wherein the cell population characteristics comprise one or more of: percentage of heterozygote calls, median Variant Allele Frequency (VAF) of heterozygote calls, median genotype quality of heterozygote calls, median read depth of heterozygote calls, percentage of homozygote calls, median VAF of homozygote calls, median genotype quality of homozygote calls, median read depth of homozygote calls, percentage of reference calls, Coefficient of Variation (CV) for read depth of homozygote calls, CV for read depth of heterozygote calls, CV of genotype quality of homozygote calls, CV of genotype quality of heterozygote calls, CV of VAF for homozygote calls, CV of VAF for heterozygote calls, difference between average VAF and median VAF for homozygote calls, and percentage of GC of amplicons. 13. The method of any one of claims 1-12, wherein the variant caller model predicts at least one of a heterozygous variant of interest or a homozygous variant of interest. 14. The method of claim 13, wherein the variant caller model also predicts ambiguous variants. 15. The method of any one of claims 1-14, wherein the variant calling program model is trained using training data comprising sequence reads derived from one or more cell lines and an indication of known heterozygous or homozygous variants present in the one or more cell lines. 16. The method of any one of claims 1-15, wherein the application of the error correction model and the variant caller model achieves at least a two-fold increase in true variant positive predictive value at a detection Limit (LOD) of 0.5% compared to a conventional GTAK variant caller. 17. The method of any one of claims 1-15, wherein the application of the error correction model and the variant caller model achieves a true variant positive predictive value of at least 0.6 at a detection Limit (LOD) of 0.5%. 18. The method of any one of claims 1-17, wherein the plurality of sequence reads derived from the cell are determined by single cell workflow analysis. 19. The method of any one of claims 1-18, wherein the reference base is determined from a reference genomic sequence. 20. The method of any one of claims 1-18, wherein the reference base is determined from one or more sequence reads obtained from a control cell. 21. A non-transitory computer-readable medium for invoking one or more variants of a population of cells, the non-transitory computer-readable medium comprising instructions that, when executed by a processor, cause the processor to: obtaining a plurality of sequence reads from cells of the cell population; for a plurality of cells in the population of cells, correcting sequence reads obtained from the cells, the correcting comprising: identifying a base of interest of the sequence read that is different from a reference base; applying an error correction model to analyze a single cell characteristic of the base of interest, the error correction model trained to predict a probability of the base of interest; correcting the base of interest of the sequence read derived from the cell; generating a cell population characteristic by aggregating corrected sequence reads of cells of the cell population, the corrected sequence reads comprising corrected bases; and applying a variant calling program model to the cell population characteristics derived from the aggregated sequence reads to identify one or more variants in the cell population. 22. The non-transitory computer-readable medium of claim 21, wherein the single-cell feature comprises a context sequence surrounding the base of interest, a sequencing depth of the base of interest, an allele frequency of the base of interest, and an allele frequency of a base in a window around the base of interest. 23. The non-transitory computer-readable medium of claim 21 or 22, wherein the instructions that cause the processor to identify a base of interest of the sequence read further comprise instructions that, when executed by the processor, cause the processor to apply a transformation matrix that includes likelihoods of transitions between reference and mismatched bases. 24. The non-transitory computer-readable medium of claim 23, wherein the instructions that cause the processor to identify a base of interest of the sequence read further comprise instructions that, when executed by the processor, cause the processor to: determining the probability that a proportion of nucleotide bases are observed in the sequence reads of mismatched bases; and comparing the determined probabilities to likelihoods of transitions from the transition matrix. 25. The non-transitory computer-readable medium of claim 24, wherein the mismatched base is identified as the base of interest in response to the determined probability being greater than the transition likelihood. 26. The non-transitory computer-readable medium of any one of claims 23-25, wherein the transformation matrix is generated using training data comprising sequence reads derived from one or more populations of cell samples. 27. The non-transitory computer-readable medium of any one of claims 23-25, wherein the transformation matrix is generated using the plurality of sequence reads from cells of the cell population. 28. The non-transitory computer-readable medium of any one of claims 23-25, wherein the switch likelihood in the switch matrix is dynamically updated when correcting sequence reads of the one or more cells of the cell population. 29. The non-transitory computer-readable medium of any one of claims 21-28, wherein the error correction model is a neural network. 30. The non-transitory computer-readable medium of any one of claims 21-29, wherein the error correction model is a deep-learning neural network comprising one or more layers that learn motifs and local sequence context around a base of interest. 31. The non-transitory computer-readable medium of any one of claims 21-30, wherein correcting one or more sequence reads of the plurality of sequence reads derived from a cellular result comprises correcting at least 25% of a base of interest that is different from a reference base. 32. The non-transitory computer readable medium of any one of claims 21-31, wherein the cell population characteristics include one or more of: percentage heterozygote calls, median Variant Allele Frequency (VAF) for heterozygote calls, median genotype quality for heterozygote calls, median read depth for heterozygote calls, percentage homozygote calls, median VAF for homozygote calls, median genotype quality for homozygote calls, median read depth for homozygote calls, percentage of reference calls, Coefficient of Variation (CV) for read depth for homozygote calls, CV for read depth for heterozygote calls, CV for genotype quality for homozygote calls, CV for genotype quality for heterozygote calls, CV for VAF for homozygote calls, CV for VAF for heterozygote calls, difference between average VAF and median VAF for homozygote calls, and percentage of amplicon heterozygote GC. 33. The non-transitory computer-readable medium of any one of claims 21-32, wherein the variant caller model predicts at least one of a heterozygous variant of interest or a homozygous variant of interest. 34. The non-transitory computer-readable medium of claim 33, wherein the variant caller model further predicts ambiguous variants. 35. The non-transitory computer-readable medium of any one of claims 21-34, wherein the variant calling program model is trained using training data comprising sequence reads derived from one or more cell lines and an indication of known heterozygous or homozygous variants present in the one or more cell lines. 36. The non-transitory computer-readable medium of any one of claims 21-35, wherein the application of the error correction model and the variant caller model achieves at least a two-fold increase in true variant positive predictive value at a detection Limit (LOD) of 0.5% compared to a conventional GTAK variant caller. 37. The non-transitory computer-readable medium of any one of claims 21-35, wherein the application of the error correction model and the variant caller model achieves a true variant positive predictive value of at least 0.6 at a limit of detection (LOD) of 0.5%. 38. The non-transitory computer-readable medium of any one of claims 21-37, wherein the plurality of sequence reads derived from the cell are determined by single cell workflow analysis. 39. The non-transitory computer readable medium of any one of claims 21-38, wherein the reference base is determined from a reference genomic sequence. 40. The non-transitory computer-readable medium of any one of claims 21-38, wherein the reference base is determined from one or more sequence reads obtained from a control cell. 41. A system, comprising: a single cell analysis workflow device configured to generate a plurality of sequence reads of cells in a cell population; a computing device communicatively coupled to the single-cell analysis workflow device, the computing device configured to: obtaining a plurality of sequence reads from cells of the cell population; for a plurality of cells in the population of cells, correcting sequence reads obtained from the cells, the correcting comprising: identifying a base of interest of the sequence read that is different from a reference base; applying an error correction model to analyze a single cell characteristic of the base of interest, the error correction model trained to predict a probability of the base of interest; correcting the base of interest of the sequence read derived from the cell; generating a cell population characteristic by aggregating corrected sequence reads of cells of the cell population, the corrected sequence reads comprising corrected bases; and applying a variant calling program model to the cell population characteristics derived from the aggregated sequence reads to identify one or more variants in the cell population. 42. The system of claim 41, wherein the single-cell features comprise a context sequence around the base of interest, a sequencing depth of the base of interest, an allele frequency of the base of interest, and an allele frequency of a base in a window around the base of interest. 43. The system of claim 41 or 42, wherein identifying the base of interest of the sequence read comprises: applying a transformation matrix comprising likelihoods of transitions between a reference base and a mismatched base to probabilities that a proportion of nucleotide bases are observed in the sequence reads of mismatched bases. 44. The system of claim 43, wherein identifying a base of interest of the sequence read comprises: determining the probability that a proportion of nucleotide bases are observed in the sequence reads of the mismatched bases; and comparing the determined probabilities to likelihoods of transitions from the transition matrix. 45. The system of claim 44, wherein the mismatched base is identified as the base of interest in response to the determined probability being greater than the switch likelihood. 46. The system of claim 45, wherein the transformation matrix is generated using training data comprising sequence reads derived from one or more populations of cell samples. 47. The system of claim 45, wherein the transformation matrix is generated using the plurality of sequence reads from cells of the cell population. 48. The system of claim 45, wherein the switch likelihood in the switch matrix is dynamically updated when correcting sequence reads of the one or more cells of the cell population. 49. The system according to any one of claims 41-48, wherein the error correction model is a neural network. 50. The system of any one of claims 41-49, wherein the error correction model is a deep learning neural network comprising one or more layers that learn motifs and local sequence context around bases of interest. 51. The system of any one of claims 41-50, wherein correcting one or more sequence reads of the plurality of sequence reads derived from the cellular result comprises correcting at least 25% of a base of interest that is different from a reference base. 52. The system of any one of claims 41-51, wherein the cell population characteristics comprise one or more of: percentage heterozygote calls, median Variant Allele Frequency (VAF) for heterozygote calls, median genotype quality for heterozygote calls, median read depth for heterozygote calls, percentage homozygote calls, median VAF for homozygote calls, median genotype quality for homozygote calls, median read depth for homozygote calls, percentage of reference calls, Coefficient of Variation (CV) for read depth for homozygote calls, CV for read depth for heterozygote calls, CV for genotype quality for homozygote calls, CV for genotype quality for heterozygote calls, CV for VAF for homozygote calls, CV for VAF for heterozygote calls, difference between average VAF and median VAF for homozygote calls, and percentage of amplicon heterozygote GC. 53. The system of any one of claims 41-52, wherein the variant caller model predicts at least one of a heterozygous variant of interest or a homozygous variant of interest. 54. The system of claim 53, wherein the variant caller model further predicts ambiguous variants. 55. The system of any one of claims 41-54, wherein the variant calling program model is trained using training data comprising sequence reads derived from one or more cell lines and an indication of known heterozygous or homozygous variants present in the one or more cell lines. 56. The system of any one of claims 41-55, wherein the application of the error correction model and the variant caller model achieves at least a two-fold increase in true variant positive predictive value at a detection Limit (LOD) of 0.5% compared to a conventional GTAK variant caller. 57. The system of any one of claims 41-55, wherein the application of the error correction model and the variant caller model achieves a true variant positive predictive value of at least 0.6 at a detection Limit (LOD) of 0.5%. 58. The system of any one of claims 41-57, wherein the reference base is determined from a reference genomic sequence. 59. The system of any one of claims 41-57, wherein the reference base is determined from one or more sequence reads obtained from a control cell.
